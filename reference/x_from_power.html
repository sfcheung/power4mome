<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Sample Size and Effect Size Determination — x_from_power • power4mome</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Hind-0.4.10/font.css" rel="stylesheet"><link href="../deps/Oxygen_Mono-0.4.10/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Sample Size and Effect Size Determination — x_from_power"><meta name="description" content="It searches by simulation
the sample size (given other factors,
such as effect sizes) or effect size
(given other factors, such as sample
size) with power to
detect an effect close to a target
value."><meta property="og:description" content="It searches by simulation
the sample size (given other factors,
such as effect sizes) or effect size
(given other factors, such as sample
size) with power to
detect an effect close to a target
value."><meta name="google-site-verification" content="0VLBmFnW_UJFI-7gXnORPBsWxqZwmzuGpK-TeVRLBjQ"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">power4mome</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.1.50</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/power4mome.html">Get started</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><h6 class="dropdown-header" data-toc-skip>&lt;Scenarios&gt;</h6></li>
    <li><a class="dropdown-item" href="../articles/power4test_latent_mediation.html">Latent factor mediation</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>&lt;Given Power, Find x&gt;</h6></li>
    <li><a class="dropdown-item" href="../articles/x_from_power_for_n.html">Determine the sample size with the target power</a></li>
    <li><a class="dropdown-item" href="../articles/x_from_power_for_es.html">Determine the effect size with the target power</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>&lt;Quick Templates&gt;</h6></li>
    <li><a class="dropdown-item" href="../articles/template_mediation_obs.html">Simple mediation</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>&lt;Technical Appendices&gt;</h6></li>
    <li><a class="dropdown-item" href="../articles/power4test_workflow.html">Workflow of `power4test()`</a></li>
    <li><a class="dropdown-item" href="../articles/x_from_power_workflow.html">Workflow of `x_from_power()`</a></li>
    <li><a class="dropdown-item" href="../articles/sim_data_i_workflow.html">Workflow of `sim_data_i()`</a></li>
  </ul></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/sfcheung/power4mome/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Sample Size and Effect Size Determination</h1>
      <small class="dont-index">Source: <a href="https://github.com/sfcheung/power4mome/blob/main/R/x_from_power.R" class="external-link"><code>R/x_from_power.R</code></a></small>
      <div class="d-none name"><code>x_from_power.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>It searches by simulation
the sample size (given other factors,
such as effect sizes) or effect size
(given other factors, such as sample
size) with power to
detect an effect close to a target
value.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">x_from_power</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  <span class="va">x</span>,</span>
<span>  pop_es_name <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  target_power <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>  xs_per_trial <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  ci_level <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  power_min <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>  power_max <span class="op">=</span> <span class="fl">0.9</span>,</span>
<span>  x_interval <span class="op">=</span> <span class="kw"><a href="https://rdrr.io/r/base/switch.html" class="external-link">switch</a></span><span class="op">(</span><span class="va">x</span>, n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">2000</span><span class="op">)</span>, es <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.7</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  extendInt <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  progress <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  simulation_progress <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  max_trials <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  initial_nrep <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  final_nrep <span class="op">=</span> <span class="fl">400</span>,</span>
<span>  initial_R <span class="op">=</span> <span class="fl">250</span>,</span>
<span>  final_R <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  nrep_steps <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  seed <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  x_include_interval <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  power_model <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  start <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  lower_bound <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  upper_bound <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  nls_control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  nls_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  save_sim_all <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'x_from_power'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">x</span>, digits <span class="op">=</span> <span class="fl">3</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>A <code>power4test</code> object,
which is the output of <code><a href="power4test.html">power4test()</a></code>.
Can also be a <code>power4test_by_n</code> object,
the output
of <code><a href="power4test_by_n.html">power4test_by_n()</a></code>, or
a <code>power4test_by_es</code> object, the
output of
<code><a href="power4test_by_es.html">power4test_by_es()</a></code>. For these
two types of objects, the attempt
with power closest to the
<code>target_power</code> will be used as
<code>object</code>, and all other attempts in
them will be included in the estimation
of subsequent attempts and the final
output. Last, it can also be the
output of a previous call to
<code>x_from_power()</code>, and the stored
trials will be retrieved.</p></dd>


<dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>For <code>x_from_power()</code>,
<code>x</code> set the value to
be searched. Can be <code>"n"</code>, the sample
size, or <code>"es"</code>, the population value
of a parameter (set by <code>pop_es_name</code>).
For the <code>print</code> method of <code>x_from_power</code>
objects, this is the output of
<code>x_from_power()</code>.</p></dd>


<dt id="arg-pop-es-name">pop_es_name<a class="anchor" aria-label="anchor" href="#arg-pop-es-name"></a></dt>
<dd><p>The name of the
parameter. Required if <code>x</code> is <code>"es"</code>.
See the help page
of <code><a href="ptable_pop.html">ptable_pop()</a></code> on the names for
the argument <code>pop_es</code>.</p></dd>


<dt id="arg-target-power">target_power<a class="anchor" aria-label="anchor" href="#arg-target-power"></a></dt>
<dd><p>The target power,
a value greater than 0 and less than
one.</p></dd>


<dt id="arg-xs-per-trial">xs_per_trial<a class="anchor" aria-label="anchor" href="#arg-xs-per-trial"></a></dt>
<dd><p>The initial number
of values (sample sizes or population
values) to consider in each
trial. Should be an integer at least</p><ol><li><p>Rounded
up if not an integer.</p></li>
</ol></dd>


<dt id="arg-ci-level">ci_level<a class="anchor" aria-label="anchor" href="#arg-ci-level"></a></dt>
<dd><p>The level of confidence
of the confidence intervals computed
for the estimated power. Default is
.95, denoting 95%.</p></dd>


<dt id="arg-power-min-power-max">power_min, power_max<a class="anchor" aria-label="anchor" href="#arg-power-min-power-max"></a></dt>
<dd><p>The minimum
and maximum values, respectively,
of power
when determining the values to
try in each trail. Default is .01.</p></dd>


<dt id="arg-x-interval">x_interval<a class="anchor" aria-label="anchor" href="#arg-x-interval"></a></dt>
<dd><p>A vector of
two values, the minimum value
and the maximum values of <code>x</code>, in
the search for the values
(sample sizes or population values).</p></dd>


<dt id="arg-extendint">extendInt<a class="anchor" aria-label="anchor" href="#arg-extendint"></a></dt>
<dd><p>Whether <code>x_interval</code>
can be expanded when estimating the
the values to try. The value will
be passed to the argument of the
same name in <code><a href="https://rdrr.io/r/stats/uniroot.html" class="external-link">stats::uniroot()</a></code>.
If <code>x</code> is <code>"n"</code>, then the default
value is <code>"upX"</code>.
That is, a value higher than
the maximum in <code>x_interval</code> is
allowed, if predicted by the tentative
model. Otherwise, the default value
is <code>"no"</code>. See the help page of
<code><a href="https://rdrr.io/r/stats/uniroot.html" class="external-link">stats::uniroot()</a></code> for further
information.</p></dd>


<dt id="arg-progress">progress<a class="anchor" aria-label="anchor" href="#arg-progress"></a></dt>
<dd><p>Logical. Whether
the searching progress is reported.</p></dd>


<dt id="arg-simulation-progress">simulation_progress<a class="anchor" aria-label="anchor" href="#arg-simulation-progress"></a></dt>
<dd><p>Logical.
Whether the progress in each call
to <code><a href="power4test.html">power4test()</a></code>, <code><a href="power4test_by_n.html">power4test_by_n()</a></code>,
or <code><a href="power4test_by_es.html">power4test_by_es()</a></code>
is shown. To be passed to
the <code>progress</code> argument of these
functions.</p></dd>


<dt id="arg-max-trials">max_trials<a class="anchor" aria-label="anchor" href="#arg-max-trials"></a></dt>
<dd><p>The maximum number
of trials in searching the value
with the target power. Rounded
up if not an integer.</p></dd>


<dt id="arg-initial-nrep">initial_nrep<a class="anchor" aria-label="anchor" href="#arg-initial-nrep"></a></dt>
<dd><p>The initial
number of replications. If set
to <code>NULL</code>, the <code>nrep</code> used in
<code>object</code> will be used. If higher
than <code>final_nrep</code>, it will be
converted to one-fourth of <code>final_nrep</code>.
If lower than the <code>nrep</code> in <code>object</code>
after the conversion,
then set to <code>nrep</code> in the <code>object</code>.</p></dd>


<dt id="arg-final-nrep">final_nrep<a class="anchor" aria-label="anchor" href="#arg-final-nrep"></a></dt>
<dd><p>The number of
replications in the final stage,
also the maximum number of replications
in each call to <code><a href="power4test.html">power4test()</a></code>,
<code><a href="power4test_by_n.html">power4test_by_n()</a></code>, or
<code><a href="power4test_by_es.html">power4test_by_es()</a></code>.</p></dd>


<dt id="arg-initial-r">initial_R<a class="anchor" aria-label="anchor" href="#arg-initial-r"></a></dt>
<dd><p>The initial number of
Monte Carlo simulation or
bootstrapping samples. The <code>R</code> in calling
<code><a href="power4test.html">power4test()</a></code>, <code><a href="power4test_by_n.html">power4test_by_n()</a></code>,
or <code><a href="power4test_by_es.html">power4test_by_es()</a></code>. If set to <code>NULL</code>,
the <code>R</code> used in
<code>object</code> will be used.
If higher
than <code>final_R</code>, it will be
converted to one-fourth of <code>final_R</code>.
If lower than the <code>R</code> in <code>object</code>
after the conversion,
then set to <code>R</code> in `object“.</p></dd>


<dt id="arg-final-r">final_R<a class="anchor" aria-label="anchor" href="#arg-final-r"></a></dt>
<dd><p>The number of
Monte Carlo simulation or
bootstrapping samples in the final
stage. The <code>R</code> in calling
<code><a href="power4test.html">power4test()</a></code>, <code><a href="power4test_by_n.html">power4test_by_n()</a></code>,
or <code><a href="power4test_by_es.html">power4test_by_es()</a></code>
will be stepped up to this value
when approaching the target
power. Do not need to be very large
because the goal is to estimate
power by replications, not for high
precision in one single replication.</p></dd>


<dt id="arg-nrep-steps">nrep_steps<a class="anchor" aria-label="anchor" href="#arg-nrep-steps"></a></dt>
<dd><p>How many steps
the number of replications will be
increased to <code>final_nrep</code>, if the
initial number of replications
(<code>nrep</code> in <code><a href="power4test.html">power4test()</a></code>) is
less than <code>final_nrep</code>. The number
of replications will be successively
increased by this number of steps
to increase the precision in estimating
the power. Should be at least 1.
Increasing this number will result
in more trials and take longer to
run, but will try more values.
Rounded up if not an integer.</p></dd>


<dt id="arg-seed">seed<a class="anchor" aria-label="anchor" href="#arg-seed"></a></dt>
<dd><p>If not <code>NULL</code>, <code><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed()</a></code>
will be used to make the process
reproducible. This is not always
possible if many stages of
parallel processing is involved.</p></dd>


<dt id="arg-x-include-interval">x_include_interval<a class="anchor" aria-label="anchor" href="#arg-x-include-interval"></a></dt>
<dd><p>Logical.
Whether the minimum and maximum
values in <code>x_interval</code> are mandatory
to be included in the values
to be searched.</p></dd>


<dt id="arg-power-model">power_model<a class="anchor" aria-label="anchor" href="#arg-power-model"></a></dt>
<dd><p>The nonlinear
model to be used when estimating
the relation between power and
<code>x</code>. Should be a formula
acceptable by <code><a href="https://rdrr.io/r/stats/nls.html" class="external-link">stats::nls()</a></code>,
with <code>reject</code> on the left-hand side,
and <code>x</code>
on the right-hand
side, with one or more parameters.
Can also be set to a list of
models.
Users rarely need to change the
default value. If <code>NULL</code>, the default,
then the default model(s) will be
determined by <code><a href="power_curve.html">power_curve()</a></code>.</p></dd>


<dt id="arg-start">start<a class="anchor" aria-label="anchor" href="#arg-start"></a></dt>
<dd><p>A named numeric vector
of the starting values for <code>power_model</code>
when fitted by <code><a href="https://rdrr.io/r/stats/nls.html" class="external-link">stats::nls()</a></code>. If
<code>power_model</code> is a list, this should
be a list of the same length.
Users rarely need to change the
default values.</p></dd>


<dt id="arg-lower-bound">lower_bound<a class="anchor" aria-label="anchor" href="#arg-lower-bound"></a></dt>
<dd><p>A named numeric vector
of the lower bounds for parameters
in <code>power_model</code>
when fitted by <code><a href="https://rdrr.io/r/stats/nls.html" class="external-link">stats::nls()</a></code>. If
<code>power_model</code> is a list, this should
be a list of the same length.
Users rarely need to change the
default values.</p></dd>


<dt id="arg-upper-bound">upper_bound<a class="anchor" aria-label="anchor" href="#arg-upper-bound"></a></dt>
<dd><p>A named numeric vector
of the upper bounds for parameters
in <code>power_model</code>
when fitted by <code><a href="https://rdrr.io/r/stats/nls.html" class="external-link">stats::nls()</a></code>. If
<code>power_model</code> is a list, this should
be a list of the same length.
Users rarely need to change the
default values.</p></dd>


<dt id="arg-nls-control">nls_control<a class="anchor" aria-label="anchor" href="#arg-nls-control"></a></dt>
<dd><p>A named list of
arguments to be passed the <code>control</code>
argument of <code><a href="https://rdrr.io/r/stats/nls.html" class="external-link">stats::nls()</a></code> when
estimating the relation between
power and <code>x</code>. The values will
override internal default values,
and also override <code>nls_args</code>.
Use this argument with cautions.</p></dd>


<dt id="arg-nls-args">nls_args<a class="anchor" aria-label="anchor" href="#arg-nls-args"></a></dt>
<dd><p>A named list of
arguments to be used when calling
<code><a href="https://rdrr.io/r/stats/nls.html" class="external-link">stats::nls()</a></code>. Used to override
internal default, such as the
algorithm (default is <code>"port"</code>).
Use this argument with cautions.</p></dd>


<dt id="arg-save-sim-all">save_sim_all<a class="anchor" aria-label="anchor" href="#arg-save-sim-all"></a></dt>
<dd><p>If <code>FALSE</code>,
the default, the data in each
<code>power4test</code> object for each
value of <code>x</code> is not saved,
to reduce the size of the output.
If set to <code>TRUE</code>, the size of the
output can be very large in size.</p></dd>


<dt id="arg-digits">digits<a class="anchor" aria-label="anchor" href="#arg-digits"></a></dt>
<dd><p>The number of digits
after the decimal when printing
the results.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Optional arguments.
Not used for now.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>The function <code>x_from_power()</code>
returns an <code>x_from_power</code> object,
which is a list with the following
elements:</p><ul><li><p><code>power4test_trials</code>: The output of
<code><a href="power4test_by_n.html">power4test_by_n()</a></code> for all sample
sizes examined, or of
<code><a href="power4test_by_es.html">power4test_by_es()</a></code> for all
population values of the selected
parameter examined.</p></li>
<li><p><code>rejection_rates</code>: The output of
<code><a href="rejection_rates.html">rejection_rates()</a></code>.</p></li>
<li><p><code>x_tried</code>: The sample sizes or
population values
examined.</p></li>
<li><p><code>power_tried</code>: The estimated
rejection rates for all the values
examined.</p></li>
<li><p><code>x_final</code>: The sample size or
population value in the
solution. <code>NA</code> if a solution not found.</p></li>
<li><p><code>power_final</code>: The estimated power
of the value in the solution.
<code>NA</code> if a solution not found.</p></li>
<li><p><code>i_final</code>: The position of the
solution in <code>power4test_trials</code>.
<code>NA</code> if a solution not found.</p></li>
<li><p><code>ci_final</code>: The confidence interval
of the estimated power in the solution,
formed by normal approximation.
<code>NA</code> if a solution not found.</p></li>
<li><p><code>ci_level</code>: The level of confidence
of <code>ci_final</code>.</p></li>
<li><p><code>nrep_final</code>: The number of
replications (<code>nrep</code>) when estimating
the power in the solution.</p></li>
<li><p><code>power_curve</code>: The output of
<code><a href="power_curve.html">power_curve()</a></code> when estimating the
power curve.</p></li>
<li><p><code>target_power</code>: The requested
target power.</p></li>
<li><p><code>power_tolerance</code>: The allowed
difference between the solution's
estimated power and the target
power. Determined by the number
of replications and the level of
confidence of the confidence intervals.</p></li>
<li><p><code>x_estimated</code>: The value
(sample size or population value)
with the target power, estimated by
<code>power_curve</code>. This is used, when
solution not found, to determine the
range of the values to search when
calling the function again.</p></li>
<li><p><code>start</code>: The time and date when
the process started.</p></li>
<li><p><code>end</code>: The time and date when the
process ended.</p></li>
<li><p><code>time_spent</code>: The time spent in
doing the search.</p></li>
<li><p><code>args</code>: A named list of the arguments
of <code>x_from_power()</code> used in the search.</p></li>
<li><p><code>call</code>: The call when this function
is called.</p></li>
</ul><p>The <code>print</code>-method of <code>x_from_power</code>
objects returns the object <code>x</code>
invisibly.
It is called for its side effect.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This is how to use this function:</p><ul><li><p>Specify the model by <code><a href="power4test.html">power4test()</a></code>,
with <code>do_the_test = FALSE</code>, and set
the magnitude of the effect sizes
to the minimum levels to detect.</p></li>
<li><p>Add the test using <code><a href="power4test.html">power4test()</a></code>
using <code>test_fun</code> and <code>test_args</code>
(see the help page of <code><a href="power4test.html">power4test()</a></code>
for details). Run it on the
starting sample size or
effect size.</p></li>
<li><p>Call <code>x_from_power()</code> on the output
of <code><a href="power4test.html">power4test()</a></code> returned from
the previous step. This
function will iteratively repeat
the analysis on either other sample
sizes, or other values for a
selected model parameter (the
effect sizes),
trying to find a value (a sample
size, or a population value of
the selected model parameter) with
a power level close enough to the
target power.</p></li>
</ul><p>If several values of <code>x</code> (sample
size or the population value of
a model parameter) have already been
examined by <code><a href="power4test_by_n.html">power4test_by_n()</a></code> or
<code><a href="power4test_by_es.html">power4test_by_es()</a></code>, the output
of these two functions can also be
used as <code>object</code> by <code>x_from_power()</code>.</p>
<p>Usually, the default values of the
arguments should be sufficient.</p>
<p>The results can be viewed using
<code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code>, and the output has
a <code>plot</code> method (<code><a href="plot.x_from_power.html">plot.x_from_power()</a></code>) to
plot the relation between power and
values (of <code>x</code>) examined.</p>
<p>A detailed illustration on how to
use this function can be found
from these pages:</p><ul><li><p>For example sizes: <a href="https://sfcheung.github.io/power4mome/articles/x_from_power_for_n.html">https://sfcheung.github.io/power4mome/articles/x_from_power_for_n.html</a></p></li>
<li><p>For effect sizes: <a href="https://sfcheung.github.io/power4mome/articles/x_from_power_for_es.html">https://sfcheung.github.io/power4mome/articles/x_from_power_for_es.html</a></p></li>
</ul><p>The technical internal workflow of
of <code>x_from_power()</code> can be found in
this page: <a href="https://sfcheung.github.io/power4mome/articles/x_from_power_workflow.html">https://sfcheung.github.io/power4mome/articles/x_from_power_workflow.html</a>.</p>
<p>The <code>print</code> method only print
basic information. Call the
<code>summary</code> method of <code>x_from_power</code> objects
(<code><a href="summary.x_from_power.html">summary.x_from_power()</a></code>) and its
<code>print</code> method for detailed results</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="power4test.html">power4test()</a></code>, <code><a href="power4test_by_n.html">power4test_by_n()</a></code>,
and <code><a href="power4test_by_es.html">power4test_by_es()</a></code>.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Specify the population model</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">mod</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span><span class="st">"</span></span></span>
<span class="r-in"><span><span class="st">m ~ x</span></span></span>
<span class="r-in"><span><span class="st">y ~ m + x</span></span></span>
<span class="r-in"><span><span class="st">"</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Specify the population values</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">mod_es</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span><span class="st">"</span></span></span>
<span class="r-in"><span><span class="st">m ~ x: m</span></span></span>
<span class="r-in"><span><span class="st">y ~ m: l</span></span></span>
<span class="r-in"><span><span class="st">y ~ x: n</span></span></span>
<span class="r-in"><span><span class="st">"</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Generate the datasets</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">sim_only</span> <span class="op">&lt;-</span> <span class="fu"><a href="power4test.html">power4test</a></span><span class="op">(</span>nrep <span class="op">=</span> <span class="fl">10</span>,</span></span>
<span class="r-in"><span>                       model <span class="op">=</span> <span class="va">mod</span>,</span></span>
<span class="r-in"><span>                       pop_es <span class="op">=</span> <span class="va">mod_es</span>,</span></span>
<span class="r-in"><span>                       n <span class="op">=</span> <span class="fl">100</span>,</span></span>
<span class="r-in"><span>                       do_the_test <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>                       iseed <span class="op">=</span> <span class="fl">1234</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Displaying progress enabled. Set 'progress = FALSE' to hide the progress.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Simulate the data:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fit the model(s):</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Do a test</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">test_out</span> <span class="op">&lt;-</span> <span class="fu"><a href="power4test.html">power4test</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">sim_only</span>,</span></span>
<span class="r-in"><span>                       test_fun <span class="op">=</span> <span class="va">test_parameters</span>,</span></span>
<span class="r-in"><span>                       test_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>pars <span class="op">=</span> <span class="st">"m~x"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Displaying progress enabled. Set 'progress = FALSE' to hide the progress.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Do the test: test_parameters: CIs (pars: m~x) </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Determine the sample size with a power of .80 (default)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># In real analysis, to have more stable results:</span></span></span>
<span class="r-in"><span><span class="co"># - Use a larger final_nrep (e.g., 400).</span></span></span>
<span class="r-in"><span><span class="co"># - Use the default xs_per_trial of 3, or just remove it.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># If the default values are OK, this call is sufficient:</span></span></span>
<span class="r-in"><span><span class="co"># power_vs_n &lt;- x_from_power(test_out,</span></span></span>
<span class="r-in"><span><span class="co">#                            x = "n",</span></span></span>
<span class="r-in"><span><span class="co">#                            seed = 4567)</span></span></span>
<span class="r-in"><span><span class="va">power_vs_n</span> <span class="op">&lt;-</span> <span class="fu">x_from_power</span><span class="op">(</span><span class="va">test_out</span>,</span></span>
<span class="r-in"><span>                           x <span class="op">=</span> <span class="st">"n"</span>,</span></span>
<span class="r-in"><span>                           progress <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                           target_power <span class="op">=</span> <span class="fl">.80</span>,</span></span>
<span class="r-in"><span>                           final_nrep <span class="op">=</span> <span class="fl">10</span>,</span></span>
<span class="r-in"><span>                           xs_per_trial <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>                           nrep_steps <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>                           max_trials <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>                           seed <span class="op">=</span> <span class="fl">4567</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> --- Pre-iteration Search ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - Start at 2025-06-03 13:21:59 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - Value(s) to try:  125 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Updating the simulation for sample size: 125 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Displaying progress enabled. Set 'progress = FALSE' to hide the progress.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Re-simulate the data:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fit the model(s):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Generate Monte Carlo estimates:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Update the test(s):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Update test_parameters: CIs (pars: m~x) :</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - Rejection Rates:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     n                             test test_label   p.v reject r.cilo r.cihi</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 100 test_parameters: CIs (pars: m~x)        m~x 1.000  0.800  0.552  1.048</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 125 test_parameters: CIs (pars: m~x)        m~x 1.000  1.000  1.000  1.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Notes:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - n: The sample size in a trial.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - p.v: The proportion of valid replications.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - reject: The proportion of 'significant' replications, that is, the</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   rejection rate.If the null hypothesis is true, this is the Type I</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   error rate. If the null hypothesis is false, this is the power.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - r.cilo,r.cihi: The confidence interval of the rejection rate, based</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   on normal approximation.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - Refer to the tests for the meanings of other columns.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> - 'nls()' estimation skipped when less than 4 values of predictor examined.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - Power Curve:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> power_curve(object = by_x_i, formula = power_model, start = start, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     lower_bound = lower_bound, upper_bound = upper_bound, nls_args = nls_args, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     nls_control = nls_control, verbose = progress)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Predictor: n (Sample Size)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:  stats::glm(formula = reject ~ x, family = "binomial", data = reject1)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)            x  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    -75.3328       0.7672  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Degrees of Freedom: 19 Total (i.e. Null);  18 Residual</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Null Deviance:	    13 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual Deviance: 10.01 	AIC: 14.01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> --- Trial 1 ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - Start at 2025-06-03 13:22:03 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - Value(s) to try: 98, 101 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - Numbers of replications: 10, 10 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Updating the simulation for sample size: 98 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Displaying progress enabled. Set 'progress = FALSE' to hide the progress.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Re-simulate the data:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fit the model(s):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Generate Monte Carlo estimates:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Update the test(s):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Update test_parameters: CIs (pars: m~x) :</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Updating the simulation for sample size: 101 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Displaying progress enabled. Set 'progress = FALSE' to hide the progress.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Re-simulate the data:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fit the model(s):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Generate Monte Carlo estimates:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Update the test(s):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Update test_parameters: CIs (pars: m~x) :</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - Rejection Rates:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     n                             test test_label   p.v reject r.cilo r.cihi</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  98 test_parameters: CIs (pars: m~x)        m~x 1.000  0.800  0.552  1.048</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 100 test_parameters: CIs (pars: m~x)        m~x 1.000  0.800  0.552  1.048</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 101 test_parameters: CIs (pars: m~x)        m~x 1.000  0.900  0.714  1.086</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 125 test_parameters: CIs (pars: m~x)        m~x 1.000  1.000  1.000  1.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Notes:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - n: The sample size in a trial.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - p.v: The proportion of valid replications.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - reject: The proportion of 'significant' replications, that is, the</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   rejection rate.If the null hypothesis is true, this is the Type I</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   error rate. If the null hypothesis is false, this is the power.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - r.cilo,r.cihi: The confidence interval of the rejection rate, based</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   on normal approximation.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - Refer to the tests for the meanings of other columns.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> - 'nls()' estimation failed. Switch to logistic regression.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Updating the simulation for sample size: 102 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Displaying progress enabled. Set 'progress = FALSE' to hide the progress.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Re-simulate the data:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fit the model(s):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Generate Monte Carlo estimates:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Update the test(s):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Update test_parameters: CIs (pars: m~x) :</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - Extrapolated value: 102 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - Estimated power for 102: 1.0000</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> - 'nls()' estimation failed. Switch to logistic regression.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - Power Curve:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> power_curve(object = by_x_1, formula = power_model, start = start, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     lower_bound = lower_bound, upper_bound = upper_bound, nls_args = nls_args, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     nls_control = nls_control, verbose = progress)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Predictor: n (Sample Size)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:  stats::glm(formula = reject ~ x, family = "binomial", data = reject1)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)            x  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     -20.886        0.226  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Degrees of Freedom: 39 Total (i.e. Null);  38 Residual</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Null Deviance:	    30.14 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual Deviance: 26.78 	AIC: 30.78</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - Estimated power is close enough to target power (0.8000). (CI: [0.7141,1.0859])</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> --- Final Stage ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - Start at 2025-06-03 13:22:15 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - Rejection Rates:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     n                             test test_label   p.v reject r.cilo r.cihi</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  98 test_parameters: CIs (pars: m~x)        m~x 1.000  0.800  0.552  1.048</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 100 test_parameters: CIs (pars: m~x)        m~x 1.000  0.800  0.552  1.048</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 101 test_parameters: CIs (pars: m~x)        m~x 1.000  0.900  0.714  1.086</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 102 test_parameters: CIs (pars: m~x)        m~x 1.000  1.000  1.000  1.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 125 test_parameters: CIs (pars: m~x)        m~x 1.000  1.000  1.000  1.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Notes:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - n: The sample size in a trial.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - p.v: The proportion of valid replications.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - reject: The proportion of 'significant' replications, that is, the</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   rejection rate.If the null hypothesis is true, this is the Type I</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   error rate. If the null hypothesis is false, this is the power.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - r.cilo,r.cihi: The confidence interval of the rejection rate, based</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   on normal approximation.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - Refer to the tests for the meanings of other columns.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - Estimated Power Curve:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> power_curve(object = by_x_1, formula = power_model, start = stats::coef(fit_1), </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     lower_bound = lower_bound, upper_bound = upper_bound, nls_args = nls_args, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     nls_control = nls_control, verbose = progress)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Predictor: n (Sample Size)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:  stats::glm(formula = reject ~ x, family = "binomial", data = reject1)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)            x  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    -41.3415       0.4333  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Degrees of Freedom: 49 Total (i.e. Null);  48 Residual</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Null Deviance:	    32.51 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual Deviance: 28.31 	AIC: 32.31</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - Final Value: 101 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - Final Estimated Power: 0.9000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - Confidence Interval: [0.7141; 1.0859]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - CI Level: 95.00%</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">power_vs_n</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ====== x_from_power Results ======</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x_from_power(object = test_out, x = "n", target_power = 0.8, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     xs_per_trial = 1, progress = TRUE, max_trials = 1, final_nrep = 10, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     nrep_steps = 1, seed = 4567)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Predictor (x): Sample Size </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - Target Power: 0.800 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> === Major Results ===</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - Final Value: 101 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - Final Estimated Power: 0.900 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - Confidence Interval: [0.714; 1.086]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - Level of confidence: 95.0%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - Based on 10 replications.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> === Technical Information ===</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - The range of values explored: 98 to 125 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - Time spent in the search: 15.45 secs </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - The final crude model for the power-predictor relation:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model Type: Logistic Regression </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> power_curve(object = by_x_1, formula = power_model, start = stats::coef(fit_1), </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     lower_bound = lower_bound, upper_bound = upper_bound, nls_args = nls_args, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     nls_control = nls_control, verbose = progress)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Predictor: n (Sample Size)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:  stats::glm(formula = reject ~ x, family = "binomial", data = reject1)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)            x  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    -41.3415       0.4333  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Degrees of Freedom: 49 Total (i.e. Null);  48 Residual</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Null Deviance:	    32.51 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual Deviance: 28.31 	AIC: 32.31</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - Detailed Results:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     n                             test test_label   p.v reject r.cilo r.cihi</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  98 test_parameters: CIs (pars: m~x)        m~x 1.000  0.800  0.552  1.048</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 100 test_parameters: CIs (pars: m~x)        m~x 1.000  0.800  0.552  1.048</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 101 test_parameters: CIs (pars: m~x)        m~x 1.000  0.900  0.714  1.086</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 102 test_parameters: CIs (pars: m~x)        m~x 1.000  1.000  1.000  1.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 125 test_parameters: CIs (pars: m~x)        m~x 1.000  1.000  1.000  1.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Notes:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - n: The sample size in a trial.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - p.v: The proportion of valid replications.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - reject: The proportion of 'significant' replications, that is, the</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   rejection rate.If the null hypothesis is true, this is the Type I</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   error rate. If the null hypothesis is false, this is the power.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - r.cilo,r.cihi: The confidence interval of the rejection rate, based</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   on normal approximation.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - Refer to the tests for the meanings of other columns.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">power_vs_n</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="x_from_power-1.png" alt="" width="576" height="384"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Shu Fai Cheung, Sing-Hang Cheung, Wendie Yang.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

