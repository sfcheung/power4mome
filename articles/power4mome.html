<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Power Analysis for Moderation, Mediation, and Moderated-Mediation • power4mome</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Hind-0.4.10/font.css" rel="stylesheet">
<link href="../deps/Oxygen_Mono-0.4.10/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Power Analysis for Moderation, Mediation, and Moderated-Mediation">
<meta name="google-site-verification" content="0VLBmFnW_UJFI-7gXnORPBsWxqZwmzuGpK-TeVRLBjQ">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">power4mome</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.1.9</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/power4mome.html">Get started</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/main_workflow.html">Main Workflows</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Power Analysis for Moderation, Mediation, and Moderated-Mediation</h1>
                        <h4 data-toc-skip class="author">Shu Fai Cheung
&amp; Sing-Hang Cheung</h4>
            
            <h4 data-toc-skip class="date">2025-05-08</h4>
      

      <div class="d-none name"><code>power4mome.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This article is a brief illustration of how to use
<code><a href="../reference/power4test.html">power4test()</a></code> from the package <a href="https://sfcheung.github.io/power4mome/">power4mome</a> to do power
analysis of Mediation, moderation, and moderated-mediation in a model to
be fitted by structural equation model modeling using
<code>lavaan</code>.</p>
</div>
<div class="section level2">
<h2 id="prerequisite">Prerequisite<a class="anchor" aria-label="anchor" href="#prerequisite"></a>
</h2>
<p>Basic knowledge about fitting models by <code>lavaan</code> is
required. Readers are also expected to have basic knowledge of
mediation, moderation, and/or moderated mediation.</p>
</div>
<div class="section level2">
<h2 id="scope">Scope<a class="anchor" aria-label="anchor" href="#scope"></a>
</h2>
<p>This is a brief illustration. More complicated scenarios and other
features of <code>power4mome</code> will be described in other
vignettes.</p>
</div>
<div class="section level2">
<h2 id="package">Package<a class="anchor" aria-label="anchor" href="#package"></a>
</h2>
<p>This introduction only needs the following package(s):</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://sfcheung.github.io/power4mome/">power4mome</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="workflow">Workflow<a class="anchor" aria-label="anchor" href="#workflow"></a>
</h2>
<p>Two functions are sufficient for estimating power give a particular
model, population values, sample size, and the test to be used. This is
the basic workflow:</p>
<ol style="list-style-type: decimal">
<li><p>Specify the model syntax for the population model, in
<code>lavaan</code> style, and set the population values of the model
parameters.</p></li>
<li><p>Call <code><a href="../reference/power4test.html">power4test()</a></code> to examine the setup and the
datasets generated. Repeat previous steps until the model is specified
correctly.</p></li>
<li><p>Call <code><a href="../reference/power4test.html">power4test()</a></code> again, with the test to do
specified.</p></li>
<li><p>Call <code><a href="../reference/get_rejection_rates.html">get_rejection_rates()</a></code> to compute the
power.</p></li>
</ol>
</div>
<div class="section level2">
<h2 id="packages">Packages<a class="anchor" aria-label="anchor" href="#packages"></a>
</h2>
<p>Only the package <code>power4mome</code> is needed in this
vignette.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://sfcheung.github.io/power4mome/">power4mome</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="mediation">Mediation<a class="anchor" aria-label="anchor" href="#mediation"></a>
</h2>
<p>Let’s consider a simple mediation model. We would like to estimate
the power of testing a mediation effect by Monte Carlo confidence
interval.</p>
<div class="section level3">
<h3 id="specify-the-population-model">Specify the Population Model<a class="anchor" aria-label="anchor" href="#specify-the-population-model"></a>
</h3>
<p>This is the model syntax</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod</span> <span class="op">&lt;-</span></span>
<span><span class="st">"</span></span>
<span><span class="st">m ~ x</span></span>
<span><span class="st">y ~ m + x</span></span>
<span><span class="st">"</span></span></code></pre></div>
<p>Note that, even if we are going to test mediation, moderation, or
moderated-mediation effects, we do not need to add any labels to this
model. This will be taken care of by the test functions, through the use
of the package <a href="https://sfcheung.github.io/manymome/index.html02224-z" class="external-link"><code>manymome</code></a>
<span class="citation">(Cheung &amp; Cheung, 2024)</span>.</p>
</div>
<div class="section level3">
<h3 id="es_convention">Specify The Population Values<a class="anchor" aria-label="anchor" href="#es_convention"></a>
</h3>
<p>There are two approaches to do this: using named vectors or lists, or
using a long string similar to <code>lavaan</code> model syntax. The
second approach is demonstrated below.</p>
<p>Suppose we want to estimate the power when:</p>
<ul>
<li><p>The path from <code>x</code> to <code>m</code> are “large” in
strength.</p></li>
<li><p>The path from <code>m</code> to <code>y</code> are “medium” in
strength.</p></li>
<li><p>The path from <code>x</code> to <code>m</code> are “small” in
strength.</p></li>
</ul>
<p>By default, <code>power4mome</code> use this convention for
regression path and correlation:<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt; Users can explicitly specify the values if this
convention is not suitable.&lt;/p&gt;"><sup>1</sup></a></p>
<ul>
<li><p>Small: .10 (or -.10)</p></li>
<li><p>Medium: .30 (or -.30)</p></li>
<li><p>Large: .50 (or -.50)</p></li>
</ul>
<p>For product term, this is the convention:</p>
<ul>
<li><p>Small: .05 (or -.05)</p></li>
<li><p>Medium: .10 (or -.10)</p></li>
<li><p>Large: .15 (or -.15)</p></li>
</ul>
<p>All these values are for the standardized solution (the so-called
“betas”).</p>
<p>The following string denote the desired values:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod_es</span> <span class="op">&lt;-</span></span>
<span><span class="st">"</span></span>
<span><span class="st">m ~ x: l</span></span>
<span><span class="st">y ~ m: m</span></span>
<span><span class="st">y ~ x: s</span></span>
<span><span class="st">"</span></span></code></pre></div>
<p>Each line starts with a <em>tag</em>, which is the parameter
presented in <code>lavaan</code> syntax. The tag ends with a colon,
<code>:</code>.</p>
<p>After the colon is population value, which can be:</p>
<ul>
<li>
<p>A word denoting the value. By default:</p>
<ul>
<li><p><code>s</code>: Small. (<code>-s</code> for small and
negative.)</p></li>
<li><p><code>m</code>: Medium. (<code>-m</code> for medium and
negative.)</p></li>
<li><p><code>l</code>: Large. (<code>-l</code> for large and
negative.)</p></li>
<li><p><code>nil</code>: Zero.</p></li>
</ul>
</li>
</ul>
<p>All regression coefficients and covariances, if not specified, are
set to zero.</p>
</div>
<div class="section level3">
<h3 id="call-power4test-to-check-the-model">Call <code>power4test()</code> to Check the Model<a class="anchor" aria-label="anchor" href="#call-power4test-to-check-the-model"></a>
</h3>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/power4test.html">power4test</a></span><span class="op">(</span>nrep <span class="op">=</span> <span class="fl">2</span>,</span>
<span>                  model <span class="op">=</span> <span class="va">mod</span>,</span>
<span>                  pop_es <span class="op">=</span> <span class="va">mod_es</span>,</span>
<span>                  n <span class="op">=</span> <span class="fl">50000</span>,</span>
<span>                  iseed <span class="op">=</span> <span class="fl">1234</span><span class="op">)</span></span></code></pre></div>
<p>These are the arguments used:</p>
<ul>
<li><p><code>nrep</code>: The number of replications. In this stage, a
small number can be used. It is more important to have a large sample
size.</p></li>
<li><p><code>model</code>: The model syntax.</p></li>
<li><p><code>pop_es</code>: The string setting the population
values.</p></li>
<li><p><code>n</code>: The sample size in each replications. In this
stage, just for checking the model and the data generation, this number
can be set to a large one unless the model is slow to fit when the
sample size is large.</p></li>
<li><p><code>iseed</code>: If supplied, it is used to set the seed for
the random number generator. It is advised to always set this to an
arbitrary integer, to make the results reproducible.<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;The functions used are
&lt;code&gt;&lt;a href="https://rdrr.io/r/parallel/RngStream.html" class="external-link"&gt;parallel::clusterSetRNGStream()&lt;/a&gt;&lt;/code&gt; for parallel processing,
and &lt;code&gt;&lt;a href="https://rdrr.io/r/base/Random.html" class="external-link"&gt;set.seed()&lt;/a&gt;&lt;/code&gt; for serial processing.&lt;/p&gt;'><sup>2</sup></a></p></li>
</ul>
<p>The population values can be shown by print this object:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ====================== Model Information ======================</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; == Model on Factors/Variables ==</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; m ~ x</span></span>
<span><span class="co">#&gt; y ~ m + x</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; == Model on Variables/Indicators ==</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; m ~ x</span></span>
<span><span class="co">#&gt; y ~ m + x</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ====== Population Values ======</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Regressions:</span></span>
<span><span class="co">#&gt;                    Population</span></span>
<span><span class="co">#&gt;   m ~                        </span></span>
<span><span class="co">#&gt;     x                 0.500  </span></span>
<span><span class="co">#&gt;   y ~                        </span></span>
<span><span class="co">#&gt;     m                 0.300  </span></span>
<span><span class="co">#&gt;     x                 0.100  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Variances:</span></span>
<span><span class="co">#&gt;                    Population</span></span>
<span><span class="co">#&gt;    .m                 0.750  </span></span>
<span><span class="co">#&gt;    .y                 0.870  </span></span>
<span><span class="co">#&gt;     x                 1.000  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ======================= Data Information =======================</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of Replications:  2 </span></span>
<span><span class="co">#&gt; Sample Sizes:  50000 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call print with 'data_long = TRUE' for further information.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ==================== Extra Element(s) Found ====================</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - fit</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; === Element(s) of the First Dataset ===</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ============ &lt;fit&gt; ============</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; lavaan 0.6-19 ended normally after 1 iteration</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Estimator                                         ML</span></span>
<span><span class="co">#&gt;   Optimization method                           NLMINB</span></span>
<span><span class="co">#&gt;   Number of model parameters                         5</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Number of observations                         50000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model Test User Model:</span></span>
<span><span class="co">#&gt;                                                       </span></span>
<span><span class="co">#&gt;   Test statistic                                 0.000</span></span>
<span><span class="co">#&gt;   Degrees of freedom                                 0</span></span></code></pre></div>
<p>By the default, the population model will be fitted to each dataset,
hence the section <code>&lt;fit&gt;</code>.</p>
<p>The population values for the regression paths are what we
specified.</p>
<p>If necessary, we can check the data generation by adding
<code>data_long = TRUE</code> when printing the output:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">out</span>,</span>
<span>      data_long <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ====================== Model Information ======================</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; == Model on Factors/Variables ==</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; m ~ x</span></span>
<span><span class="co">#&gt; y ~ m + x</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; == Model on Variables/Indicators ==</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; m ~ x</span></span>
<span><span class="co">#&gt; y ~ m + x</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ====== Population Values ======</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Regressions:</span></span>
<span><span class="co">#&gt;                    Population</span></span>
<span><span class="co">#&gt;   m ~                        </span></span>
<span><span class="co">#&gt;     x                 0.500  </span></span>
<span><span class="co">#&gt;   y ~                        </span></span>
<span><span class="co">#&gt;     m                 0.300  </span></span>
<span><span class="co">#&gt;     x                 0.100  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Variances:</span></span>
<span><span class="co">#&gt;                    Population</span></span>
<span><span class="co">#&gt;    .m                 0.750  </span></span>
<span><span class="co">#&gt;    .y                 0.870  </span></span>
<span><span class="co">#&gt;     x                 1.000  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ======================= Data Information =======================</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of Replications:  2 </span></span>
<span><span class="co">#&gt; Sample Sizes:  50000 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ==== Descriptive Statistics ====</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   vars     n mean sd skew kurtosis se</span></span>
<span><span class="co">#&gt; m    1 1e+05 0.00  1 0.01     0.03  0</span></span>
<span><span class="co">#&gt; y    2 1e+05 0.01  1 0.01     0.00  0</span></span>
<span><span class="co">#&gt; x    3 1e+05 0.00  1 0.01     0.01  0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ===== Parameter Estimates Based on All 2 Samples Combined =====</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Total Sample Size: 100000 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ==== Standardized Estimates ====</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Variances and error variances omitted.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Regressions:</span></span>
<span><span class="co">#&gt;                     est.std</span></span>
<span><span class="co">#&gt;   m ~                      </span></span>
<span><span class="co">#&gt;     x                 0.500</span></span>
<span><span class="co">#&gt;   y ~                      </span></span>
<span><span class="co">#&gt;     m                 0.295</span></span>
<span><span class="co">#&gt;     x                 0.102</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ==================== Extra Element(s) Found ====================</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - fit</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; === Element(s) of the First Dataset ===</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ============ &lt;fit&gt; ============</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; lavaan 0.6-19 ended normally after 1 iteration</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Estimator                                         ML</span></span>
<span><span class="co">#&gt;   Optimization method                           NLMINB</span></span>
<span><span class="co">#&gt;   Number of model parameters                         5</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Number of observations                         50000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model Test User Model:</span></span>
<span><span class="co">#&gt;                                                       </span></span>
<span><span class="co">#&gt;   Test statistic                                 0.000</span></span>
<span><span class="co">#&gt;   Degrees of freedom                                 0</span></span></code></pre></div>
<p>The section <code>Descriptive Statistics</code>, generated by
<code><a href="https://rdrr.io/pkg/psych/man/describe.html" class="external-link">psych::describe()</a></code>, shows basic descriptive statistics for
the observed variables. As expected, they have means close to zero and
standard deviations close to one, because the datasets were generated
using the standardized model.</p>
<p>The section <code>Parameter Estimates Based on</code> shows the
parameter estimates when the population model is fitted to all the
datasets combined. When the total sample size is large, these estimates
should be close to the population values.</p>
<p>The results show that population model is the desired one.</p>
</div>
<div class="section level3">
<h3 id="med_power">Call <code>power4test()</code> to Do the Target Test<a class="anchor" aria-label="anchor" href="#med_power"></a>
</h3>
<p>We can now do the simulation to estimate power. A large number of
datasets (e.g., 500) of the target sample size are to be generated, and
then the target test will be conducted in each of these datasets.</p>
<p>Suppose we would like to estimate the power of using Monte Carlo
confidence interval to test the indirect effect from <code>x</code> to
<code>y</code> through <code>m</code>, when sample size is 50. This is
the call:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/power4test.html">power4test</a></span><span class="op">(</span>nrep <span class="op">=</span> <span class="fl">100</span>,</span>
<span>                  model <span class="op">=</span> <span class="va">mod</span>,</span>
<span>                  pop_es <span class="op">=</span> <span class="va">mod_es</span>,</span>
<span>                  n <span class="op">=</span> <span class="fl">50</span>,</span>
<span>                  R <span class="op">=</span> <span class="fl">2000</span>,</span>
<span>                  ci_type <span class="op">=</span> <span class="st">"mc"</span>,</span>
<span>                  test_fun <span class="op">=</span> <span class="va">test_indirect_effect</span>,</span>
<span>                  test_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"x"</span>,</span>
<span>                                   m <span class="op">=</span> <span class="st">"m"</span>,</span>
<span>                                   y <span class="op">=</span> <span class="st">"y"</span>,</span>
<span>                                   mc_ci <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>                  iseed <span class="op">=</span> <span class="fl">1234</span>,</span>
<span>                  parallel <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>These are the new arguments used:</p>
<ul>
<li><p><code>R</code>: The number of replications used to generate the
Monte Carlo simulated estimates, 2000 in this example.</p></li>
<li><p><code>ci_type</code>: The method used to generate estimates.
Support Monte Carlo (<code>"mc"</code>) and nonparametric bootstrapping
(<code>"boot"</code>).<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;They are implemented by &lt;code&gt;&lt;a href="https://sfcheung.github.io/manymome/reference/do_mc.html" class="external-link"&gt;manymome::do_mc()&lt;/a&gt;&lt;/code&gt;
and &lt;code&gt;&lt;a href="https://sfcheung.github.io/manymome/reference/do_boot.html" class="external-link"&gt;manymome::do_boot()&lt;/a&gt;&lt;/code&gt;, respectively.&lt;/p&gt;'><sup>3</sup></a> Although bootstrapping is usually used to
test an indirect effect, it is very slow to do <code>R</code>
bootstrapping in <code>nrep</code> datasets (the model will be fitted
<code>R*nrep</code> times). Therefore, it is preferable to use Monte
Carlo to do the initial estimation.</p></li>
<li><p><code>test_fun</code>: The function to be used to do the test for
each replication. Any function following a specific requirement can be
used, and <code>power4mome</code> comes with several built-in function
for some tests. The function <code><a href="../reference/test_indirect_effect.html">test_indirect_effect()</a></code> is used
to test an indirect effect in the model.</p></li>
<li><p><code>test_args</code>: A named list of arguments to be supplied
to <code>test_fun</code>. For <code><a href="../reference/test_indirect_effect.html">test_indirect_effect()</a></code>, it is
a named list specifying the predictor (<code>x</code>), the mediator(s)
(<code>m</code>), and the outcome (<code>y</code>). A path with any
number of mediators can be supported. Please refer to the help page of
<code><a href="../reference/test_indirect_effect.html">test_indirect_effect()</a></code>.<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;The test is implemented by
&lt;code&gt;manymome::indirect()&lt;/code&gt;.&lt;/p&gt;"><sup>4</sup></a></p></li>
<li><p><code>parallel</code>: If the test to be conducted is slow, which
is the case for test done by Monte Carlo or nonparametric bootstrapping
confidence interval, it is advised to enable parallel processing by
setting <code>parallel</code> to <code>TRUE</code>.<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;The number of cores is determined automatically but can
be set directly by the &lt;code&gt;ncores&lt;/code&gt; argument.&lt;/p&gt;"><sup>5</sup></a></p></li>
</ul>
<p>This is the default printout:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ====================== Model Information ======================</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; == Model on Factors/Variables ==</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; m ~ x</span></span>
<span><span class="co">#&gt; y ~ m + x</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; == Model on Variables/Indicators ==</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; m ~ x</span></span>
<span><span class="co">#&gt; y ~ m + x</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ====== Population Values ======</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Regressions:</span></span>
<span><span class="co">#&gt;                    Population</span></span>
<span><span class="co">#&gt;   m ~                        </span></span>
<span><span class="co">#&gt;     x                 0.500  </span></span>
<span><span class="co">#&gt;   y ~                        </span></span>
<span><span class="co">#&gt;     m                 0.300  </span></span>
<span><span class="co">#&gt;     x                 0.100  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Variances:</span></span>
<span><span class="co">#&gt;                    Population</span></span>
<span><span class="co">#&gt;    .m                 0.750  </span></span>
<span><span class="co">#&gt;    .y                 0.870  </span></span>
<span><span class="co">#&gt;     x                 1.000  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ======================= Data Information =======================</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of Replications:  100 </span></span>
<span><span class="co">#&gt; Sample Sizes:  50 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call print with 'data_long = TRUE' for further information.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ==================== Extra Element(s) Found ====================</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - fit</span></span>
<span><span class="co">#&gt; - mc_out</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; === Element(s) of the First Dataset ===</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ============ &lt;fit&gt; ============</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; lavaan 0.6-19 ended normally after 1 iteration</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Estimator                                         ML</span></span>
<span><span class="co">#&gt;   Optimization method                           NLMINB</span></span>
<span><span class="co">#&gt;   Number of model parameters                         5</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Number of observations                            50</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model Test User Model:</span></span>
<span><span class="co">#&gt;                                                       </span></span>
<span><span class="co">#&gt;   Test statistic                                 0.000</span></span>
<span><span class="co">#&gt;   Degrees of freedom                                 0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; =========== &lt;mc_out&gt; ===========</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; == A 'mc_out' class object ==</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of Monte Carlo replications: 2000 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ====================== Test(s) Conducted ======================</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - test_indirect: x-&gt;m-&gt;y</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call print() and set 'test_long = TRUE' for a detailed report.</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="compute-the-power">Compute the Power<a class="anchor" aria-label="anchor" href="#compute-the-power"></a>
</h3>
<p>The power estimate is simply the proportion of significant results,
the <em>rejection</em> <em>rate</em>, because the null hypothesis is
false. The rejection rate can be retrieved by
<code><a href="../reference/get_rejection_rates.html">get_rejection_rates()</a></code>.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out_power</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_rejection_rates.html">get_rejection_rates</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span></span></code></pre></div>
<p>The output is simply a data frame:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out_power</span></span>
<span><span class="co">#&gt;                     test test_label pvalid reject</span></span>
<span><span class="co">#&gt; 1 test_indirect: x-&gt;m-&gt;y       Test      1   0.43</span></span></code></pre></div>
<p>In the example above, the estimated power of the test of the indirect
effect, conducted by Monte Carlo confidence interval, is 0.430.<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;&lt;code&gt;pvalid&lt;/code&gt; is the proportion of valid results
across replications. &lt;code&gt;1&lt;/code&gt; means that the test conducted
normally in all replications.&lt;/p&gt;"><sup>6</sup></a></p>
</div>
</div>
<div class="section level2">
<h2 id="moderation">Moderation<a class="anchor" aria-label="anchor" href="#moderation"></a>
</h2>
<p>Let’s consider a moderation model, with some control variables.</p>
<div class="section level3">
<h3 id="pop_es_xw">Specify the Population Model and Values<a class="anchor" aria-label="anchor" href="#pop_es_xw"></a>
</h3>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod</span> <span class="op">&lt;-</span></span>
<span><span class="st">"</span></span>
<span><span class="st">y ~ x + w + x:w + control</span></span>
<span><span class="st">"</span></span></code></pre></div>
<p>This model has only moderation, with the predictor <code>x</code> and
the moderator <code>w</code>. The product term is included in the
<code>lavaan</code> style, <code>x:w</code>.</p>
<p>It is unrealistic to specific the population values for all control
variables. Therefore, we can just add a proxy, <code>control</code> to
represent the set of control variables that may be included.</p>
<p>This is the syntax for the population values:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod_es</span> <span class="op">&lt;-</span></span>
<span><span class="st">"</span></span>
<span><span class="st">.beta.: s</span></span>
<span><span class="st">x ~~ control: s</span></span>
<span><span class="st">y ~ control: m</span></span>
<span><span class="st">y ~ x:w: m</span></span>
<span><span class="st">"</span></span></code></pre></div>
<p>This example introduce one useful tag, <code>.beta.</code> For a
model with many paths, it is inconvenient to specify all of them
manually. The tag <code>.beta</code> specify the default value for all
regression path, which is small (.10) in this example. If a path is
explicitly included (such as <code>y ~ control</code> and
<code>y ~ x:w</code>), the values will override that of
<code>.beta.</code>.</p>
<p>This example also illustrates that we can set the population values
for correlation (covariance in the standardized solution). Control
variables are included usually because they may correlate with the
predictors. Therefore, in this example, it is hypothesized that there is
a small correlation between <code>x</code> and the control variable
(<code>x ~~ control: s</code>).</p>
<p>Last, recall from <a href="#es_convention">this section</a> that the
convention for product term values are different: <code>s</code> denotes
.05 for product terms.</p>
</div>
<div class="section level3">
<h3 id="call-power4test-to-check-the-model-1">Call <code>power4test()</code> to Check the Model<a class="anchor" aria-label="anchor" href="#call-power4test-to-check-the-model-1"></a>
</h3>
<p>We check the model first:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/power4test.html">power4test</a></span><span class="op">(</span>nrep <span class="op">=</span> <span class="fl">2</span>,</span>
<span>                  model <span class="op">=</span> <span class="va">mod</span>,</span>
<span>                  pop_es <span class="op">=</span> <span class="va">mod_es</span>,</span>
<span>                  n <span class="op">=</span> <span class="fl">50000</span>,</span>
<span>                  iseed <span class="op">=</span> <span class="fl">1234</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">out</span>,</span>
<span>      data_long <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ====================== Model Information ======================</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; == Model on Factors/Variables ==</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; y ~ x + w + x:w + control</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; == Model on Variables/Indicators ==</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; y ~ x + w + x:w + control</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ====== Population Values ======</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Regressions:</span></span>
<span><span class="co">#&gt;                    Population</span></span>
<span><span class="co">#&gt;   y ~                        </span></span>
<span><span class="co">#&gt;     x                 0.100  </span></span>
<span><span class="co">#&gt;     w                 0.100  </span></span>
<span><span class="co">#&gt;     x:w               0.100  </span></span>
<span><span class="co">#&gt;     control           0.300  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Covariances:</span></span>
<span><span class="co">#&gt;                    Population</span></span>
<span><span class="co">#&gt;   x ~~                       </span></span>
<span><span class="co">#&gt;     w                 0.000  </span></span>
<span><span class="co">#&gt;     x:w               0.000  </span></span>
<span><span class="co">#&gt;     control           0.100  </span></span>
<span><span class="co">#&gt;   w ~~                       </span></span>
<span><span class="co">#&gt;     x:w               0.000  </span></span>
<span><span class="co">#&gt;     control           0.000  </span></span>
<span><span class="co">#&gt;   x:w ~~                     </span></span>
<span><span class="co">#&gt;     control           0.000  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Variances:</span></span>
<span><span class="co">#&gt;                    Population</span></span>
<span><span class="co">#&gt;    .y                 0.874  </span></span>
<span><span class="co">#&gt;     x                 1.000  </span></span>
<span><span class="co">#&gt;     w                 1.000  </span></span>
<span><span class="co">#&gt;     x:w               1.000  </span></span>
<span><span class="co">#&gt;     control           1.000  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ======================= Data Information =======================</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of Replications:  2 </span></span>
<span><span class="co">#&gt; Sample Sizes:  50000 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ==== Descriptive Statistics ====</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;         vars     n mean sd  skew kurtosis se</span></span>
<span><span class="co">#&gt; y          1 1e+05 0.00  1  0.02     0.00  0</span></span>
<span><span class="co">#&gt; x          2 1e+05 0.00  1  0.01     0.01  0</span></span>
<span><span class="co">#&gt; w          3 1e+05 0.00  1  0.00    -0.02  0</span></span>
<span><span class="co">#&gt; x:w        4 1e+05 0.00  1 -0.03     6.01  0</span></span>
<span><span class="co">#&gt; control    5 1e+05 0.01  1  0.00     0.00  0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ===== Parameter Estimates Based on All 2 Samples Combined =====</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Total Sample Size: 100000 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ==== Standardized Estimates ====</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Variances and error variances omitted.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Regressions:</span></span>
<span><span class="co">#&gt;                     est.std</span></span>
<span><span class="co">#&gt;   y ~                      </span></span>
<span><span class="co">#&gt;     x                 0.098</span></span>
<span><span class="co">#&gt;     w                 0.104</span></span>
<span><span class="co">#&gt;     x:w               0.102</span></span>
<span><span class="co">#&gt;     control           0.299</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Covariances:</span></span>
<span><span class="co">#&gt;                     est.std</span></span>
<span><span class="co">#&gt;   x ~~                     </span></span>
<span><span class="co">#&gt;     w                -0.003</span></span>
<span><span class="co">#&gt;     x:w               0.002</span></span>
<span><span class="co">#&gt;     control           0.101</span></span>
<span><span class="co">#&gt;   w ~~                     </span></span>
<span><span class="co">#&gt;     x:w              -0.004</span></span>
<span><span class="co">#&gt;     control           0.001</span></span>
<span><span class="co">#&gt;   x:w ~~                   </span></span>
<span><span class="co">#&gt;     control           0.004</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ==================== Extra Element(s) Found ====================</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - fit</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; === Element(s) of the First Dataset ===</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ============ &lt;fit&gt; ============</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; lavaan 0.6-19 ended normally after 1 iteration</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Estimator                                         ML</span></span>
<span><span class="co">#&gt;   Optimization method                           NLMINB</span></span>
<span><span class="co">#&gt;   Number of model parameters                         5</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Number of observations                         50000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model Test User Model:</span></span>
<span><span class="co">#&gt;                                                       </span></span>
<span><span class="co">#&gt;   Test statistic                                 0.000</span></span>
<span><span class="co">#&gt;   Degrees of freedom                                 0</span></span></code></pre></div>
<p>The population values for the regression paths are what we specified,
and the estimates based on 5 × 10<sup>4</sup> by 2 or 100000 support
that the dataset were generated correctly.</p>
</div>
<div class="section level3">
<h3 id="call-power4test-to-test-the-moderation-effect">Call <code>power4test()</code> to Test The Moderation Effect<a class="anchor" aria-label="anchor" href="#call-power4test-to-test-the-moderation-effect"></a>
</h3>
<p>We can now do the simulation to estimate power. In this simple model,
the test is just a test of the product term, <code>x:w</code>. This
model can be fitted by linear regression using <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm()</a></code>. Let’s
estimate the power when the sample size is 50 and the model is fitted by
<code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm()</a></code>:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/power4test.html">power4test</a></span><span class="op">(</span>nrep <span class="op">=</span> <span class="fl">500</span>,</span>
<span>                  model <span class="op">=</span> <span class="va">mod</span>,</span>
<span>                  pop_es <span class="op">=</span> <span class="va">mod_es</span>,</span>
<span>                  n <span class="op">=</span> <span class="fl">50</span>,</span>
<span>                  fit_model_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>fit_function <span class="op">=</span> <span class="st">"lm"</span><span class="op">)</span>,</span>
<span>                  test_fun <span class="op">=</span> <span class="va">test_moderation</span>,</span>
<span>                  iseed <span class="op">=</span> <span class="fl">1234</span>,</span>
<span>                  parallel <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>These are the new arguments used:</p>
<ul>
<li><p><code>fit_model_args</code>: This named list is arguments for
<code><a href="../reference/fit_model.html">fit_model()</a></code>. By default, <code><a href="https://rdrr.io/pkg/lavaan/man/sem.html" class="external-link">lavaan::sem()</a></code> is
used. To fit the model by linear regression using <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm()</a></code>, add
<code>fit_function = "lm"</code> to the list.<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;See the help page of &lt;code&gt;&lt;a href="../reference/fit_model.html"&gt;fit_model()&lt;/a&gt;&lt;/code&gt; on other
available arguments.&lt;/p&gt;'><sup>7</sup></a></p></li>
<li><p><code>test_fun</code>: It is set to <code>test_moderation</code>
in this example. This function automatically identify all product terms
in a model and test them. The test used depends on method used to fit
the model. If <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm()</a></code> is used, then the usual <em>t</em> test
is used.<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;The test name has &lt;code&gt;CIs&lt;/code&gt; in it but this is
equivalent to using the &lt;em&gt;t&lt;/em&gt; test when the model is fitted by
&lt;code&gt;&lt;a href="https://rdrr.io/r/stats/lm.html" class="external-link"&gt;lm()&lt;/a&gt;&lt;/code&gt;.&lt;/p&gt;'><sup>8</sup></a></p></li>
</ul>
</div>
<div class="section level3">
<h3 id="compute-the-power-1">Compute the Power<a class="anchor" aria-label="anchor" href="#compute-the-power-1"></a>
</h3>
<p>We can ues <code><a href="../reference/get_rejection_rates.html">get_rejection_rates()</a></code> again to estimate the
power:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out_power</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_rejection_rates.html">get_rejection_rates</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span></span>
<span><span class="va">out_power</span></span>
<span><span class="co">#&gt;                    test test_label pvalid reject</span></span>
<span><span class="co">#&gt; 1 test_moderation: CIs       y~x:w      1  0.118</span></span></code></pre></div>
<p>The estimated power of the test of the product term,
<code>x:w</code>, is 0.118.</p>
<p>The function <code><a href="../reference/power4test.html">power4test()</a></code> also supports redoing an
analysis using a new value for the sample size. Simply set the output of
<code>power4test</code> as the first argument, and set the new value for
<code>n</code>:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out_new_n</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/power4test.html">power4test</a></span><span class="op">(</span><span class="va">out</span>,</span>
<span>                        n <span class="op">=</span> <span class="fl">200</span><span class="op">)</span></span>
<span><span class="va">out_new_n</span></span></code></pre></div>
<p>This is the estimated power when the sample size is 200.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out_new_n_reject</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_rejection_rates.html">get_rejection_rates</a></span><span class="op">(</span><span class="va">out_new_n</span><span class="op">)</span></span>
<span><span class="va">out_new_n_reject</span></span>
<span><span class="co">#&gt;                    test test_label pvalid reject</span></span>
<span><span class="co">#&gt; 1 test_moderation: CIs       y~x:w      1  0.296</span></span></code></pre></div>
<p>The estimated power is 0.296 when the sample size is 200. This
process can be repeated to find the required sample size for a target
power. (The function <code><a href="../reference/power4test_by_n.html">power4test_by_n()</a></code> can be used To
estimate the power for a sequence of sample sizes.)</p>
</div>
</div>
<div class="section level2">
<h2 id="moderated-mediation">Moderated-Mediation<a class="anchor" aria-label="anchor" href="#moderated-mediation"></a>
</h2>
<p>Let’s consider a moderated mediation model.</p>
<div class="section level3">
<h3 id="specify-the-population-model-and-values">Specify the Population Model and Values<a class="anchor" aria-label="anchor" href="#specify-the-population-model-and-values"></a>
</h3>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod</span> <span class="op">&lt;-</span></span>
<span><span class="st">"</span></span>
<span><span class="st">m ~ x + w + x:w</span></span>
<span><span class="st">y ~ m + x</span></span>
<span><span class="st">"</span></span></code></pre></div>
<p>This model is a mediation model with the <em>a</em>-path,
<code>m ~ x</code>, moderated by <code>w</code>. As explained before,
there is no need to use any label nor define and parameters. This will
be handled by the test function to be used.</p>
<p>This is the syntax for the population values:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod_es</span> <span class="op">&lt;-</span></span>
<span><span class="st">"</span></span>
<span><span class="st">.beta.: s</span></span>
<span><span class="st">m ~ x: m</span></span>
<span><span class="st">y ~ m: m</span></span>
<span><span class="st">m ~ x:w: s</span></span>
<span><span class="st">"</span></span></code></pre></div>
<p>Please refer to <a href="#pop_es_xw">the previous section</a> on
setting up this syntax.</p>
</div>
<div class="section level3">
<h3 id="call-power4test-to-check-the-model-2">Call <code>power4test()</code> to Check the Model<a class="anchor" aria-label="anchor" href="#call-power4test-to-check-the-model-2"></a>
</h3>
<p>We check the model first:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/power4test.html">power4test</a></span><span class="op">(</span>nrep <span class="op">=</span> <span class="fl">2</span>,</span>
<span>                  model <span class="op">=</span> <span class="va">mod</span>,</span>
<span>                  pop_es <span class="op">=</span> <span class="va">mod_es</span>,</span>
<span>                  n <span class="op">=</span> <span class="fl">50000</span>,</span>
<span>                  iseed <span class="op">=</span> <span class="fl">1234</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">out</span>,</span>
<span>      data_long <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ====================== Model Information ======================</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; == Model on Factors/Variables ==</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; m ~ x + w + x:w</span></span>
<span><span class="co">#&gt; y ~ m + x</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; == Model on Variables/Indicators ==</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; m ~ x + w + x:w</span></span>
<span><span class="co">#&gt; y ~ m + x</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ====== Population Values ======</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Regressions:</span></span>
<span><span class="co">#&gt;                    Population</span></span>
<span><span class="co">#&gt;   m ~                        </span></span>
<span><span class="co">#&gt;     x                 0.300  </span></span>
<span><span class="co">#&gt;     w                 0.100  </span></span>
<span><span class="co">#&gt;     x:w               0.050  </span></span>
<span><span class="co">#&gt;   y ~                        </span></span>
<span><span class="co">#&gt;     m                 0.300  </span></span>
<span><span class="co">#&gt;     x                 0.100  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Covariances:</span></span>
<span><span class="co">#&gt;                    Population</span></span>
<span><span class="co">#&gt;   x ~~                       </span></span>
<span><span class="co">#&gt;     w                 0.000  </span></span>
<span><span class="co">#&gt;     x:w               0.000  </span></span>
<span><span class="co">#&gt;   w ~~                       </span></span>
<span><span class="co">#&gt;     x:w               0.000  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Variances:</span></span>
<span><span class="co">#&gt;                    Population</span></span>
<span><span class="co">#&gt;    .m                 0.898  </span></span>
<span><span class="co">#&gt;    .y                 0.882  </span></span>
<span><span class="co">#&gt;     x                 1.000  </span></span>
<span><span class="co">#&gt;     w                 1.000  </span></span>
<span><span class="co">#&gt;     x:w               1.000  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ======================= Data Information =======================</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of Replications:  2 </span></span>
<span><span class="co">#&gt; Sample Sizes:  50000 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ==== Descriptive Statistics ====</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     vars     n mean sd skew kurtosis se</span></span>
<span><span class="co">#&gt; m      1 1e+05    0  1 0.03     0.03  0</span></span>
<span><span class="co">#&gt; y      2 1e+05    0  1 0.01    -0.01  0</span></span>
<span><span class="co">#&gt; x      3 1e+05    0  1 0.00    -0.02  0</span></span>
<span><span class="co">#&gt; w      4 1e+05    0  1 0.00     0.01  0</span></span>
<span><span class="co">#&gt; x:w    5 1e+05    0  1 0.04     5.92  0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ===== Parameter Estimates Based on All 2 Samples Combined =====</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Total Sample Size: 100000 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ==== Standardized Estimates ====</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Variances and error variances omitted.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Regressions:</span></span>
<span><span class="co">#&gt;                     est.std</span></span>
<span><span class="co">#&gt;   m ~                      </span></span>
<span><span class="co">#&gt;     x                 0.303</span></span>
<span><span class="co">#&gt;     w                 0.099</span></span>
<span><span class="co">#&gt;     x:w               0.052</span></span>
<span><span class="co">#&gt;   y ~                      </span></span>
<span><span class="co">#&gt;     m                 0.299</span></span>
<span><span class="co">#&gt;     x                 0.098</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Covariances:</span></span>
<span><span class="co">#&gt;                     est.std</span></span>
<span><span class="co">#&gt;   x ~~                     </span></span>
<span><span class="co">#&gt;     w                 0.003</span></span>
<span><span class="co">#&gt;     x:w              -0.001</span></span>
<span><span class="co">#&gt;   w ~~                     </span></span>
<span><span class="co">#&gt;     x:w               0.008</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ==================== Extra Element(s) Found ====================</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - fit</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; === Element(s) of the First Dataset ===</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ============ &lt;fit&gt; ============</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; lavaan 0.6-19 ended normally after 2 iterations</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Estimator                                         ML</span></span>
<span><span class="co">#&gt;   Optimization method                           NLMINB</span></span>
<span><span class="co">#&gt;   Number of model parameters                         7</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Number of observations                         50000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model Test User Model:</span></span>
<span><span class="co">#&gt;                                                       </span></span>
<span><span class="co">#&gt;   Test statistic                                 0.007</span></span>
<span><span class="co">#&gt;   Degrees of freedom                                 2</span></span>
<span><span class="co">#&gt;   P-value (Chi-square)                           0.997</span></span></code></pre></div>
<p>The population values and the estimates based on 5 × 10<sup>4</sup>
by 2 or 100000 are what we expect.</p>
</div>
<div class="section level3">
<h3 id="call-power4test-to-test-the-moderated-mediation-effect">Call <code>power4test()</code> to Test The Moderated-Mediation
Effect<a class="anchor" aria-label="anchor" href="#call-power4test-to-test-the-moderated-mediation-effect"></a>
</h3>
<p>To estimate the power of a moderated-mediation effect, we can test
the <em>index of moderated-mediation</em> <span class="citation">(Hayes,
2015)</span>. In this example, it is the product of the coefficient
<code>m ~ x:w</code> and the coefficient <code>y ~ m</code>. This can be
done by the test function <code><a href="../reference/test_index_of_mome.html">test_index_of_mome()</a></code>. Again,
Monte Carlo confidence interval is used.</p>
<p>Let’s estimate the power when sample size is 100.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/power4test.html">power4test</a></span><span class="op">(</span>nrep <span class="op">=</span> <span class="fl">500</span>,</span>
<span>                  model <span class="op">=</span> <span class="va">mod</span>,</span>
<span>                  pop_es <span class="op">=</span> <span class="va">mod_es</span>,</span>
<span>                  n <span class="op">=</span> <span class="fl">100</span>,</span>
<span>                  R <span class="op">=</span> <span class="fl">2000</span>,</span>
<span>                  ci_type <span class="op">=</span> <span class="st">"mc"</span>,</span>
<span>                  test_fun <span class="op">=</span> <span class="va">test_index_of_mome</span>,</span>
<span>                  test_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"x"</span>,</span>
<span>                                   m <span class="op">=</span> <span class="st">"m"</span>,</span>
<span>                                   y <span class="op">=</span> <span class="st">"y"</span>,</span>
<span>                                   w <span class="op">=</span> <span class="st">"w"</span>,</span>
<span>                                   mc_ci <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>                  iseed <span class="op">=</span> <span class="fl">1234</span>,</span>
<span>                  parallel <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>The call is similar to the one used in <a href="#med_power">testing
mediation</a>. These are the new arguments used:</p>
<ul>
<li>
<code>test_fun</code>: It is set to
<code><a href="../reference/test_index_of_mome.html">test_index_of_mome()</a></code> in this example. This function is
similar to <code><a href="../reference/test_indirect_effect.html">test_indirect_effect()</a></code>, with one more argument,
<code>w</code>, for the moderator. Although this example has only one
mediator, it support any number of mediators along a path.<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;The test is implemented by
`manymome::test_index_of_mome().&lt;/p&gt;"><sup>9</sup></a>
</li>
</ul>
</div>
<div class="section level3">
<h3 id="compute-the-power-2">Compute the Power<a class="anchor" aria-label="anchor" href="#compute-the-power-2"></a>
</h3>
<p>We can ues <code><a href="../reference/get_rejection_rates.html">get_rejection_rates()</a></code> again to estimate the
power:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out_power</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_rejection_rates.html">get_rejection_rates</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span></span>
<span><span class="va">out_power</span></span>
<span><span class="co">#&gt;                                          test test_label pvalid reject</span></span>
<span><span class="co">#&gt; 1 test_index_of_mome: x-&gt;m-&gt;y, moderated by w       Test      1  0.052</span></span></code></pre></div>
<p>The estimated power of the test of moderated mediation effect,
conducted by a test of the index of moderated mediation, is 0.052.</p>
<p>As shown above, we can rerun the analysis using a larger sample
size:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out_new_n</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/power4test.html">power4test</a></span><span class="op">(</span><span class="va">out</span>,</span>
<span>                        n <span class="op">=</span> <span class="fl">500</span><span class="op">)</span></span></code></pre></div>
<p>This is the estimated power when the sample size is 500.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out_new_n_reject</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_rejection_rates.html">get_rejection_rates</a></span><span class="op">(</span><span class="va">out_new_n</span><span class="op">)</span></span>
<span><span class="va">out_new_n_reject</span></span>
<span><span class="co">#&gt;                                          test test_label pvalid reject</span></span>
<span><span class="co">#&gt; 1 test_index_of_mome: x-&gt;m-&gt;y, moderated by w       Test      1   0.22</span></span></code></pre></div>
<p>The estimated power is 0.220 when the sample size is 500. This
process can be repeated to find the required sample size for a target
power.</p>
<p>Unlike the previous example on moderation tested by regression,
estimating the power of Monte Carlo confidence intervals is
substantially slower. However, we believe this is necessary because
Monte Carlo or nonparametric bootstrapping confidence interval is the
test usually used in moderated-mediation (and mediation).</p>
</div>
</div>
<div class="section level2">
<h2 id="advanced-features">Advanced Features<a class="anchor" aria-label="anchor" href="#advanced-features"></a>
</h2>
<p>This brief illustration only cover basic features of
<code>power4mome</code>. These are other advanced features to be covered
in other articles:</p>
<ul>
<li><p>There is no inherent restriction on the form of the model.
Typical models that can be specified in <code>lavaan</code> model syntax
can be the population model, although there may be special models in
which <code>power4test</code> does not support.</p></li>
<li><p>The population model can be a model with latent factors and
indicators. Nevertheless, users can specify only the relation among the
factors. There is no need to include indicators in the model syntax, and
also no need to manually specify the factor loadings. The number of
indicators for each factor and the factor loadings are set by the
argument <code>number_of_indicators</code> and <code>reliability</code>
(see the help page of <code><a href="../reference/sim_data.html">sim_data()</a></code> on how to set them). The
model syntax used to fit to the data will automatically include the
indicators.</p></li>
<li><p>Though not illustrated above, estimating the power of tests
conducted by nonparametric bootstrapping is supported, although it will
take some time to run.</p></li>
<li><p>Although this package focuses on moderation, mediation, and
moderated-mediation, in principle, the power of any test can be
estimated, as long as a test function for <code>test_fun</code> is
available. Some other functions are provided with
<code>power4mome</code> (e.g., <code><a href="../reference/test_parameters.html">test_parameters()</a></code> for
testing all free model parameters). See the help page of
<code><a href="../reference/do_test.html">do_test()</a></code> on how to write a function to do a test not
available in <code>power4mome</code>.</p></li>
<li><p>When estimating power, usually the population model is fitted to
the data. However, it is possible to fit any other model to the
generated data. This can be done by using the argument
<code>fit_model_args</code> to set the argument <code>model</code> of
<code><a href="../reference/fit_model.html">fit_model()</a></code>.</p></li>
<li><p>Preliminary support for multigroup model is available. See the
help pages of <code><a href="../reference/ptable_pop.html">ptable_pop()</a></code> and <code><a href="../reference/pop_es_yaml.html">pop_es_yaml()</a></code>
on how to specify the population value syntax. Functions will be added
for tests relevant to multigroup models (e.g., testing the between-group
difference in an indirect effect).</p></li>
<li><p>Although we illustrated only rerunning an analysis with a new
sample size (<code>n</code>), it is also possible to rerun an analysis
using a new population value for a parameter. This can be done by using
the previous output of <code><a href="../reference/power4test.html">power4test()</a></code> as the first argument,
and setting only <code>pop_es</code> to a named vector:</p></li>
</ul>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out_new_xw</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/power4test.html">power4test</a></span><span class="op">(</span><span class="va">out</span>,</span>
<span>                         pop_es <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"m ~ x:w"</span> <span class="op">=</span> <span class="st">".30"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<ul>
<li><p>Instead of manually rerunning the analyais, it is possible to
rerun the analysis over a sequence of sample sizes or population values.
See the help pages of <code><a href="../reference/power4test_by_n.html">power4test_by_n()</a></code> and
<code><a href="../reference/power4test_by_pop_es.html">power4test_by_pop_es()</a></code> for details.</p></li>
<li><p>Basic support for generating nonnormal variables, including
dichotomous variables. See the argument <code>x_fun</code> of
<code><a href="../reference/power4test.html">power4test()</a></code> for details.</p></li>
</ul>
</div>
<div class="section level2">
<h2 id="limitations">Limitations<a class="anchor" aria-label="anchor" href="#limitations"></a>
</h2>
<ul>
<li>Monte Carlo confidence interval is not supported for models fitted
by <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm()</a></code> (regression). To estimate power of testing
mediation or moderated-mediation effects, <code>ci_type = "boot"</code>
is needed.</li>
</ul>
</div>
<div class="section level2">
<h2 id="final-remark">Final Remark<a class="anchor" aria-label="anchor" href="#final-remark"></a>
</h2>
</div>
<div class="section level2">
<h2 class="unnumbered" id="reference">Reference<a class="anchor" aria-label="anchor" href="#reference"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0" line-spacing="2">
<div id="ref-cheung_manymome_2024" class="csl-entry">
Cheung, S. F., &amp; Cheung, S.-H. (2024). <em>Manymome</em>:
<span>An</span> <span>R</span> package for computing the indirect
effects, conditional effects, and conditional indirect effects,
standardized or unstandardized, and their bootstrap confidence
intervals, in many (though not all) models. <em>Behavior Research
Methods</em>, <em>56</em>(5), 4862–4882. <a href="https://doi.org/10.3758/s13428-023-02224-z" class="external-link">https://doi.org/10.3758/s13428-023-02224-z</a>
</div>
<div id="ref-hayes_index_2015" class="csl-entry">
Hayes, A. F. (2015). An index and test of linear moderated mediation.
<em>Multivariate Behavioral Research</em>, <em>50</em>(1), 1–22. <a href="https://doi.org/10.1080/00273171.2014.962683" class="external-link">https://doi.org/10.1080/00273171.2014.962683</a>
</div>
</div>
</div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Shu Fai Cheung, Sing-Hang Cheung, Wendie Yang.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer>
</div>





  </body>
</html>
