<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Sample Size Given Desired Power (Probabilistic Bisection) • power4mome</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Hind-0.4.10/font.css" rel="stylesheet">
<link href="../deps/Oxygen_Mono-0.4.10/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Sample Size Given Desired Power (Probabilistic Bisection)">
<meta name="google-site-verification" content="0VLBmFnW_UJFI-7gXnORPBsWxqZwmzuGpK-TeVRLBjQ">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">power4mome</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.1.55</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/power4mome.html">Get started</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Scenarios</h6></li>
    <li><a class="dropdown-item" href="../articles/power4test_latent_mediation.html">Power Analysis for Latent Variable Mediation</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Given Power, Find x</h6></li>
    <li><a class="dropdown-item" href="../articles/x_from_power_for_n_pb.html">Sample Size Given Desired Power (Probabilistic Bisection)</a></li>
    <li><a class="dropdown-item" href="../articles/x_from_power_for_n.html">Sample Size Given Desired Power (Informal Bisection)</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Common Mediation Models</h6></li>
    <li><a class="dropdown-item" href="../articles/template_q_med_obs_simple.html">Quick Function: Simple Mediation with Observed Variables</a></li>
    <li><a class="dropdown-item" href="../articles/template_q_med_obs_serial.html">Quick Function: Serial Mediation with Observed Variables</a></li>
    <li><a class="dropdown-item" href="../articles/template_q_med_obs_parallel.html">Quick Function: Parallel Mediation with Observed Variables</a></li>
    <li><a class="dropdown-item" href="../articles/template_q_med_lav_simple.html">Quick Function: Simple Mediation with Latent Variables</a></li>
    <li><a class="dropdown-item" href="../articles/template_q_med_lav_serial.html">Quick Function: Serial Mediation with Latent Variables</a></li>
    <li><a class="dropdown-item" href="../articles/template_q_med_lav_parallel.html">Quick Function: Parallel Mediation with Latent Variables</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Templates (Code Examples)</h6></li>
    <li><a class="dropdown-item" href="../articles/template_n_from_power_mediation_obs_simple.html">Quick Template: Simple Mediation with Observed Variables</a></li>
    <li><a class="dropdown-item" href="../articles/template_n_from_power_mediation_obs_serial.html">Quick Template: Serial Mediation with Observed Variables</a></li>
    <li><a class="dropdown-item" href="../articles/template_n_from_power_mediation_obs_parallel.html">Quick Template: Parallel Mediation with Observed Variables</a></li>
    <li><a class="dropdown-item" href="../articles/template_n_from_power_mediation_lav_simple.html">Quick Template: Simple Mediation with Latent Variables</a></li>
    <li><a class="dropdown-item" href="../articles/template_n_from_power_mediation_lav_serial.html">Quick Template: Serial Mediation with Latent Variables</a></li>
    <li><a class="dropdown-item" href="../articles/template_n_from_power_mediation_lav_parallel.html">Quick Template: Parallel Mediation with Latent Variables</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Moderation Templates (Code Examples)</h6></li>
    <li><a class="dropdown-item" href="../articles/template_n_from_power_moderation_obs_simple.html">Quick Template: Simple Moderation with Observed Variables</a></li>
    <li><a class="dropdown-item" href="../articles/template_n_from_power_moderation_obs_two_ws.html">Quick Template: Moderation with Observed Variables: Two Moderators</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Moderated Mediation Templates (Code Examples)</h6></li>
    <li><a class="dropdown-item" href="../articles/template_n_from_power_mome_obs_a.html">Quick Template: Simple Moderated Mediation with Observed Variables: a-Path Moderated</a></li>
    <li><a class="dropdown-item" href="../articles/template_n_from_power_mome_obs_b.html">Quick Template: Simple Moderated Mediation with Observed Variables: b-Path Moderated</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/index.html">More articles...</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/sfcheung/power4mome/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Sample Size Given Desired Power (Probabilistic Bisection)</h1>
            
            <h4 data-toc-skip class="date">2026-02-28</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/sfcheung/power4mome/blob/main/vignettes/articles/x_from_power_for_n_pb.Rmd" class="external-link"><code>vignettes/articles/x_from_power_for_n_pb.Rmd</code></a></small>
      <div class="d-none name"><code>x_from_power_for_n_pb.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This article is a brief illustration of how to use
<code><a href="../reference/x_from_power.html">n_from_power()</a></code> and <code><a href="../reference/power4test.html">power4test()</a></code> from the
package <a href="https://sfcheung.github.io/power4mome/">power4mome</a>
to find by simulation the sample size with power close to a desired
level to detect an effect, given the level of population effect
size.</p>
<p>The illustration will use an indirect effect tested by Monte Carlo
confidence interval as an example, though the procedure is similar for
other tests supported by <code><a href="../reference/power4test.html">power4test()</a></code>.</p>
<p>NOTE: This is one version of two nearly-identical articles. This
version introduces how to use the probabilistic bisection algorithm
<span class="citation">(Waeber et al., 2013)</span>, which sometimes
takes longer to run but can be used for a higher level of precision
using a larger number of replications. The <a href="./x_from_power_for_n.html">other version</a> uses the (informal)
bisection algorithm <span class="citation">(see Chalmers, 2024 for a
review of this method)</span> to identify the approximate sample size
with a limited number of replications.</p>
</div>
<div class="section level2">
<h2 id="prerequisite">Prerequisite<a class="anchor" aria-label="anchor" href="#prerequisite"></a>
</h2>
<p>Basic knowledge about fitting models by <code>lavaan</code> is
required. Readers are also expected to know how to use
<code><a href="../reference/power4test.html">power4test()</a></code> (see this <a href="power4mome.html">get-started</a> for an introduction).</p>
</div>
<div class="section level2">
<h2 id="scope">Scope<a class="anchor" aria-label="anchor" href="#scope"></a>
</h2>
<p>This is a brief illustration. More complicated scenarios and other
features of <code><a href="../reference/x_from_power.html">x_from_power()</a></code> will be described in other
vignettes and articles.</p>
<p>Some sections are repeated from other vignettes and articles to make
this vignette self-contained.</p>
</div>
<div class="section level2">
<h2 id="package">Package<a class="anchor" aria-label="anchor" href="#package"></a>
</h2>
<p>This illustration needs the following package(s):</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://sfcheung.github.io/power4mome/">power4mome</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="workflow">Workflow<a class="anchor" aria-label="anchor" href="#workflow"></a>
</h2>
<p>Three functions, along with some methods, are sufficient for
estimating the sample size, given the desired power, along with other
factors such as the test, the model, and population values. This is the
workflow:</p>
<ol style="list-style-type: decimal">
<li><p>Specify the model syntax for the population model, in
<code>lavaan</code> style, and set the population values of the model
parameters.</p></li>
<li><p>Call <code><a href="../reference/power4test.html">power4test()</a></code> to examine the setup and the
datasets generated. Repeat this and previous steps until the model is
specified correctly.</p></li>
<li><p>Call <code><a href="../reference/power4test.html">power4test()</a></code> again, with the test to do
specified, using an initial sample size.</p></li>
<li><p>Call <code><a href="../reference/rejection_rates.html">rejection_rates()</a></code> to compute the power and
verify that the test is specified correctly.</p></li>
<li><p>Call <code><a href="../reference/x_from_power.html">n_from_power()</a></code> to estimate the sample size
required for the desired power.</p></li>
</ol>
</div>
<div class="section level2">
<h2 id="mediation">Mediation<a class="anchor" aria-label="anchor" href="#mediation"></a>
</h2>
<p>Let’s consider a simple mediation model. We would like to estimate
the sample size required to detect a mediation effect by Monte Carlo
confidence interval, with 95% level of significance.</p>
<p>Because sampling (simulation) error is involved when there is no
analytic solution to find the sample size, instead of estimating the
unknown sample size, we can also estimate, approximately, the region of
sample sizes with their levels of power</p>
<ol style="list-style-type: decimal">
<li><p>significantly <em>lower</em> than the target power, or</p></li>
<li><p>significantly <em>higher</em> than the target power.</p></li>
</ol>
<p>That is, we find the sample size that has its <em>confidence
interval</em>, 95% by default, just below (Case 1) or just above (Case
2) the target power, approximately.</p>
<p>We will consider Case 1 first.</p>
<div class="section level3">
<h3 id="specify-the-population-model">Specify the Population Model<a class="anchor" aria-label="anchor" href="#specify-the-population-model"></a>
</h3>
<p>This is the model syntax</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod</span> <span class="op">&lt;-</span></span>
<span><span class="st">"</span></span>
<span><span class="st">m ~ x</span></span>
<span><span class="st">y ~ m + x</span></span>
<span><span class="st">"</span></span></code></pre></div>
<p>Note that, even if we are going to test mediation, we do not need to
label the parameters and define the indirect effect as usual in
<code>lavaan</code>. This will be taken care of by the test functions,
through the use of the package <a href="https://sfcheung.github.io/manymome/" class="external-link"><code>manymome</code></a>
<span class="citation">(Cheung &amp; Cheung, 2024)</span>.</p>
</div>
<div class="section level3">
<h3 id="es_convention">Specify The Population Values<a class="anchor" aria-label="anchor" href="#es_convention"></a>
</h3>
<p>There are two approaches to do this: using named vectors or lists, or
using a multiline string similar to <code>lavaan</code> model syntax.
The second approach is demonstrated below.</p>
<p>Suppose we want to estimate the power when:</p>
<ul>
<li><p>The path from <code>x</code> to <code>m</code> are “large” in
strength.</p></li>
<li><p>The path from <code>m</code> to <code>y</code> are “medium” in
strength.</p></li>
<li><p>The path from <code>x</code> to <code>m</code> are “small” in
strength.</p></li>
</ul>
<p>By default, <code>power4mome</code> use this convention for
regression path and correlation:<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt; Users can specify the values directly if necessary.&lt;/p&gt;"><sup>1</sup></a></p>
<ul>
<li><p>Small: .10 (or -.10)</p></li>
<li><p>Medium: .30 (or -.30)</p></li>
<li><p>Large: .50 (or -.50)</p></li>
</ul>
<p>All these values are for the standardized solution (the so-called
“betas”).</p>
<p>The following string denotes the desired values:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod_es</span> <span class="op">&lt;-</span></span>
<span><span class="st">"</span></span>
<span><span class="st">m ~ x: l</span></span>
<span><span class="st">y ~ m: m</span></span>
<span><span class="st">y ~ x: s</span></span>
<span><span class="st">"</span></span></code></pre></div>
<p>Each line starts with a <em>tag</em>, which is the parameter
presented in <code>lavaan</code> syntax. The tag ends with a colon,
<code>:</code>.</p>
<p>After the colon is a population value, which can be:</p>
<ul>
<li>
<p>A word denoting the value. By default:</p>
<ul>
<li><p><code>s</code>: Small. (<code>-s</code> for small and
negative.)</p></li>
<li><p><code>m</code>: Medium. (<code>-m</code> for medium and
negative.)</p></li>
<li><p><code>l</code>: Large. (<code>-l</code> for large and
negative.)</p></li>
<li><p><code>nil</code>: Zero.</p></li>
</ul>
</li>
</ul>
<p>All regression coefficients and covariances, if not specified, are
set to zero.</p>
</div>
<div class="section level3">
<h3 id="call-power4test-to-check-the-model">Call <code>power4test()</code> to Check the Model<a class="anchor" aria-label="anchor" href="#call-power4test-to-check-the-model"></a>
</h3>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/power4test.html">power4test</a></span><span class="op">(</span>nrep <span class="op">=</span> <span class="fl">2</span>,</span>
<span>                  model <span class="op">=</span> <span class="va">mod</span>,</span>
<span>                  pop_es <span class="op">=</span> <span class="va">mod_es</span>,</span>
<span>                  n <span class="op">=</span> <span class="fl">50000</span>,</span>
<span>                  iseed <span class="op">=</span> <span class="fl">1234</span><span class="op">)</span></span></code></pre></div>
<p>These are the arguments used:</p>
<ul>
<li><p><code>nrep</code>: The number of replications. In this stage, a
small number can be used. It is more important to have a large sample
size than to have more replications.</p></li>
<li><p><code>model</code>: The model syntax.</p></li>
<li><p><code>pop_es</code>: The string setting the population
values.</p></li>
<li><p><code>n</code>: The sample size in each replications. In this
stage, just for checking the model and the data generation, this number
can be set to a large one unless the model is slow to fit when the
sample size is large.</p></li>
<li><p><code>iseed</code>: If supplied, it is used to set the seed for
the random number generator. It is advised to always set this to an
arbitrary integer, to make the results reproducible.<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;The functions used are
&lt;code&gt;&lt;a href="https://rdrr.io/r/parallel/RngStream.html" class="external-link"&gt;parallel::clusterSetRNGStream()&lt;/a&gt;&lt;/code&gt; for parallel processing,
and &lt;code&gt;&lt;a href="https://rdrr.io/r/base/Random.html" class="external-link"&gt;set.seed()&lt;/a&gt;&lt;/code&gt; for serial processing.&lt;/p&gt;'><sup>2</sup></a></p></li>
</ul>
<p>The population values can be shown by print this object:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">out</span>,</span>
<span>      data_long <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt; ============================== Model Information ==============================</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt; ====== Model on Factors/Variables ======</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt; m ~ x</span></span>
<span><span class="co">#&gt; y ~ m + x</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt; ==== Model on Variables/Indicators ====</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt; m ~ x</span></span>
<span><span class="co">#&gt; y ~ m + x</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt; ========== Population Values ==========</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt; Regressions:</span></span>
<span><span class="co">#&gt;                    Population</span></span>
<span><span class="co">#&gt;   m ~</span></span>
<span><span class="co">#&gt;     x                 0.500</span></span>
<span><span class="co">#&gt;   y ~</span></span>
<span><span class="co">#&gt;     m                 0.300</span></span>
<span><span class="co">#&gt;     x                 0.100</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt; Variances:</span></span>
<span><span class="co">#&gt;                    Population</span></span>
<span><span class="co">#&gt;    .m                 0.750</span></span>
<span><span class="co">#&gt;    .y                 0.870</span></span>
<span><span class="co">#&gt;     x                 1.000</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt; (Computing indirect effects for 2 paths ...)</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt; == Population Conditional/Indirect Effect(s) ==</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt; == Indirect Effect(s) ==</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt;               ind</span></span>
<span><span class="co">#&gt; x -&gt; m -&gt; y 0.150</span></span>
<span><span class="co">#&gt; x -&gt; y      0.100</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt;  - The 'ind' column shows the indirect effect(s).</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt; =============================== Data Information ===============================</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt; Number of Replications:  2</span></span>
<span><span class="co">#&gt; Sample Sizes:  50000</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt; ======== Descriptive Statistics ========</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt;   vars     n mean sd skew kurtosis se</span></span>
<span><span class="co">#&gt; m    1 1e+05 0.00  1 0.01     0.03  0</span></span>
<span><span class="co">#&gt; y    2 1e+05 0.01  1 0.01     0.00  0</span></span>
<span><span class="co">#&gt; x    3 1e+05 0.00  1 0.01     0.01  0</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt; ============= Parameter Estimates Based on All 2 Samples Combined =============</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt; Total Sample Size: 100000</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt; ======== Standardized Estimates ========</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt; Variances and error variances omitted.</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt; Regressions:</span></span>
<span><span class="co">#&gt;                     est.std</span></span>
<span><span class="co">#&gt;   m ~</span></span>
<span><span class="co">#&gt;     x                 0.500</span></span>
<span><span class="co">#&gt;   y ~</span></span>
<span><span class="co">#&gt;     m                 0.295</span></span>
<span><span class="co">#&gt;     x                 0.102</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt; ============================ Extra Element(s) Found ============================</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt; - fit</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt; ======== Element(s) of the First Dataset ========</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt; ================ &lt;fit&gt; ================</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt; lavaan 0.6-21 ended normally after 1 iteration</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt;   Estimator                                         ML</span></span>
<span><span class="co">#&gt;   Optimization method                           NLMINB</span></span>
<span><span class="co">#&gt;   Number of model parameters                         5</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt;   Number of observations                         50000</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt; Model Test User Model:</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt;   Test statistic                                 0.000</span></span>
<span><span class="co">#&gt;   Degrees of freedom                                 0</span></span></code></pre></div>
<p>The argument <code>data_long = TRUE</code> is used to verify the
simulation.</p>
<p>The population values for the regression paths in the section
<code>Population Values</code> are what we specified. So the model is
specified correctly.</p>
<p>The section <code>Descriptive Statistics</code>, generated by
<code><a href="https://rdrr.io/pkg/psych/man/describe.html" class="external-link">psych::describe()</a></code>, shows basic descriptive statistics for
the observed variables. As expected, they have means close to zero and
standard deviations close to one, because the datasets were generated
using the standardized model.</p>
<p>The section <code>Parameter Estimates Based on</code> shows the
parameter estimates when the population model is fitted to all the
datasets combined. When the total sample size is large, these estimates
should be close to the population values.</p>
<p>By the default, the population model will be fitted to each dataset,
hence the section <code>&lt;fit&gt;</code>. This section just verifies
that the population can be fitted</p>
<p>The results show that population model is the desired one. We can
proceed to the next stage</p>
</div>
<div class="section level3">
<h3 id="med_power">Call <code>power4test()</code> to Do the Target Test<a class="anchor" aria-label="anchor" href="#med_power"></a>
</h3>
<p>We can now do the simulation to estimate power for an initial sample
size, to verify the test we want to do. A large number of datasets
(e.g., 500) of the target sample size are to be generated, and then the
target test will be conducted in each of these datasets.</p>
<p>Suppose we would like to estimate the power of using Monte Carlo
confidence interval to test the indirect effect from <code>x</code> to
<code>y</code> through <code>m</code>, when sample size is 50. This is
the call, based on the previous one:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/power4test.html">power4test</a></span><span class="op">(</span>nrep <span class="op">=</span> <span class="fl">50</span>,</span>
<span>                  model <span class="op">=</span> <span class="va">mod</span>,</span>
<span>                  pop_es <span class="op">=</span> <span class="va">mod_es</span>,</span>
<span>                  n <span class="op">=</span> <span class="fl">50</span>,</span>
<span>                  R <span class="op">=</span> <span class="fl">199</span>,</span>
<span>                  ci_type <span class="op">=</span> <span class="st">"mc"</span>,</span>
<span>                  test_fun <span class="op">=</span> <span class="va">test_indirect_effect</span>,</span>
<span>                  test_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"x"</span>,</span>
<span>                                   m <span class="op">=</span> <span class="st">"m"</span>,</span>
<span>                                   y <span class="op">=</span> <span class="st">"y"</span>,</span>
<span>                                   mc_ci <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>                  iseed <span class="op">=</span> <span class="fl">2345</span>,</span>
<span>                  parallel <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>If our goal is to find a sample size for a specific level of power,
with sufficient precision, we do not need a large number of replications
(<code>nrep</code>) in this stage. We can use as few as 50. We can set
the target number of replications when calling the function
<code><a href="../reference/x_from_power.html">n_from_power()</a></code>, which is a wrapper to the general function
<code><a href="../reference/x_from_power.html">x_from_power()</a></code>.</p>
<p>These are the new arguments used:</p>
<ul>
<li><p><code>R</code>: The number of replications used to generate the
Monte Carlo simulated estimates, 199 in this example. This may look
small, but this value is acceptable because the goal is not to have a
stable result in <em>one</em> replication, but to estimate the power
<em>across</em> replications. The method proposed by <span class="citation">Boos &amp; Zhang (2000)</span>, detailed below, will be
used to estimate the power.</p></li>
<li><p><code>ci_type</code>: The method used to generate estimates.
Support Monte Carlo (<code>"mc"</code>) and nonparametric bootstrapping
(<code>"boot"</code>).<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;They are implemented by &lt;code&gt;&lt;a href="https://sfcheung.github.io/manymome/reference/do_mc.html" class="external-link"&gt;manymome::do_mc()&lt;/a&gt;&lt;/code&gt;
and &lt;code&gt;&lt;a href="https://sfcheung.github.io/manymome/reference/do_boot.html" class="external-link"&gt;manymome::do_boot()&lt;/a&gt;&lt;/code&gt;, respectively.&lt;/p&gt;'><sup>3</sup></a> Although bootstrapping is usually used to
test an indirect effect, it is very slow to do <code>R</code>
bootstrapping in <code>nrep</code> datasets (the model will be fitted
<code>R * nrep</code> times). Therefore, it is preferable to use Monte
Carlo to do the initial estimation.</p></li>
<li><p><code>test_fun</code>: The function to be used to do the test for
each replication. Any function following a specific requirement can be
used, and <code>power4mome</code> comes with several built-in function
for some tests. The function <code><a href="../reference/test_indirect_effect.html">test_indirect_effect()</a></code> is used
to test an indirect effect in the model.</p></li>
<li><p><code>test_args</code>: A named list of arguments to be supplied
to <code>test_fun</code>. For <code><a href="../reference/test_indirect_effect.html">test_indirect_effect()</a></code>, it is
a named list specifying the predictor (<code>x</code>), the mediator(s)
(<code>m</code>), and the outcome (<code>y</code>). A path with any
number of mediators can be supported. Please refer to the help page of
<code><a href="../reference/test_indirect_effect.html">test_indirect_effect()</a></code>.<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;The test is implemented by
&lt;code&gt;manymome::indirect()&lt;/code&gt;.&lt;/p&gt;"><sup>4</sup></a></p></li>
<li><p><code>parallel</code>: If the test to be conducted is slow, which
is the case for test done by Monte Carlo or nonparametric bootstrapping
confidence interval, it is advised to enable parallel processing by
setting <code>parallel</code> to <code>TRUE</code>.<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;The number of cores is determined automatically but can
be set directly by the &lt;code&gt;ncores&lt;/code&gt; argument.&lt;/p&gt;"><sup>5</sup></a></p></li>
</ul>
<p>In power analysis involving resampling methods such as Monte Carlo
confidence interval and bootstrapping, the processing time can be very
long. <span class="citation">Boos &amp; Zhang (2000)</span> proposed a
method to extrapolate the rejection rates of these methods using a
limited number of (re)sampling. This method requires specific numbers of
<code>R</code>, determined by the level of significance (1 minus the
level of confidence, for confidence interval methods). For a level of
significance of .05, the default, these are the first few supported
values of <code>R</code>:</p>
<pre><code><span><span class="co">#&gt; [1]  39  79 119 159 199 239 279 319 359</span></span></code></pre>
<p>In our experience, an <code>R</code> of 199 is large enough for the
search.</p>
<p>Note that the simulation can take some time to run. Progress will be
printed when run in an interactive session.</p>
<p>This is the default printout:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt; ============================== Model Information ==============================</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt; ====== Model on Factors/Variables ======</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt; m ~ x</span></span>
<span><span class="co">#&gt; y ~ m + x</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt; ==== Model on Variables/Indicators ====</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt; m ~ x</span></span>
<span><span class="co">#&gt; y ~ m + x</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt; ========== Population Values ==========</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt; Regressions:</span></span>
<span><span class="co">#&gt;                    Population</span></span>
<span><span class="co">#&gt;   m ~</span></span>
<span><span class="co">#&gt;     x                 0.500</span></span>
<span><span class="co">#&gt;   y ~</span></span>
<span><span class="co">#&gt;     m                 0.300</span></span>
<span><span class="co">#&gt;     x                 0.100</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt; Variances:</span></span>
<span><span class="co">#&gt;                    Population</span></span>
<span><span class="co">#&gt;    .m                 0.750</span></span>
<span><span class="co">#&gt;    .y                 0.870</span></span>
<span><span class="co">#&gt;     x                 1.000</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt; (Computing indirect effects for 2 paths ...)</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt; == Population Conditional/Indirect Effect(s) ==</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt; == Indirect Effect(s) ==</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt;               ind</span></span>
<span><span class="co">#&gt; x -&gt; m -&gt; y 0.150</span></span>
<span><span class="co">#&gt; x -&gt; y      0.100</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt;  - The 'ind' column shows the indirect effect(s).</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt; =============================== Data Information ===============================</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt; Number of Replications:  50</span></span>
<span><span class="co">#&gt; Sample Sizes:  50</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt; Call print with 'data_long = TRUE' for further information.</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt; ============================ Extra Element(s) Found ============================</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt; - fit</span></span>
<span><span class="co">#&gt; - mc_out</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt; ======== Element(s) of the First Dataset ========</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt; ================ &lt;fit&gt; ================</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt; lavaan 0.6-21 ended normally after 1 iteration</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt;   Estimator                                         ML</span></span>
<span><span class="co">#&gt;   Optimization method                           NLMINB</span></span>
<span><span class="co">#&gt;   Number of model parameters                         5</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt;   Number of observations                            50</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt; Model Test User Model:</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt;   Test statistic                                 0.000</span></span>
<span><span class="co">#&gt;   Degrees of freedom                                 0</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt; =============== &lt;mc_out&gt; ===============</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt; == A 'mc_out' class object ==</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt; Number of Monte Carlo replications: 199</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt; ====================== &lt;test_indirect: x-&gt;m-&gt;y&gt; ======================</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt; Mean(s) across replication:</span></span>
<span><span class="co">#&gt;    est cilo cihi   sig pvalue       R   nlt0 alpha bz_39 bz_79 bz_119 bz_159 bz_199</span></span>
<span><span class="co">#&gt;  0.167  NaN  NaN 0.548  0.129 199.000 16.860 0.050 0.496 0.523  0.528  0.536  0.540</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt; - The value 'sig' is the rejection rate.</span></span>
<span><span class="co">#&gt; - If the null hypothesis is false, this is the power.</span></span>
<span><span class="co">#&gt; - Number of valid replications for rejection rate: 50</span></span>
<span><span class="co">#&gt; - Proportion of valid replications for rejection rate: 1.000</span></span></code></pre></div>
<p>As shown above, the settings are correct. The columns after
<code>R</code> (e.g., <code>nlt0</code> and <code>bz_39</code>) are for
the method by <span class="citation">Boos &amp; Zhang (2000)</span>. The
presence of these columns confirms that the method by <span class="citation">Boos &amp; Zhang (2000)</span> is used.</p>
<p>We can now call <code><a href="../reference/x_from_power.html">n_from_power()</a></code> to do the search.</p>
</div>
<div class="section level3">
<h3 id="call-n_from_power-to-estimate-the-sample-size">Call <code>n_from_power()</code> to Estimate the Sample Size<a class="anchor" aria-label="anchor" href="#call-n_from_power-to-estimate-the-sample-size"></a>
</h3>
<p>This is a simplified description of how <code><a href="../reference/x_from_power.html">n_from_power()</a></code>
works when our goal is to find a sample size with its power <em>close
to</em> the target power, with a desired level of precision determined
by the number of replications (<code>nrep</code>).</p>
<p>The probabilistic bisection algorithm <span class="citation">(Waeber
et al., 2013)</span> will be used. It takes some time to run, sometimes
ten minutes or more, but it is particularly suitable for determining the
sample size given a target power with a high level of precision, which
requires a large number of replications. See <span class="citation">Chalmers (2024)</span> for an illustration of this
method in power analysis.</p>
<p>This is the function call:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out_n</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/x_from_power.html">n_from_power</a></span><span class="op">(</span><span class="va">out</span>,</span>
<span>                      target_power <span class="op">=</span> <span class="fl">.80</span>,</span>
<span>                      final_nrep <span class="op">=</span> <span class="fl">2000</span>,</span>
<span>                      final_R <span class="op">=</span> <span class="fl">2000</span>,</span>
<span>                      seed <span class="op">=</span> <span class="fl">1234</span>,</span>
<span>                      algorithm <span class="op">=</span> <span class="st">"probabilistic_bisection"</span><span class="op">)</span></span></code></pre></div>
<p>The argument used above:</p>
<ul>
<li><p><code>target_power</code>: The target power. Default is
.80.</p></li>
<li><p><code>final_nrep</code>: The number of replications desired in
the solution. For <code>nrep = 2000</code>, the width of the 95%
confidence limits based on normal approximation for a power of .80 is
about .035. This should be precise enough for estimating the sample size
required. Increase or decrease <code>nrep</code> to get the desired
level of precision.</p></li>
<li><p><code>final_R</code>: It is preferable to use the method by <span class="citation">Boos &amp; Zhang (2000)</span> with a small
<code>R</code> during the search. Nevertheless, if a larger number of
<code>R</code> is desired during the final check, we can set
<code>final_R</code> to this value. If omitted, the <code>R</code> in
the object from <code><a href="../reference/power4test.html">power4test()</a></code> will be used.</p></li>
<li><p><code>seed</code>: To make the search reproducible, if possible,
set this seed to an integer.</p></li>
</ul>
<p>By default, the progress of the search will be displayed on screen
(add <code>progress = FALSE</code> to hide the progress). Each iteration
only uses a small number of replications (<code>nrep</code>), but the
information will be accumulated across iterations to determine the
sample size. When a potential solution (the sample size with the desired
power) is found, a final check will be conducted using
<code>final_nrep</code> replications and <code>final_R</code> (if set).
If the estimated power of this solution is “close enough” to the target
power, the search will stop. If not, the search will continue. These
steps will be continued until some termination criteria are met.
(Details to be described in another article).</p>
<div class="section level4">
<h4 id="what-if-the-search-fails">WHat if the Search Fails<a class="anchor" aria-label="anchor" href="#what-if-the-search-fails"></a>
</h4>
<p>The search is probabilistic. Therefore, it is possible that a search
may fail given the termination criteria (such as the maximum number of
iterations). If a search fails, try another value for
<code>seed</code>.</p>
</div>
</div>
<div class="section level3">
<h3 id="examine-the-output">Examine the Output<a class="anchor" aria-label="anchor" href="#examine-the-output"></a>
</h3>
<p>The example above will take several minutes to run, depending on
factors such as whether <code>parallel</code> is <code>TRUE</code> and
the number of CPU cores used when calling <code><a href="../reference/power4test.html">power4test()</a></code>, as
well as the target number of replications (<code>final_nrep</code>). The
larger the <code>final_nrep</code> is, the higher the precision of the
solution, but the longer the search.</p>
<p>This is the basic output:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out_n</span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; power4mome::x_from_power(object = out, x = "n", target_power = 0.8,</span></span>
<span><span class="co">#&gt;     what = "point", goal = "ci_hit", final_nrep = 2000, final_R = 2000,</span></span>
<span><span class="co">#&gt;     seed = 1234, algorithm = "probabilistic_bisection")</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt;                                      Setting</span></span>
<span><span class="co">#&gt; Predictor(x):                    Sample Size</span></span>
<span><span class="co">#&gt; Parameter:                               N/A</span></span>
<span><span class="co">#&gt; goal:                           close_enough</span></span>
<span><span class="co">#&gt; what:                                  point</span></span>
<span><span class="co">#&gt; algorithm:           probabilistic_bisection</span></span>
<span><span class="co">#&gt; Level of confidence:                  95.00%</span></span>
<span><span class="co">#&gt; Target Power:                          0.800</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt; - Final Value of Sample Size (n): 101</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt; - Final Estimated Power (CI): 0.785 [0.766, 0.802]</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt; Call `summary()` for detailed results.</span></span></code></pre></div>
<p>The estimated sample size is 101. The estimated power based on
simulation is 0.785, with its confidence interval equal to [0.766,
0.802].</p>
<p>To obtain a more detailed results for the search, we can use the
<code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> method:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">out_n</span><span class="op">)</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt; ====== x_from_power Results ======</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; x_from_power(object = out, x = "n", target_power = 0.8, what = "point",</span></span>
<span><span class="co">#&gt;     goal = "ci_hit", final_nrep = 2000, final_R = 2000, seed = 1234,</span></span>
<span><span class="co">#&gt;     algorithm = "probabilistic_bisection")</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt; Predictor (x): Sample Size</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt; - Target Power: 0.800</span></span>
<span><span class="co">#&gt; - Goal: Find 'x' with estimated estimated power close enough to the target power.</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt; === Major Results ===</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt; - Final Value (Sample Size): 101</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt; - Final Estimated Power: 0.785</span></span>
<span><span class="co">#&gt; - Confidence Interval: [0.766; 0.802]</span></span>
<span><span class="co">#&gt; - Level of confidence: 95.0%</span></span>
<span><span class="co">#&gt; - Based on 2000 replications.</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt; === Technical Information ===</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt; - Algorithm: probabilistic_bisection</span></span>
<span><span class="co">#&gt; - Tolerance for 'close enough': Within 0.01525 of 0.800</span></span>
<span><span class="co">#&gt; - The range of values explored: 50 to 150</span></span>
<span><span class="co">#&gt; - Time spent in the search: 5.746 mins</span></span>
<span><span class="co">#&gt; - The final crude model for the power-predictor relation:</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt; Model Type: Logistic Regression</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; power_curve(object = by_x_1, formula = power_model, start = power_curve_start,</span></span>
<span><span class="co">#&gt;     lower_bound = lower_bound, upper_bound = upper_bound, nls_args = nls_args,</span></span>
<span><span class="co">#&gt;     nls_control = nls_control, verbose = progress)</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt; Predictor: n (Sample Size)</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt; Model:</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt; Call:  stats::glm(formula = reject ~ x, family = "binomial", data = reject1)</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt; (Intercept)            x</span></span>
<span><span class="co">#&gt;    -1.09778      0.02399</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt; Degrees of Freedom: 7415 Total (i.e. Null);  7414 Residual</span></span>
<span><span class="co">#&gt; Null Deviance:       7763</span></span>
<span><span class="co">#&gt; Residual Deviance: 7706  AIC: 7710</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt; - Detailed Results:</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt; [test]: test_indirect: x-&gt;m-&gt;y</span></span>
<span><span class="co">#&gt; [test_label]: Test</span></span>
<span><span class="co">#&gt;      n   est   p.v reject r.cilo r.cihi</span></span>
<span><span class="co">#&gt; 1   50 0.167 1.000  0.548  0.404  0.670</span></span>
<span><span class="co">#&gt; 2   50 0.150 1.000  0.502  0.377  0.641</span></span>
<span><span class="co">#&gt; 3   73 0.138 1.000  0.664  0.530  0.780</span></span>
<span><span class="co">#&gt; 4   94 0.134 1.000  0.719  0.591  0.829</span></span>
<span><span class="co">#&gt; 5   94 0.149 1.000  0.771  0.632  0.860</span></span>
<span><span class="co">#&gt; 6   94 0.143 1.000  0.697  0.570  0.813</span></span>
<span><span class="co">#&gt; 7   95 0.167 1.000  0.843  0.720  0.918</span></span>
<span><span class="co">#&gt; 8   95 0.154 1.000  0.788  0.654  0.875</span></span>
<span><span class="co">#&gt; 9   95 0.159 1.000  0.783  0.654  0.875</span></span>
<span><span class="co">#&gt; 10  95 0.158 1.000  0.787  0.654  0.875</span></span>
<span><span class="co">#&gt; 11  96 0.157 1.000  0.816  0.697  0.904</span></span>
<span><span class="co">#&gt; 12  96 0.131 1.000  0.646  0.510  0.764</span></span>
<span><span class="co">#&gt; 13  97 0.160 1.000  0.825  0.697  0.904</span></span>
<span><span class="co">#&gt; 14  97 0.143 1.000  0.778  0.654  0.875</span></span>
<span><span class="co">#&gt; 15  97 0.153 1.000  0.799  0.675  0.890</span></span>
<span><span class="co">#&gt; 16  97 0.140 1.000  0.676  0.530  0.780</span></span>
<span><span class="co">#&gt; 17  97 0.152 1.000  0.777  0.654  0.875</span></span>
<span><span class="co">#&gt; 18  97 0.145 1.000  0.694  0.550  0.797</span></span>
<span><span class="co">#&gt; 19  97 0.148 1.000  0.768  0.750  0.786</span></span>
<span><span class="co">#&gt; 20  97 0.149 1.000  0.825  0.697  0.904</span></span>
<span><span class="co">#&gt; 21  97 0.160 1.000  0.867  0.743  0.932</span></span>
<span><span class="co">#&gt; 22  97 0.145 1.000  0.868  0.743  0.932</span></span>
<span><span class="co">#&gt; 23  97 0.145 1.000  0.794  0.654  0.875</span></span>
<span><span class="co">#&gt; 24  97 0.132 1.000  0.664  0.530  0.780</span></span>
<span><span class="co">#&gt; 25  97 0.131 1.000  0.758  0.632  0.860</span></span>
<span><span class="co">#&gt; 26  98 0.163 1.000  0.878  0.766  0.945</span></span>
<span><span class="co">#&gt; 27 100 0.148 1.000  0.781  0.654  0.875</span></span>
<span><span class="co">#&gt; 28 100 0.155 1.000  0.863  0.743  0.932</span></span>
<span><span class="co">#&gt; 29 101 0.139 1.000  0.743  0.611  0.845</span></span>
<span><span class="co">#&gt; 30 101 0.143 1.000  0.751  0.611  0.845</span></span>
<span><span class="co">#&gt; 31 101 0.146 1.000  0.793  0.654  0.875</span></span>
<span><span class="co">#&gt; 32 101 0.135 1.000  0.805  0.675  0.890</span></span>
<span><span class="co">#&gt; 33 101 0.155 1.000  0.782  0.654  0.875</span></span>
<span><span class="co">#&gt; 34 101 0.149 1.000  0.726  0.591  0.829</span></span>
<span><span class="co">#&gt; 35 101 0.152 1.000  0.830  0.697  0.904</span></span>
<span><span class="co">#&gt; 36 101 0.140 1.000  0.675  0.530  0.780</span></span>
<span><span class="co">#&gt; 37 101 0.143 1.000  0.755  0.632  0.860</span></span>
<span><span class="co">#&gt; 38 101 0.149 1.000  0.785  0.766  0.802</span></span>
<span><span class="co">#&gt; 39 102 0.155 1.000  0.802  0.675  0.890</span></span>
<span><span class="co">#&gt; 40 102 0.160 1.000  0.939  0.841  0.980</span></span>
<span><span class="co">#&gt; 41 102 0.156 1.000  0.854  0.743  0.932</span></span>
<span><span class="co">#&gt; 42 103 0.170 1.000  0.861  0.743  0.932</span></span>
<span><span class="co">#&gt; 43 104 0.135 1.000  0.700  0.570  0.813</span></span>
<span><span class="co">#&gt; 44 104 0.141 1.000  0.743  0.611  0.845</span></span>
<span><span class="co">#&gt; 45 104 0.163 1.000  0.872  0.743  0.932</span></span>
<span><span class="co">#&gt; 46 104 0.149 1.000  0.833  0.697  0.904</span></span>
<span><span class="co">#&gt; 47 104 0.152 1.000  0.785  0.654  0.875</span></span>
<span><span class="co">#&gt; 48 104 0.153 1.000  0.814  0.675  0.890</span></span>
<span><span class="co">#&gt; 49 104 0.147 1.000  0.795  0.675  0.890</span></span>
<span><span class="co">#&gt; 50 104 0.148 1.000  0.714  0.570  0.813</span></span>
<span><span class="co">#&gt; 51 104 0.141 1.000  0.824  0.697  0.904</span></span>
<span><span class="co">#&gt; 52 104 0.138 1.000  0.765  0.632  0.860</span></span>
<span><span class="co">#&gt; 53 104 0.166 1.000  0.865  0.743  0.932</span></span>
<span><span class="co">#&gt; 54 104 0.158 1.000  0.762  0.632  0.860</span></span>
<span><span class="co">#&gt; 55 104 0.142 1.000  0.779  0.654  0.875</span></span>
<span><span class="co">#&gt; 56 104 0.145 1.000  0.808  0.675  0.890</span></span>
<span><span class="co">#&gt; 57 104 0.154 1.000  0.795  0.675  0.890</span></span>
<span><span class="co">#&gt; 58 104 0.157 1.000  0.919  0.815  0.969</span></span>
<span><span class="co">#&gt; 59 104 0.153 1.000  0.845  0.720  0.918</span></span>
<span><span class="co">#&gt; 60 104 0.177 1.000  0.840  0.720  0.918</span></span>
<span><span class="co">#&gt; 61 105 0.152 1.000  0.833  0.697  0.904</span></span>
<span><span class="co">#&gt; 62 105 0.154 1.000  0.916  0.815  0.969</span></span>
<span><span class="co">#&gt; 63 107 0.145 1.000  0.797  0.675  0.890</span></span>
<span><span class="co">#&gt; 64 107 0.150 1.000  0.865  0.743  0.932</span></span>
<span><span class="co">#&gt; 65 112 0.147 1.000  0.826  0.697  0.904</span></span>
<span><span class="co">#&gt; 66 115 0.157 1.000  0.934  0.841  0.980</span></span>
<span><span class="co">#&gt; 67 121 0.153 1.000  0.770  0.632  0.860</span></span>
<span><span class="co">#&gt; 68 127 0.142 1.000  0.881  0.766  0.945</span></span>
<span><span class="co">#&gt; 69 150 0.150 1.000  0.897  0.790  0.957</span></span>
<span><span class="co">#&gt; Notes:</span></span>
<span><span class="co">#&gt; - n: The sample size in a trial.</span></span>
<span><span class="co">#&gt; - p.v: The proportion of valid replications.</span></span>
<span><span class="co">#&gt; - est: The mean of the estimates in a test across replications.</span></span>
<span><span class="co">#&gt; - reject: The proportion of 'significant' replications, that is, the rejection rate. If</span></span>
<span><span class="co">#&gt;   the null hypothesis is true, this is the Type I error rate. If the null hypothesis is</span></span>
<span><span class="co">#&gt;   false, this is the power.</span></span>
<span><span class="co">#&gt; - r.cilo,r.cihi: The confidence interval of the rejection rate, based on Wilson's (1927)</span></span>
<span><span class="co">#&gt;   method.</span></span>
<span><span class="co">#&gt; - Refer to the tests for the meanings of other columns.</span></span></code></pre></div>
<p>It also reports major technical information regarding the search,
such as the range of sample sizes tried, the time spent, and the table
with all the sample sizes examined, along with the estimated power
levels and confidence intervals.</p>
<p>Note that it is normal for the probabilistic bisection method to try
the same value (same sample size) several times. Each trial is
independent of other trials, and provides unique information to the
search.</p>
<p>It also prints the model, the “power curve”, used to estimate the
relation between the power and the sample size. Note that this is only a
crude model intended only for the values of sample size examined (69 in
this example). It is not intended to estimate power for sample sizes
outside the range studied.</p>
<p>Unlike the (informal) bisection method, the final solution is usually
validated by a large number of replications (<code>final_nrep</code>)
when probabilistic bisection is used. Therefore, it is not necessary to
use the search process or the power curve to evaluate the final
solution.</p>
</div>
</div>
<div class="section level2">
<h2 id="advanced-features">Advanced Features<a class="anchor" aria-label="anchor" href="#advanced-features"></a>
</h2>
<p>This brief illustration only covers basic features of
<code><a href="../reference/x_from_power.html">n_from_power()</a></code>. There are other ways to customize the
search, such as the range of sample sizes to examine, the level of
confidence for the confidence interval, and the termination criteria
(e.g., the maximum number of trials, 100 by default for probabilistic
bisection). Please refer to the help page of
<code><a href="../reference/x_from_power.html">x_from_power()</a></code>, which <code><a href="../reference/x_from_power.html">n_from_power()</a></code> calls,
for these and other options.</p>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0" line-spacing="2">
<div id="ref-boos_monte_2000" class="csl-entry">
Boos, D. D., &amp; Zhang, J. (2000). Monte <span>Carlo</span> evaluation
of resampling-based hypothesis tests. <em>Journal of the American
Statistical Association</em>, <em>95</em>(450), 486–492. <a href="https://doi.org/10.1080/01621459.2000.10474226" class="external-link">https://doi.org/10.1080/01621459.2000.10474226</a>
</div>
<div id="ref-chalmers_solving_2024" class="csl-entry">
Chalmers, R. P. (2024). Solving variables with <span>Monte</span>
<span>Carlo</span> simulation experiments: <span>A</span> stochastic
root-solving approach. <em>Psychological Methods</em>. <a href="https://doi.org/10.1037/met0000689" class="external-link">https://doi.org/10.1037/met0000689</a>
</div>
<div id="ref-cheung_manymome_2024" class="csl-entry">
Cheung, S. F., &amp; Cheung, S.-H. (2024).
<span><em>manymome</em></span>: <span>An</span> <span>R</span> package
for computing the indirect effects, conditional effects, and conditional
indirect effects, standardized or unstandardized, and their bootstrap
confidence intervals, in many (though not all) models. <em>Behavior
Research Methods</em>, <em>56</em>(5), 4862–4882. <a href="https://doi.org/10.3758/s13428-023-02224-z" class="external-link">https://doi.org/10.3758/s13428-023-02224-z</a>
</div>
<div id="ref-waeber_bisection_2013" class="csl-entry">
Waeber, R., Frazier, P. I., &amp; Henderson, S. G. (2013). Bisection
search with noisy responses. <em>SIAM Journal on Control and
Optimization</em>, <em>51</em>(3), 2261–2279. <a href="https://doi.org/10.1137/120861898" class="external-link">https://doi.org/10.1137/120861898</a>
</div>
</div>
</div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Shu Fai Cheung, Sing-Hang Cheung, Wendie Yang.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
