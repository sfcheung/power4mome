<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Quick Template: Moderation with Observed Variables: Two Moderators • power4mome</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Hind-0.4.10/font.css" rel="stylesheet">
<link href="../deps/Oxygen_Mono-0.4.10/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Quick Template: Moderation with Observed Variables: Two Moderators">
<meta name="google-site-verification" content="0VLBmFnW_UJFI-7gXnORPBsWxqZwmzuGpK-TeVRLBjQ">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">power4mome</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.1.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/power4mome.html">Get started</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Scenarios</h6></li>
    <li><a class="dropdown-item" href="../articles/power4test_latent_mediation.html">Power Analysis for Latent Variable Mediation</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Given Power, Find x</h6></li>
    <li><a class="dropdown-item" href="../articles/x_from_power_for_n.html">Sample Size Given Desired Power</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Templates (Code Examples)</h6></li>
    <li><a class="dropdown-item" href="../articles/template_n_from_power_mediation_obs_simple.html">Quick Template: Simple Mediation with Observed Variables</a></li>
    <li><a class="dropdown-item" href="../articles/template_n_from_power_mediation_obs_serial.html">Quick Template: Serial Mediation with Observed Variables</a></li>
    <li><a class="dropdown-item" href="../articles/template_n_from_power_mediation_obs_parallel.html">Quick Template: Parallel Mediation with Observed Variables</a></li>
    <li><a class="dropdown-item" href="../articles/template_n_from_power_mediation_lav_simple.html">Quick Template: Simple Mediation with Latent Variables</a></li>
    <li><a class="dropdown-item" href="../articles/template_n_from_power_mediation_lav_serial.html">Quick Template: Serial Mediation with Latent Variables</a></li>
    <li><a class="dropdown-item" href="../articles/template_n_from_power_mediation_lav_parallel.html">Quick Template: Parallel Mediation with Latent Variables</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Moderation Templates (Code Examples)</h6></li>
    <li><a class="dropdown-item" href="../articles/template_n_from_power_moderation_obs_simple.html">Quick Template: Simple Moderation with Observed Variables</a></li>
    <li><a class="dropdown-item" href="../articles/template_n_from_power_moderation_obs_two_ws.html">Quick Template: Moderation with Observed Variables: Two Moderators</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Moderated Mediation Templates (Code Examples)</h6></li>
    <li><a class="dropdown-item" href="../articles/template_n_from_power_mome_obs_a.html">Quick Template: Simple Moderated Mediation with Observed Variables: a-Path Moderated</a></li>
    <li><a class="dropdown-item" href="../articles/template_n_from_power_mome_obs_b.html">Quick Template: Simple Moderated Mediation with Observed Variables: b-Path Moderated</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/index.html">More articles...</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/sfcheung/power4mome/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">



<script src="template_n_from_power_moderation_obs_two_ws_files/htmlwidgets-1.6.4/htmlwidgets.js"></script><script src="template_n_from_power_moderation_obs_two_ws_files/d3-3.3.8/d3.min.js"></script><script src="template_n_from_power_moderation_obs_two_ws_files/dagre-0.4.0/dagre-d3.min.js"></script><link href="template_n_from_power_moderation_obs_two_ws_files/mermaid-0.3.0/dist/mermaid.css" rel="stylesheet">
<script src="template_n_from_power_moderation_obs_two_ws_files/mermaid-0.3.0/dist/mermaid.slim.min.js"></script><link href="template_n_from_power_moderation_obs_two_ws_files/DiagrammeR-styles-0.2/styles.css" rel="stylesheet">
<script src="template_n_from_power_moderation_obs_two_ws_files/chromatography-0.1/chromatography.js"></script><script src="template_n_from_power_moderation_obs_two_ws_files/DiagrammeR-binding-1.0.11/DiagrammeR.js"></script><div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Quick Template: Moderation with Observed Variables: Two Moderators</h1>
            
            <h4 data-toc-skip class="date">2025-10-26</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/sfcheung/power4mome/blob/main/vignettes/articles/template_n_from_power_moderation_obs_two_ws.Rmd" class="external-link"><code>vignettes/articles/template_n_from_power_moderation_obs_two_ws.Rmd</code></a></small>
      <div class="d-none name"><code>template_n_from_power_moderation_obs_two_ws.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This and other “Quick Template” articles are examples of R code to
determine the range of sample sizes for a target level of power in
typical models using <a href="https://sfcheung.github.io/power4mome/">power4mome</a>. Users can
quickly adapt them for their scenarios. A summary of the code examples
can be found in the section <a href="#code_template">Code Template</a>
at the end of this document.</p>
</div>
<div class="section level2">
<h2 id="prerequisite">Prerequisite<a class="anchor" aria-label="anchor" href="#prerequisite"></a>
</h2>
<p>Basic knowledge about fitting models by <code>lavaan</code> and
<code>power4mome</code> is required.</p>
<p>This file is not intended to be an introduction on how to use
functions in <code>power4mome</code>. For details on how to use
<code><a href="../reference/power4test.html">power4test()</a></code>, refer to the <a href="https://sfcheung.github.io/power4mome/articles/power4mome.html">Get-Started
article</a>. Please also refer to the help page of
<code><a href="../reference/x_from_power.html">n_region_from_power()</a></code>, and the <a href="https://sfcheung.github.io/power4mome/articles/x_from_power_for_n.html">article</a>
on <code><a href="../reference/x_from_power.html">n_from_power()</a></code>, which is called twice by
<code><a href="../reference/x_from_power.html">n_region_from_power()</a></code> to find the regions described
below.</p>
</div>
<div class="section level2">
<h2 id="scope">Scope<a class="anchor" aria-label="anchor" href="#scope"></a>
</h2>
<p>This file is for moderation models with two or more moderators, and
only two-way interaction effects are involved.</p>
</div>
<div class="section level2">
<h2 id="functions-used-in-this-template">Functions Used in This Template<a class="anchor" aria-label="anchor" href="#functions-used-in-this-template"></a>
</h2>
<ul>
<li>
<p><code><a href="../reference/power4test.html">power4test()</a></code></p>
<ul>
<li>Set up the model and the population values, generate the data, and
generate the Monte Carlo simulated estimates for Monte Carlo confidence
interval.</li>
</ul>
</li>
<li>
<p><code><a href="../reference/x_from_power.html">n_region_from_power()</a></code></p>
<ul>
<li>Find the regions of sample sizes based on the target power.</li>
</ul>
</li>
<li>
<p><code><a href="../reference/test_parameters.html">test_parameters()</a></code></p>
<ul>
<li>Test selected parameters. Used by <code><a href="../reference/power4test.html">power4test()</a></code> to test
a selected product term (interaction term).</li>
</ul>
</li>
</ul>
</div>
<div class="section level2">
<h2 id="common-flow">Common Flow<a class="anchor" aria-label="anchor" href="#common-flow"></a>
</h2>
<p>The following chart summarizes the steps covered below.</p>
<div class="figure" style="text-align: center">
<div id="htmlwidget-ac96cb3ee4656e2e9ec3" style="width:500px;height:550px;" class="DiagrammeR html-widget"></div>
<script type="application/json" data-for="htmlwidget-ac96cb3ee4656e2e9ec3">{"x":{"diagram":"\nflowchart TD\n\n  classDef default fill:lightblue;\n  classDef default2 fill:lightgreen;\n\n  style tryn fill: lightyellow\n  style model fill: lightyellow\n\n  SetModel(\"Set Up the Population Model (<i>model<\/i>)\")\n  SetES(\"Set the Population Values (<i>pop_es<\/i>)\")\n  OneN(\"Check the Setup<br/><i>power4test()<\/i>\")\n  %% SeveralN(\"Try several ns<br/><i>power4test_by_n()<\/i>\")\n  SearchN(\"Search the regions of ns<br/><i>n_region_from_power()<\/i>\")\n  %% AnotherN(\"Try another n<br/><i>power4test()<\/i>\")\n\n  subgraph model [\"Set Up the Model and Test\"]\n\n  SetModel:::default2 --> SetES:::default2\n  SetES --> OneN\n\n  end\n\n  %% OneN -.-> SetES\n\n  subgraph tryn [\"The Region of Sample Sizes\"]\n\n  OneN --> SearchN\n  SearchN -->|Try Other<br/>Population Values| SetES\n\n  %% OneN <==> AnotherN\n  %% AnotherN <==> SeveralN\n  %% AnotherN <==> SearchN\n  %% OneN <==> SeveralN\n  %% OneN <==> SearchN\n  %% SeveralN <==> SearchN\n\n  end\n\n  %% AnotherN -.-> SetES\n  %% SeveralN -.-> SetES\n  %% SearchN -.-> SetES\n"},"evals":[],"jsHooks":[]}</script><p class="caption">
Common Workflow
</p>
</div>
<p>In practice, steps can be repeated, and population values changed,
until the desired goal is achieved (e.g., the region of sample sizes
with power close to the target power is found).</p>
</div>
<div class="section level2">
<h2 id="set-up-the-model-and-test">Set Up The Model and Test<a class="anchor" aria-label="anchor" href="#set-up-the-model-and-test"></a>
</h2>
<p>Load the package first:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://sfcheung.github.io/power4mome/">power4mome</a></span><span class="op">)</span></span></code></pre></div>
<p>Estimate the power for a sample size.</p>
<p>The case of two moderators is illustrated but the code can be easily
extended to any number of moderators.</p>
<p>The code for the model:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># ====== Model: Form ======</span></span>
<span></span>
<span><span class="co"># Make sure all 1st order terms (w1, w2, w3, etc.) are included</span></span>
<span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span></span>
<span><span class="st">"</span></span>
<span><span class="st">y ~ x + w1 + w2 + x:w1 + x:w2</span></span>
<span><span class="st">"</span></span>
<span></span>
<span><span class="co"># ====== Model: Population Values ======</span></span>
<span></span>
<span><span class="co"># For a regression coefficient</span></span>
<span><span class="co"># l: large (.50 by default)</span></span>
<span><span class="co"># m: medium (.30 by default)</span></span>
<span><span class="co"># s: small (.10 by default)</span></span>
<span><span class="co"># n: nil (.00 by default)</span></span>
<span><span class="co"># For the product term:</span></span>
<span><span class="co"># l: large (.15 by default)</span></span>
<span><span class="co"># m: medium (.10 by default)</span></span>
<span><span class="co"># s: small (.05 by default)</span></span>
<span><span class="co"># -l, -m, and -s denote negative values</span></span>
<span><span class="co"># Omitted paths are zero by default</span></span>
<span><span class="co"># Can also set to a number directly</span></span>
<span><span class="co"># Set each path to the hypothesized magnitude</span></span>
<span></span>
<span><span class="co"># For a path moderated, the coefficient</span></span>
<span><span class="co"># of a predictor is its standardized</span></span>
<span><span class="co"># effect when the moderator equal to</span></span>
<span><span class="co"># its mean.</span></span>
<span></span>
<span><span class="va">model_es</span> <span class="op">&lt;-</span></span>
<span><span class="st">"</span></span>
<span><span class="st">y ~ x: s</span></span>
<span><span class="st">y ~ w1: s</span></span>
<span><span class="st">y ~ w2: s</span></span>
<span><span class="st">y ~ x:w1: l</span></span>
<span><span class="st">y ~ x:w2: m</span></span>
<span><span class="st">"</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="template_n_from_power_moderation_obs_two_ws_model-1.png" alt="The Model"><p class="caption">
The Model
</p>
</div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># ====== Test the Model Specification ======</span></span>
<span></span>
<span><span class="co"># Fit the model by regression using lm()</span></span>
<span><span class="co"># Add: fit_model_args = list(fit_function = "lm")</span></span>
<span></span>
<span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/power4test.html">power4test</a></span><span class="op">(</span>nrep <span class="op">=</span> <span class="fl">2</span>,</span>
<span>                  model <span class="op">=</span> <span class="va">model</span>,</span>
<span>                  pop_es <span class="op">=</span> <span class="va">model_es</span>,</span>
<span>                  n <span class="op">=</span> <span class="fl">50000</span>,</span>
<span>                  fit_model_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>fit_function <span class="op">=</span> <span class="st">"lm"</span><span class="op">)</span>,</span>
<span>                  iseed <span class="op">=</span> <span class="fl">1234</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># ====== Check the Data Generated ======</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">out</span>,</span>
<span>      data_long <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># ====== Estimate the Power ======</span></span>
<span></span>
<span><span class="co"># For n = 100.</span></span>
<span><span class="co"># Find the power with *both* x:w1 and x:w2 significant.</span></span>
<span><span class="co"># in the regression results of lm().</span></span>
<span><span class="co"># The test by CI is equivalent to the two-tailed t-test.</span></span>
<span><span class="co"># Add omnibus = "all_sig" to find this power.</span></span>
<span></span>
<span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/power4test.html">power4test</a></span><span class="op">(</span>nrep <span class="op">=</span> <span class="fl">400</span>,</span>
<span>                  model <span class="op">=</span> <span class="va">model</span>,</span>
<span>                  pop_es <span class="op">=</span> <span class="va">model_es</span>,</span>
<span>                  n <span class="op">=</span> <span class="fl">100</span>,</span>
<span>                  fit_model_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>fit_function <span class="op">=</span> <span class="st">"lm"</span><span class="op">)</span>,</span>
<span>                  test_fun <span class="op">=</span> <span class="va">test_parameters</span>,</span>
<span>                  test_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>pars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"y~x:w1"</span>,</span>
<span>                                            <span class="st">"y~x:w2"</span><span class="op">)</span>,</span>
<span>                                   omnibus <span class="op">=</span> <span class="st">"all_sig"</span><span class="op">)</span>,</span>
<span>                  iseed <span class="op">=</span> <span class="fl">1234</span>,</span>
<span>                  parallel <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># ====== Compute the Rejection Rate ======</span></span>
<span></span>
<span><span class="fu"><a href="../reference/rejection_rates.html">rejection_rates</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span></span></code></pre></div>
<p>The results:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">out</span>,</span>
<span>      data_long <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ====================== Model Information ======================</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; == Model on Factors/Variables ==</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; y ~ x + w1 + w2 + x:w1 + x:w2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; == Model on Variables/Indicators ==</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; y ~ x + w1 + w2 + x:w1 + x:w2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ====== Population Values ======</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Regressions:</span></span>
<span><span class="co">#&gt;                    Population</span></span>
<span><span class="co">#&gt;   y ~                        </span></span>
<span><span class="co">#&gt;     x                 0.100  </span></span>
<span><span class="co">#&gt;     w1                0.100  </span></span>
<span><span class="co">#&gt;     w2                0.100  </span></span>
<span><span class="co">#&gt;     x:w1              0.150  </span></span>
<span><span class="co">#&gt;     x:w2              0.100  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Covariances:</span></span>
<span><span class="co">#&gt;                    Population</span></span>
<span><span class="co">#&gt;   x ~~                       </span></span>
<span><span class="co">#&gt;     w1                0.000  </span></span>
<span><span class="co">#&gt;     w2                0.000  </span></span>
<span><span class="co">#&gt;     x:w1              0.000  </span></span>
<span><span class="co">#&gt;     x:w2              0.000  </span></span>
<span><span class="co">#&gt;   w1 ~~                      </span></span>
<span><span class="co">#&gt;     w2                0.000  </span></span>
<span><span class="co">#&gt;     x:w1              0.000  </span></span>
<span><span class="co">#&gt;     x:w2              0.000  </span></span>
<span><span class="co">#&gt;   w2 ~~                      </span></span>
<span><span class="co">#&gt;     x:w1              0.000  </span></span>
<span><span class="co">#&gt;     x:w2              0.000  </span></span>
<span><span class="co">#&gt;   x:w1 ~~                    </span></span>
<span><span class="co">#&gt;     x:w2              0.000  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Variances:</span></span>
<span><span class="co">#&gt;                    Population</span></span>
<span><span class="co">#&gt;    .y                 0.937  </span></span>
<span><span class="co">#&gt;     x                 1.000  </span></span>
<span><span class="co">#&gt;     w1                1.000  </span></span>
<span><span class="co">#&gt;     w2                1.000  </span></span>
<span><span class="co">#&gt;     x:w1              1.000  </span></span>
<span><span class="co">#&gt;     x:w2              1.000  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; (Computing conditional effects for 3 paths ...)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; == Population Conditional/Indirect Effect(s) ==</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; == Conditional effects ==</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Path: x -&gt; y</span></span>
<span><span class="co">#&gt;  Conditional on moderator(s): w1, w2</span></span>
<span><span class="co">#&gt;  Moderator(s) represented by: w1, w2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;      [w1]    [w2] (w1) (w2)    ind</span></span>
<span><span class="co">#&gt; 1 M+1.0SD M+1.0SD    1    1  0.350</span></span>
<span><span class="co">#&gt; 2 M+1.0SD M-1.0SD    1   -1  0.150</span></span>
<span><span class="co">#&gt; 3 M-1.0SD M+1.0SD   -1    1  0.050</span></span>
<span><span class="co">#&gt; 4 M-1.0SD M-1.0SD   -1   -1 -0.150</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  - The 'ind' column shows the conditional effects.</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; == Conditional effects ==</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Path: w1 -&gt; y</span></span>
<span><span class="co">#&gt;  Conditional on moderator(s): x</span></span>
<span><span class="co">#&gt;  Moderator(s) represented by: x</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;       [x] (x)    ind</span></span>
<span><span class="co">#&gt; 1 M+1.0SD   1  0.250</span></span>
<span><span class="co">#&gt; 2 Mean      0  0.100</span></span>
<span><span class="co">#&gt; 3 M-1.0SD  -1 -0.050</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  - The 'ind' column shows the conditional effects.</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; == Conditional effects ==</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Path: w2 -&gt; y</span></span>
<span><span class="co">#&gt;  Conditional on moderator(s): x</span></span>
<span><span class="co">#&gt;  Moderator(s) represented by: x</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;       [x] (x)   ind</span></span>
<span><span class="co">#&gt; 1 M+1.0SD   1 0.200</span></span>
<span><span class="co">#&gt; 2 Mean      0 0.100</span></span>
<span><span class="co">#&gt; 3 M-1.0SD  -1 0.000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  - The 'ind' column shows the conditional effects.</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ======================= Data Information =======================</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of Replications:  400 </span></span>
<span><span class="co">#&gt; Sample Sizes:  100 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ==== Descriptive Statistics ====</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;      vars     n  mean sd skew kurtosis   se</span></span>
<span><span class="co">#&gt; y       1 40000  0.00  1 0.03     0.04 0.01</span></span>
<span><span class="co">#&gt; x       2 40000 -0.01  1 0.00     0.02 0.01</span></span>
<span><span class="co">#&gt; w1      3 40000  0.01  1 0.01    -0.03 0.01</span></span>
<span><span class="co">#&gt; w2      4 40000  0.00  1 0.00     0.01 0.01</span></span>
<span><span class="co">#&gt; x:w1    5 40000  0.00  1 0.04     5.73 0.01</span></span>
<span><span class="co">#&gt; x:w2    6 40000  0.00  1 0.02     6.02 0.01</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ==== Parameter Estimates Based on All 400 Samples Combined ====</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Total Sample Size: 40000 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ==== Standardized Estimates ====</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Variances and error variances omitted.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Regressions:</span></span>
<span><span class="co">#&gt;                     est.std</span></span>
<span><span class="co">#&gt;   y ~                      </span></span>
<span><span class="co">#&gt;     x                 0.094</span></span>
<span><span class="co">#&gt;     w1                0.095</span></span>
<span><span class="co">#&gt;     w2                0.106</span></span>
<span><span class="co">#&gt;     x:w1              0.149</span></span>
<span><span class="co">#&gt;     x:w2              0.099</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Covariances:</span></span>
<span><span class="co">#&gt;                     est.std</span></span>
<span><span class="co">#&gt;   x ~~                     </span></span>
<span><span class="co">#&gt;     w1               -0.001</span></span>
<span><span class="co">#&gt;     w2                0.002</span></span>
<span><span class="co">#&gt;     x:w1              0.022</span></span>
<span><span class="co">#&gt;     x:w2              0.007</span></span>
<span><span class="co">#&gt;   w1 ~~                    </span></span>
<span><span class="co">#&gt;     w2                0.004</span></span>
<span><span class="co">#&gt;     x:w1             -0.000</span></span>
<span><span class="co">#&gt;     x:w2              0.004</span></span>
<span><span class="co">#&gt;   w2 ~~                    </span></span>
<span><span class="co">#&gt;     x:w1              0.004</span></span>
<span><span class="co">#&gt;     x:w2             -0.009</span></span>
<span><span class="co">#&gt;   x:w1 ~~                  </span></span>
<span><span class="co">#&gt;     x:w2              0.002</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ==================== Extra Element(s) Found ====================</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - fit</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; === Element(s) of the First Dataset ===</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ============ &lt;fit&gt; ============</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; The models:</span></span>
<span><span class="co">#&gt; y ~ x + w1 + w2 + x:w1 + x:w2</span></span>
<span><span class="co">#&gt; &lt;environment: 0x00000208641ac778&gt;</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ====================== Test(s) Conducted ======================</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - test_parameters: CIs (pars: y~x:w1,y~x:w2)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call print() and set 'test_long = TRUE' for a detailed report.</span></span>
<span><span class="fu"><a href="../reference/rejection_rates.html">rejection_rates</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span></span>
<span><span class="co">#&gt; [test]: test_parameters: CIs (pars: y~x:w1,y~x:w2) </span></span>
<span><span class="co">#&gt; [test_label]: All sig </span></span>
<span><span class="co">#&gt;    est   p.v reject r.cilo r.cihi</span></span>
<span><span class="co">#&gt; 1  NaN 1.000  0.062  0.043  0.091</span></span>
<span><span class="co">#&gt; Notes:</span></span>
<span><span class="co">#&gt; - p.v: The proportion of valid replications.</span></span>
<span><span class="co">#&gt; - est: The mean of the estimates in a test across replications.</span></span>
<span><span class="co">#&gt; - reject: The proportion of 'significant' replications, that is, the</span></span>
<span><span class="co">#&gt;   rejection rate. If the null hypothesis is true, this is the Type I</span></span>
<span><span class="co">#&gt;   error rate. If the null hypothesis is false, this is the power.</span></span>
<span><span class="co">#&gt; - r.cilo,r.cihi: The confidence interval of the rejection rate, based</span></span>
<span><span class="co">#&gt;   on Wilson's (1927) method.</span></span>
<span><span class="co">#&gt; - Refer to the tests for the meanings of other columns.</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="find-the-regions-of-n-based-on-the-target-power">Find the Regions of <em>N</em> Based on the Target Power<a class="anchor" aria-label="anchor" href="#find-the-regions-of-n-based-on-the-target-power"></a>
</h2>
<p>Search, by simulation, the following two regions of sample sizes:</p>
<ul>
<li><p>Sample sizes with estimated levels of power significantly below
the target level (e.g., .80), tested by the confidence interval (95% by
default).</p></li>
<li><p>Sample sizes with estimated levels of power significantly above
the target level (e.g., .80), tested by the confidence interval (95% by
default).</p></li>
</ul>
<p>In practice, we rarely need high precision for these regions for
sample size planning. Therefore, we only need to find the two sample
sizes with the corresponding confidence bounds <em>close</em>
<em>enough</em> to the target power, defined by a tolerance value. In
the function below, this value is .02 by default.</p>
<p>It can take some time to run if the estimated power of the sample
size is too different from the target power.</p>
<p>We can find the two regions by
<code><a href="../reference/x_from_power.html">n_region_from_power()</a></code>.</p>
<p>The code:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#</span></span>
<span><span class="co"># ===== Reuse the output of power4test() =====</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># Call n_region_from_power()</span></span>
<span><span class="co"># - Set target power: target_power = .80 (Default, can be omitted)</span></span>
<span><span class="co"># - Set the seed for the simulation: Integer. Should always be set.</span></span>
<span><span class="co"># To set desired precision:</span></span>
<span><span class="co"># - Set final number of R: final_R = 1000 (Default, can be omitted)</span></span>
<span><span class="co"># - Set final number of replications: final_nrep = 400 (Default, can be omitted)</span></span>
<span></span>
<span><span class="va">n_power_region</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/x_from_power.html">n_region_from_power</a></span><span class="op">(</span><span class="va">out</span>,</span>
<span>                                      seed <span class="op">=</span> <span class="fl">1357</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># ===== Basic Results =====</span></span>
<span></span>
<span><span class="va">n_power_region</span></span>
<span></span>
<span><span class="co"># ===== Plot the (Crude) Power Curve and the Regions =====</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">n_power_region</span><span class="op">)</span></span></code></pre></div>
<p>The results:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># ===== Basic Results =====</span></span>
<span></span>
<span><span class="va">n_power_region</span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; n_region_from_power(object = out, seed = 1357)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                      Setting                                      </span></span>
<span><span class="co">#&gt; Predictor(x)         Sample Size                                  </span></span>
<span><span class="co">#&gt; Goal:                Power significantly below or above the target</span></span>
<span><span class="co">#&gt; algorithm:           bisection                                    </span></span>
<span><span class="co">#&gt; Level of confidence: 95.00%                                       </span></span>
<span><span class="co">#&gt; Target Power:        0.800                                        </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Solution: </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Approximate region of sample sizes with power:</span></span>
<span><span class="co">#&gt; - not significantly different from 0.800: 709 to 838</span></span>
<span><span class="co">#&gt; - significantly lower than 0.800: 709</span></span>
<span><span class="co">#&gt; - significantly higher than 0.800: 838</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Confidence intervals of the estimated power:</span></span>
<span><span class="co">#&gt; - for the lower bound (709): [0.718, 0.802]</span></span>
<span><span class="co">#&gt; - for the upper bound (838): [0.793, 0.866]</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call `summary()` for detailed results.</span></span>
<span></span>
<span><span class="co"># ===== Plot the (Crude) Power Curve and the Regions =====</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">n_power_region</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="template_n_from_power_moderation_obs_two_ws_plot-1.png" alt="Power Curve"><p class="caption">
Power Curve
</p>
</div>
<p>As shown above, approximately:</p>
<ul>
<li><p>sample sizes lower than 709 have power significantly lower than
.80, and</p></li>
<li><p>sample sizes higher than 838 have power significantly higher than
.80.</p></li>
</ul>
<p>In other words, sample sizes between 709 and 838 have power not
significantly different from .80.</p>
<p>If necessary, detailed results can be printed by
<code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code>:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># ===== Detailed Results =====</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">n_power_region</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ======&lt;&lt; Summary for the Lower Region &gt;&gt;======</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ====== x_from_power Results ======</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; power4mome::x_from_power(object = out, x = "n", what = "ub", </span></span>
<span><span class="co">#&gt;     goal = "close_enough", seed = 1357)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Predictor (x): Sample Size </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - Target Power: 0.800 </span></span>
<span><span class="co">#&gt; - Goal: Find 'x' with estimated upper confidence bound close enough to</span></span>
<span><span class="co">#&gt;   the target power.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; === Major Results ===</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - Final Value (Sample Size): 709</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - Final Estimated Power: 0.762 </span></span>
<span><span class="co">#&gt; - Confidence Interval: [0.718; 0.802]</span></span>
<span><span class="co">#&gt; - Level of confidence: 95.0%</span></span>
<span><span class="co">#&gt; - Based on 400 replications.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; === Technical Information ===</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - Algorithm: bisection </span></span>
<span><span class="co">#&gt; - Tolerance for 'close enough': Within 0.02000 of 0.800 </span></span>
<span><span class="co">#&gt; - The range of values explored: 100 to 985 </span></span>
<span><span class="co">#&gt; - Time spent in the search: 59.23 secs </span></span>
<span><span class="co">#&gt; - The final crude model for the power-predictor relation:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model Type: Logistic Regression </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; power_curve(object = by_x_1, formula = power_model, start = power_curve_start, </span></span>
<span><span class="co">#&gt;     lower_bound = lower_bound, upper_bound = upper_bound, nls_args = nls_args, </span></span>
<span><span class="co">#&gt;     nls_control = nls_control, verbose = progress)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Predictor: n (Sample Size)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:  stats::glm(formula = reject ~ x, family = "binomial", data = reject1)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt; (Intercept)            x  </span></span>
<span><span class="co">#&gt;   -2.576927     0.005038  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Degrees of Freedom: 3199 Total (i.e. Null);  3198 Residual</span></span>
<span><span class="co">#&gt; Null Deviance:       3753 </span></span>
<span><span class="co">#&gt; Residual Deviance: 2765  AIC: 2769</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - Detailed Results:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [test]: test_parameters: CIs (pars: y~x:w1,y~x:w2) </span></span>
<span><span class="co">#&gt; [test_label]: All sig </span></span>
<span><span class="co">#&gt;      n  est   p.v reject r.cilo r.cihi</span></span>
<span><span class="co">#&gt; 1  100  NaN 1.000  0.062  0.043  0.091</span></span>
<span><span class="co">#&gt; 2  690  NaN 1.000  0.715  0.669  0.757</span></span>
<span><span class="co">#&gt; 3  709  NaN 1.000  0.762  0.718  0.802</span></span>
<span><span class="co">#&gt; 4  727  NaN 1.000  0.787  0.745  0.825</span></span>
<span><span class="co">#&gt; 5  764  NaN 1.000  0.830  0.790  0.864</span></span>
<span><span class="co">#&gt; 6  838  NaN 1.000  0.833  0.793  0.866</span></span>
<span><span class="co">#&gt; 7  985  NaN 1.000  0.890  0.856  0.917</span></span>
<span><span class="co">#&gt; 8 1280  NaN 1.000  0.935  0.906  0.955</span></span>
<span><span class="co">#&gt; Notes:</span></span>
<span><span class="co">#&gt; - n: The sample size in a trial.</span></span>
<span><span class="co">#&gt; - p.v: The proportion of valid replications.</span></span>
<span><span class="co">#&gt; - est: The mean of the estimates in a test across replications.</span></span>
<span><span class="co">#&gt; - reject: The proportion of 'significant' replications, that is, the</span></span>
<span><span class="co">#&gt;   rejection rate. If the null hypothesis is true, this is the Type I</span></span>
<span><span class="co">#&gt;   error rate. If the null hypothesis is false, this is the power.</span></span>
<span><span class="co">#&gt; - r.cilo,r.cihi: The confidence interval of the rejection rate, based</span></span>
<span><span class="co">#&gt;   on Wilson's (1927) method.</span></span>
<span><span class="co">#&gt; - Refer to the tests for the meanings of other columns.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ======&lt;&lt; Summary for the Upper Region &gt;&gt;======</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ====== x_from_power Results ======</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; power4mome::x_from_power(object = out, seed = 1357, x = "n", </span></span>
<span><span class="co">#&gt;     what = "lb", goal = "close_enough")</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Predictor (x): Sample Size </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - Target Power: 0.800 </span></span>
<span><span class="co">#&gt; - Goal: Find 'x' with estimated lower confidence bound close enough to</span></span>
<span><span class="co">#&gt;   the target power.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; === Major Results ===</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - Final Value (Sample Size): 838</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - Final Estimated Power: 0.833 </span></span>
<span><span class="co">#&gt; - Confidence Interval: [0.793; 0.866]</span></span>
<span><span class="co">#&gt; - Level of confidence: 95.0%</span></span>
<span><span class="co">#&gt; - Based on 400 replications.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; === Technical Information ===</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - Algorithm: bisection </span></span>
<span><span class="co">#&gt; - Tolerance for 'close enough': Within  of 0.800 </span></span>
<span><span class="co">#&gt; - The range of values explored: 100 to 985 </span></span>
<span><span class="co">#&gt; - Time spent in the search: 0.5908 secs </span></span>
<span><span class="co">#&gt; - The final crude model for the power-predictor relation:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model Type: Logistic Regression </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; power_curve(object = by_x_1, formula = power_curve_args$power_model, </span></span>
<span><span class="co">#&gt;     start = power_curve_args$start, lower_bound = power_curve_args$lower_bound, </span></span>
<span><span class="co">#&gt;     upper_bound = power_curve_args$upper_bound, nls_args = power_curve_args$nls_args, </span></span>
<span><span class="co">#&gt;     nls_control = power_curve_args$nls_control, verbose = progress)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Predictor: n (Sample Size)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:  stats::glm(formula = reject ~ x, family = "binomial", data = reject1)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt; (Intercept)            x  </span></span>
<span><span class="co">#&gt;   -2.576927     0.005038  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Degrees of Freedom: 3199 Total (i.e. Null);  3198 Residual</span></span>
<span><span class="co">#&gt; Null Deviance:       3753 </span></span>
<span><span class="co">#&gt; Residual Deviance: 2765  AIC: 2769</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - Detailed Results:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [test]: test_parameters: CIs (pars: y~x:w1,y~x:w2) </span></span>
<span><span class="co">#&gt; [test_label]: All sig </span></span>
<span><span class="co">#&gt;      n  est   p.v reject r.cilo r.cihi</span></span>
<span><span class="co">#&gt; 1  100  NaN 1.000  0.062  0.043  0.091</span></span>
<span><span class="co">#&gt; 2  690  NaN 1.000  0.715  0.669  0.757</span></span>
<span><span class="co">#&gt; 3  709  NaN 1.000  0.762  0.718  0.802</span></span>
<span><span class="co">#&gt; 4  727  NaN 1.000  0.787  0.745  0.825</span></span>
<span><span class="co">#&gt; 5  764  NaN 1.000  0.830  0.790  0.864</span></span>
<span><span class="co">#&gt; 6  838  NaN 1.000  0.833  0.793  0.866</span></span>
<span><span class="co">#&gt; 7  985  NaN 1.000  0.890  0.856  0.917</span></span>
<span><span class="co">#&gt; 8 1280  NaN 1.000  0.935  0.906  0.955</span></span>
<span><span class="co">#&gt; Notes:</span></span>
<span><span class="co">#&gt; - n: The sample size in a trial.</span></span>
<span><span class="co">#&gt; - p.v: The proportion of valid replications.</span></span>
<span><span class="co">#&gt; - est: The mean of the estimates in a test across replications.</span></span>
<span><span class="co">#&gt; - reject: The proportion of 'significant' replications, that is, the</span></span>
<span><span class="co">#&gt;   rejection rate. If the null hypothesis is true, this is the Type I</span></span>
<span><span class="co">#&gt;   error rate. If the null hypothesis is false, this is the power.</span></span>
<span><span class="co">#&gt; - r.cilo,r.cihi: The confidence interval of the rejection rate, based</span></span>
<span><span class="co">#&gt;   on Wilson's (1927) method.</span></span>
<span><span class="co">#&gt; - Refer to the tests for the meanings of other columns.</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="code_template">Code Template<a class="anchor" aria-label="anchor" href="#code_template"></a>
</h2>
<p>This is the code used above:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://sfcheung.github.io/power4mome/">power4mome</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># ====== Model and Effect Size (Population Values) ======</span></span>
<span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span></span>
<span><span class="st">"</span></span>
<span><span class="st">y ~ x + w1 + w2 + x:w1 + x:w2</span></span>
<span><span class="st">"</span></span>
<span><span class="va">model_es</span> <span class="op">&lt;-</span></span>
<span><span class="st">"</span></span>
<span><span class="st">y ~ x: s</span></span>
<span><span class="st">y ~ w1: s</span></span>
<span><span class="st">y ~ w2: s</span></span>
<span><span class="st">y ~ x:w1: l</span></span>
<span><span class="st">y ~ x:w2: m</span></span>
<span><span class="st">"</span></span>
<span></span>
<span><span class="co"># Test the Model Specification</span></span>
<span></span>
<span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/power4test.html">power4test</a></span><span class="op">(</span>nrep <span class="op">=</span> <span class="fl">2</span>,</span>
<span>                  model <span class="op">=</span> <span class="va">model</span>,</span>
<span>                  pop_es <span class="op">=</span> <span class="va">model_es</span>,</span>
<span>                  n <span class="op">=</span> <span class="fl">50000</span>,</span>
<span>                  fit_model_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>fit_function <span class="op">=</span> <span class="st">"lm"</span><span class="op">)</span>,</span>
<span>                  iseed <span class="op">=</span> <span class="fl">1234</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Check the Data Generated</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">out</span>,</span>
<span>      data_long <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># ====== Try One N and Estimate the Power ======</span></span>
<span></span>
<span><span class="co"># For n = 100.</span></span>
<span><span class="co"># Find the power with *both* x:w1 and x:w2 significant.</span></span>
<span><span class="co"># in the regression results of lm().</span></span>
<span><span class="co"># The test by CI is equivalent to the two-tailed t-test.</span></span>
<span><span class="co"># Add omnibus = "all_sig" to find this power.</span></span>
<span></span>
<span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/power4test.html">power4test</a></span><span class="op">(</span>nrep <span class="op">=</span> <span class="fl">400</span>,</span>
<span>                  model <span class="op">=</span> <span class="va">model</span>,</span>
<span>                  pop_es <span class="op">=</span> <span class="va">model_es</span>,</span>
<span>                  n <span class="op">=</span> <span class="fl">100</span>,</span>
<span>                  fit_model_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>fit_function <span class="op">=</span> <span class="st">"lm"</span><span class="op">)</span>,</span>
<span>                  test_fun <span class="op">=</span> <span class="va">test_parameters</span>,</span>
<span>                  test_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>pars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"y~x:w1"</span>,</span>
<span>                                            <span class="st">"y~x:w2"</span><span class="op">)</span>,</span>
<span>                                   omnibus <span class="op">=</span> <span class="st">"all_sig"</span><span class="op">)</span>,</span>
<span>                  iseed <span class="op">=</span> <span class="fl">1234</span>,</span>
<span>                  parallel <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/rejection_rates.html">rejection_rates</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># ====== Regions of Ns ======</span></span>
<span></span>
<span><span class="co"># Call n_region_from_power()</span></span>
<span><span class="co"># - Set target power: target_power = .80 (Default, can be omitted)</span></span>
<span><span class="co"># - Set the seed for the simulation: Integer. Should always be set.</span></span>
<span><span class="co"># To set desired precision:</span></span>
<span><span class="co"># - Set final number of R: final_R = 1000 (Default, can be omitted)</span></span>
<span><span class="co"># - Set final number of replications: final_nrep = 400 (Default, can be omitted)</span></span>
<span></span>
<span><span class="va">n_power_region</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/x_from_power.html">n_region_from_power</a></span><span class="op">(</span><span class="va">out</span>,</span>
<span>                                      seed <span class="op">=</span> <span class="fl">1357</span><span class="op">)</span></span>
<span><span class="va">n_power_region</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">n_power_region</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">n_power_region</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="final-remarks">Final Remarks<a class="anchor" aria-label="anchor" href="#final-remarks"></a>
</h2>
<p>For other options of <code><a href="../reference/power4test.html">power4test()</a></code> and
<code><a href="../reference/x_from_power.html">n_region_from_power()</a></code>, please refer to their help pages, as
well as the <a href="https://sfcheung.github.io/power4mome/articles/power4mome.html">Get-Started
article</a> and this <a href="https://sfcheung.github.io/power4mome/articles/x_from_power_for_n.html">article</a>
for <code><a href="../reference/x_from_power.html">n_from_power()</a></code>, which is the function to find one of
the regions, called twice by <code><a href="../reference/x_from_power.html">n_region_from_power()</a></code>.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Shu Fai Cheung, Sing-Hang Cheung, Wendie Yang.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
