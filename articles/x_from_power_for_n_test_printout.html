<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Sample Size Given Desired Power (Internal) • power4mome</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Hind-0.4.10/font.css" rel="stylesheet">
<link href="../deps/Oxygen_Mono-0.4.10/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Sample Size Given Desired Power (Internal)">
<meta name="google-site-verification" content="0VLBmFnW_UJFI-7gXnORPBsWxqZwmzuGpK-TeVRLBjQ">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">power4mome</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.1.24</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/power4mome.html">Get started</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Scenarios</h6></li>
    <li><a class="dropdown-item" href="../articles/power4test_latent_mediation.html">Power Analysis for Latent Variable Mediation</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Given Power, Find x</h6></li>
    <li><a class="dropdown-item" href="../articles/x_from_power_for_n.html">Sample Size Given Desired Power</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Common Mediation Models</h6></li>
    <li><a class="dropdown-item" href="../articles/template_q_med_obs_simple.html">Quick Function: Simple Mediation with Observed Variables</a></li>
    <li><a class="dropdown-item" href="../articles/template_q_med_obs_serial.html">Quick Function: Serial Mediation with Observed Variables</a></li>
    <li><a class="dropdown-item" href="../articles/template_q_med_obs_parallel.html">Quick Function: Parallel Mediation with Observed Variables</a></li>
    <li><a class="dropdown-item" href="../articles/template_q_med_lav_simple.html">Quick Function: Simple Mediation with Latent Variables</a></li>
    <li><a class="dropdown-item" href="../articles/template_q_med_lav_serial.html">Quick Function: Serial Mediation with Latent Variables</a></li>
    <li><a class="dropdown-item" href="../articles/template_q_med_lav_parallel.html">Quick Function: Parallel Mediation with Latent Variables</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Templates (Code Examples)</h6></li>
    <li><a class="dropdown-item" href="../articles/template_n_from_power_mediation_obs_simple.html">Quick Template: Simple Mediation with Observed Variables</a></li>
    <li><a class="dropdown-item" href="../articles/template_n_from_power_mediation_obs_serial.html">Quick Template: Serial Mediation with Observed Variables</a></li>
    <li><a class="dropdown-item" href="../articles/template_n_from_power_mediation_obs_parallel.html">Quick Template: Parallel Mediation with Observed Variables</a></li>
    <li><a class="dropdown-item" href="../articles/template_n_from_power_mediation_lav_simple.html">Quick Template: Simple Mediation with Latent Variables</a></li>
    <li><a class="dropdown-item" href="../articles/template_n_from_power_mediation_lav_serial.html">Quick Template: Serial Mediation with Latent Variables</a></li>
    <li><a class="dropdown-item" href="../articles/template_n_from_power_mediation_lav_parallel.html">Quick Template: Parallel Mediation with Latent Variables</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Moderation Templates (Code Examples)</h6></li>
    <li><a class="dropdown-item" href="../articles/template_n_from_power_moderation_obs_simple.html">Quick Template: Simple Moderation with Observed Variables</a></li>
    <li><a class="dropdown-item" href="../articles/template_n_from_power_moderation_obs_two_ws.html">Quick Template: Moderation with Observed Variables: Two Moderators</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Moderated Mediation Templates (Code Examples)</h6></li>
    <li><a class="dropdown-item" href="../articles/template_n_from_power_mome_obs_a.html">Quick Template: Simple Moderated Mediation with Observed Variables: a-Path Moderated</a></li>
    <li><a class="dropdown-item" href="../articles/template_n_from_power_mome_obs_b.html">Quick Template: Simple Moderated Mediation with Observed Variables: b-Path Moderated</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/index.html">More articles...</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/sfcheung/power4mome/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Sample Size Given Desired Power (Internal)</h1>
            
            <h4 data-toc-skip class="date">2025-12-13</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/sfcheung/power4mome/blob/main/vignettes/articles/x_from_power_for_n_test_printout.Rmd" class="external-link"><code>vignettes/articles/x_from_power_for_n_test_printout.Rmd</code></a></small>
      <div class="d-none name"><code>x_from_power_for_n_test_printout.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="note">NOTE<a class="anchor" aria-label="anchor" href="#note"></a>
</h2>
<p>This article is for internal testing of the printout.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://sfcheung.github.io/power4mome/">power4mome</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>power4mome.bz <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod</span> <span class="op">&lt;-</span></span>
<span><span class="st">"</span></span>
<span><span class="st">m ~ x</span></span>
<span><span class="st">y ~ m + x</span></span>
<span><span class="st">"</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod_es</span> <span class="op">&lt;-</span></span>
<span><span class="st">"</span></span>
<span><span class="st">m ~ x: l</span></span>
<span><span class="st">y ~ m: m</span></span>
<span><span class="st">y ~ x: s</span></span>
<span><span class="st">"</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/power4test.html">power4test</a></span><span class="op">(</span>nrep <span class="op">=</span> <span class="fl">2</span>,</span>
<span>                  model <span class="op">=</span> <span class="va">mod</span>,</span>
<span>                  pop_es <span class="op">=</span> <span class="va">mod_es</span>,</span>
<span>                  n <span class="op">=</span> <span class="fl">50000</span>,</span>
<span>                  iseed <span class="op">=</span> <span class="fl">1234</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">out</span>,</span>
<span>      data_long <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ====================== Model Information ======================</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; == Model on Factors/Variables ==</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; m ~ x</span></span>
<span><span class="co">#&gt; y ~ m + x</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; == Model on Variables/Indicators ==</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; m ~ x</span></span>
<span><span class="co">#&gt; y ~ m + x</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ====== Population Values ======</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Regressions:</span></span>
<span><span class="co">#&gt;                    Population</span></span>
<span><span class="co">#&gt;   m ~                        </span></span>
<span><span class="co">#&gt;     x                 0.500  </span></span>
<span><span class="co">#&gt;   y ~                        </span></span>
<span><span class="co">#&gt;     m                 0.300  </span></span>
<span><span class="co">#&gt;     x                 0.100  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Variances:</span></span>
<span><span class="co">#&gt;                    Population</span></span>
<span><span class="co">#&gt;    .m                 0.750  </span></span>
<span><span class="co">#&gt;    .y                 0.870  </span></span>
<span><span class="co">#&gt;     x                 1.000  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; (Computing indirect effects for 2 paths ...)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; == Population Conditional/Indirect Effect(s) ==</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; == Indirect Effect(s) ==</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;               ind</span></span>
<span><span class="co">#&gt; x -&gt; m -&gt; y 0.150</span></span>
<span><span class="co">#&gt; x -&gt; y      0.100</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  - The 'ind' column shows the indirect effect(s).</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; ======================= Data Information =======================</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of Replications:  2 </span></span>
<span><span class="co">#&gt; Sample Sizes:  50000 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ==== Descriptive Statistics ====</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   vars     n mean sd skew kurtosis se</span></span>
<span><span class="co">#&gt; m    1 1e+05 0.00  1 0.01     0.03  0</span></span>
<span><span class="co">#&gt; y    2 1e+05 0.01  1 0.01     0.00  0</span></span>
<span><span class="co">#&gt; x    3 1e+05 0.00  1 0.01     0.01  0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ===== Parameter Estimates Based on All 2 Samples Combined =====</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Total Sample Size: 100000 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ==== Standardized Estimates ====</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Variances and error variances omitted.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Regressions:</span></span>
<span><span class="co">#&gt;                     est.std</span></span>
<span><span class="co">#&gt;   m ~                      </span></span>
<span><span class="co">#&gt;     x                 0.500</span></span>
<span><span class="co">#&gt;   y ~                      </span></span>
<span><span class="co">#&gt;     m                 0.295</span></span>
<span><span class="co">#&gt;     x                 0.102</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ==================== Extra Element(s) Found ====================</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - fit</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; === Element(s) of the First Dataset ===</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ============ &lt;fit&gt; ============</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; lavaan 0.6-21.2434 ended normally after 1 iteration</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Estimator                                         ML</span></span>
<span><span class="co">#&gt;   Optimization method                           NLMINB</span></span>
<span><span class="co">#&gt;   Number of model parameters                         5</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Number of observations                         50000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model Test User Model:</span></span>
<span><span class="co">#&gt;                                                       </span></span>
<span><span class="co">#&gt;   Test statistic                                 0.000</span></span>
<span><span class="co">#&gt;   Degrees of freedom                                 0</span></span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/power4test.html">power4test</a></span><span class="op">(</span>nrep <span class="op">=</span> <span class="fl">50</span>,</span>
<span>                  model <span class="op">=</span> <span class="va">mod</span>,</span>
<span>                  pop_es <span class="op">=</span> <span class="va">mod_es</span>,</span>
<span>                  n <span class="op">=</span> <span class="fl">100</span>,</span>
<span>                  R <span class="op">=</span> <span class="fl">199</span>,</span>
<span>                  ci_type <span class="op">=</span> <span class="st">"mc"</span>,</span>
<span>                  test_fun <span class="op">=</span> <span class="va">test_indirect_effect</span>,</span>
<span>                  test_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"x"</span>,</span>
<span>                                   m <span class="op">=</span> <span class="st">"m"</span>,</span>
<span>                                   y <span class="op">=</span> <span class="st">"y"</span>,</span>
<span>                                   mc_ci <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>                  iseed <span class="op">=</span> <span class="fl">2345</span>,</span>
<span>                  parallel <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">out</span>,</span>
<span>      test_long <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ====================== Model Information ======================</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; == Model on Factors/Variables ==</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; m ~ x</span></span>
<span><span class="co">#&gt; y ~ m + x</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; == Model on Variables/Indicators ==</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; m ~ x</span></span>
<span><span class="co">#&gt; y ~ m + x</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ====== Population Values ======</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Regressions:</span></span>
<span><span class="co">#&gt;                    Population</span></span>
<span><span class="co">#&gt;   m ~                        </span></span>
<span><span class="co">#&gt;     x                 0.500  </span></span>
<span><span class="co">#&gt;   y ~                        </span></span>
<span><span class="co">#&gt;     m                 0.300  </span></span>
<span><span class="co">#&gt;     x                 0.100  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Variances:</span></span>
<span><span class="co">#&gt;                    Population</span></span>
<span><span class="co">#&gt;    .m                 0.750  </span></span>
<span><span class="co">#&gt;    .y                 0.870  </span></span>
<span><span class="co">#&gt;     x                 1.000  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; (Computing indirect effects for 2 paths ...)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; == Population Conditional/Indirect Effect(s) ==</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; == Indirect Effect(s) ==</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;               ind</span></span>
<span><span class="co">#&gt; x -&gt; m -&gt; y 0.150</span></span>
<span><span class="co">#&gt; x -&gt; y      0.100</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  - The 'ind' column shows the indirect effect(s).</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; ======================= Data Information =======================</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of Replications:  50 </span></span>
<span><span class="co">#&gt; Sample Sizes:  100 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call print with 'data_long = TRUE' for further information.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ==================== Extra Element(s) Found ====================</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - fit</span></span>
<span><span class="co">#&gt; - mc_out</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; === Element(s) of the First Dataset ===</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ============ &lt;fit&gt; ============</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; lavaan 0.6-21.2434 ended normally after 1 iteration</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Estimator                                         ML</span></span>
<span><span class="co">#&gt;   Optimization method                           NLMINB</span></span>
<span><span class="co">#&gt;   Number of model parameters                         5</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Number of observations                           100</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model Test User Model:</span></span>
<span><span class="co">#&gt;                                                       </span></span>
<span><span class="co">#&gt;   Test statistic                                 0.000</span></span>
<span><span class="co">#&gt;   Degrees of freedom                                 0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; =========== &lt;mc_out&gt; ===========</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; == A 'mc_out' class object ==</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of Monte Carlo replications: 199 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; =============== &lt;test_indirect: x-&gt;m-&gt;y&gt; ===============</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Mean(s) across replication:</span></span>
<span><span class="co">#&gt;    est  cilo  cihi   sig</span></span>
<span><span class="co">#&gt;  0.149 0.037 0.284 0.800</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - The value 'sig' is the rejection rate.</span></span>
<span><span class="co">#&gt; - If the null hypothesis is false, this is the power.</span></span>
<span><span class="co">#&gt; - Number of valid replications for rejection rate: 50 </span></span>
<span><span class="co">#&gt; - Proportion of valid replications for rejection rate: 1.000</span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out_n</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/x_from_power.html">n_from_power</a></span><span class="op">(</span><span class="va">out</span>,</span>
<span>                      what <span class="op">=</span> <span class="st">"ub"</span>,</span>
<span>                      seed <span class="op">=</span> <span class="fl">4567</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out_n</span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; power4mome::x_from_power(object = out, x = "n", what = "ub", </span></span>
<span><span class="co">#&gt;     goal = "close_enough", final_nrep = 50, final_R = 199, seed = 4567)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                           Setting</span></span>
<span><span class="co">#&gt; Predictor(x):         Sample Size</span></span>
<span><span class="co">#&gt; Parameter:                    N/A</span></span>
<span><span class="co">#&gt; goal:                close_enough</span></span>
<span><span class="co">#&gt; what:                          ub</span></span>
<span><span class="co">#&gt; algorithm:              bisection</span></span>
<span><span class="co">#&gt; Level of confidence:       95.00%</span></span>
<span><span class="co">#&gt; Target Power:               0.800</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - Final Value of Sample Size (n): 88</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - Final Estimated Power (CI): 0.680 [0.542, 0.792]</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call `summary()` for detailed results.</span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">out_n</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ====== x_from_power Results ======</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; x_from_power(object = out, x = "n", what = "ub", goal = "close_enough", </span></span>
<span><span class="co">#&gt;     final_nrep = 50, final_R = 199, seed = 4567)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Predictor (x): Sample Size </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - Target Power: 0.800 </span></span>
<span><span class="co">#&gt; - Goal: Find 'x' with estimated upper confidence bound close enough to</span></span>
<span><span class="co">#&gt;   the target power.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; === Major Results ===</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - Final Value (Sample Size): 88</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - Final Estimated Power: 0.680 </span></span>
<span><span class="co">#&gt; - Confidence Interval: [0.542; 0.792]</span></span>
<span><span class="co">#&gt; - Level of confidence: 95.0%</span></span>
<span><span class="co">#&gt; - Based on 50 replications.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; === Technical Information ===</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - Algorithm: bisection </span></span>
<span><span class="co">#&gt; - Tolerance for 'close enough': Within 0.02000 of 0.800 </span></span>
<span><span class="co">#&gt; - The range of values explored: 100 to 88 </span></span>
<span><span class="co">#&gt; - Time spent in the search: 16.02 secs </span></span>
<span><span class="co">#&gt; - The final crude model for the power-predictor relation:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model Type: Logistic Regression </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; power_curve(object = by_x_1, formula = power_model, start = power_curve_start, </span></span>
<span><span class="co">#&gt;     lower_bound = lower_bound, upper_bound = upper_bound, nls_args = nls_args, </span></span>
<span><span class="co">#&gt;     nls_control = nls_control, verbose = progress)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Predictor: n (Sample Size)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:  stats::glm(formula = reject ~ x, family = "binomial", data = reject1)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt; (Intercept)            x  </span></span>
<span><span class="co">#&gt;    -1.98127      0.03233  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Degrees of Freedom: 199 Total (i.e. Null);  198 Residual</span></span>
<span><span class="co">#&gt; Null Deviance:       264.6 </span></span>
<span><span class="co">#&gt; Residual Deviance: 248.4     AIC: 252.4</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - Detailed Results:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [test]: test_indirect: x-&gt;m-&gt;y </span></span>
<span><span class="co">#&gt; [test_label]: Test </span></span>
<span><span class="co">#&gt;     n   est   p.v reject r.cilo r.cihi</span></span>
<span><span class="co">#&gt; 1  50 0.145 1.000  0.420  0.294  0.558</span></span>
<span><span class="co">#&gt; 2  75 0.143 1.000  0.600  0.462  0.724</span></span>
<span><span class="co">#&gt; 3  88 0.163 1.000  0.680  0.542  0.792</span></span>
<span><span class="co">#&gt; 4 100 0.149 1.000  0.800  0.670  0.888</span></span>
<span><span class="co">#&gt; Notes:</span></span>
<span><span class="co">#&gt; - n: The sample size in a trial.</span></span>
<span><span class="co">#&gt; - p.v: The proportion of valid replications.</span></span>
<span><span class="co">#&gt; - est: The mean of the estimates in a test across replications.</span></span>
<span><span class="co">#&gt; - reject: The proportion of 'significant' replications, that is, the</span></span>
<span><span class="co">#&gt;   rejection rate. If the null hypothesis is true, this is the Type I</span></span>
<span><span class="co">#&gt;   error rate. If the null hypothesis is false, this is the power.</span></span>
<span><span class="co">#&gt; - r.cilo,r.cihi: The confidence interval of the rejection rate, based</span></span>
<span><span class="co">#&gt;   on Wilson's (1927) method.</span></span>
<span><span class="co">#&gt; - Refer to the tests for the meanings of other columns.</span></span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">out_n</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="x_from_power_for_n_plot_test-1.png" alt="The Power Curve"><p class="caption">
The Power Curve
</p>
</div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out_n_lb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/x_from_power.html">n_from_power</a></span><span class="op">(</span><span class="va">out</span>,</span>
<span>                         what <span class="op">=</span> <span class="st">"lb"</span>,</span>
<span>                         seed <span class="op">=</span> <span class="fl">2345</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out_n_lb</span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; power4mome::x_from_power(object = out, x = "n", what = "lb", </span></span>
<span><span class="co">#&gt;     goal = "close_enough", final_nrep = 50, final_R = 199, seed = 2345)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                           Setting</span></span>
<span><span class="co">#&gt; Predictor(x):         Sample Size</span></span>
<span><span class="co">#&gt; Parameter:                    N/A</span></span>
<span><span class="co">#&gt; goal:                close_enough</span></span>
<span><span class="co">#&gt; what:                          lb</span></span>
<span><span class="co">#&gt; algorithm:              bisection</span></span>
<span><span class="co">#&gt; Level of confidence:       95.00%</span></span>
<span><span class="co">#&gt; Target Power:               0.800</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - Final Value of Sample Size (n): 149</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - Final Estimated Power (CI): 0.920 [0.812, 0.968]</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call `summary()` for detailed results.</span></span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">out_n_lb</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ====== x_from_power Results ======</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; x_from_power(object = out, x = "n", what = "lb", goal = "close_enough", </span></span>
<span><span class="co">#&gt;     final_nrep = 50, final_R = 199, seed = 2345)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Predictor (x): Sample Size </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - Target Power: 0.800 </span></span>
<span><span class="co">#&gt; - Goal: Find 'x' with estimated lower confidence bound close enough to</span></span>
<span><span class="co">#&gt;   the target power.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; === Major Results ===</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - Final Value (Sample Size): 149</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - Final Estimated Power: 0.920 </span></span>
<span><span class="co">#&gt; - Confidence Interval: [0.812; 0.968]</span></span>
<span><span class="co">#&gt; - Level of confidence: 95.0%</span></span>
<span><span class="co">#&gt; - Based on 50 replications.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; === Technical Information ===</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - Algorithm: bisection </span></span>
<span><span class="co">#&gt; - Tolerance for 'close enough': Within 0.02000 of 0.800 </span></span>
<span><span class="co">#&gt; - The range of values explored: 100 to 50 </span></span>
<span><span class="co">#&gt; - Time spent in the search: 26.44 secs </span></span>
<span><span class="co">#&gt; - The final crude model for the power-predictor relation:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model Type: Logistic Regression </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; power_curve(object = by_x_1, formula = power_model, start = power_curve_start, </span></span>
<span><span class="co">#&gt;     lower_bound = lower_bound, upper_bound = upper_bound, nls_args = nls_args, </span></span>
<span><span class="co">#&gt;     nls_control = nls_control, verbose = progress)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Predictor: n (Sample Size)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:  stats::glm(formula = reject ~ x, family = "binomial", data = reject1)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt; (Intercept)            x  </span></span>
<span><span class="co">#&gt;    -1.58617      0.02743  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Degrees of Freedom: 299 Total (i.e. Null);  298 Residual</span></span>
<span><span class="co">#&gt; Null Deviance:       279.8 </span></span>
<span><span class="co">#&gt; Residual Deviance: 220.2     AIC: 224.2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - Detailed Results:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [test]: test_indirect: x-&gt;m-&gt;y </span></span>
<span><span class="co">#&gt; [test_label]: Test </span></span>
<span><span class="co">#&gt;     n   est   p.v reject r.cilo r.cihi</span></span>
<span><span class="co">#&gt; 1  50 0.147 1.000  0.440  0.312  0.577</span></span>
<span><span class="co">#&gt; 2 100 0.149 1.000  0.800  0.670  0.888</span></span>
<span><span class="co">#&gt; 3 139 0.148 1.000  0.840  0.715  0.917</span></span>
<span><span class="co">#&gt; 4 149 0.148 1.000  0.920  0.812  0.968</span></span>
<span><span class="co">#&gt; 5 159 0.161 1.000  0.960  0.865  0.989</span></span>
<span><span class="co">#&gt; 6 178 0.139 1.000  0.980  0.895  0.996</span></span>
<span><span class="co">#&gt; Notes:</span></span>
<span><span class="co">#&gt; - n: The sample size in a trial.</span></span>
<span><span class="co">#&gt; - p.v: The proportion of valid replications.</span></span>
<span><span class="co">#&gt; - est: The mean of the estimates in a test across replications.</span></span>
<span><span class="co">#&gt; - reject: The proportion of 'significant' replications, that is, the</span></span>
<span><span class="co">#&gt;   rejection rate. If the null hypothesis is true, this is the Type I</span></span>
<span><span class="co">#&gt;   error rate. If the null hypothesis is false, this is the power.</span></span>
<span><span class="co">#&gt; - r.cilo,r.cihi: The confidence interval of the rejection rate, based</span></span>
<span><span class="co">#&gt;   on Wilson's (1927) method.</span></span>
<span><span class="co">#&gt; - Refer to the tests for the meanings of other columns.</span></span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">out_n_lb</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="x_from_power_for_n_lb_plot_test-1.png" alt="The Power Curve"><p class="caption">
The Power Curve
</p>
</div>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n_power_region</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/x_from_power.html">n_region_from_power</a></span><span class="op">(</span><span class="va">out</span>,</span>
<span>                                      seed <span class="op">=</span> <span class="fl">2468</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; --- Phase 1 ---</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Find the approximate region with power significantly below 0.8 ...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; --- Setting ---</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Algorithm:  bisection </span></span>
<span><span class="co">#&gt; Goal:  close_enough </span></span>
<span><span class="co">#&gt; What:  ub   (Upper bound of the confidence interval) </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; --- Progress  ---</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - Set 'progress = FALSE' to suppress displaying the progress.</span></span>
<span><span class="co">#&gt; - Set 'simulation progress = FALSE' to suppress displaying the progress</span></span>
<span><span class="co">#&gt;   in the simulation.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Initial interval: [50, 100] </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Do the simulation for the lower bound:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Try x = 50 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Updating the simulation for sample size: 50 </span></span>
<span><span class="co">#&gt; Re-simulate the data:</span></span>
<span><span class="co">#&gt; Fit the model(s):</span></span>
<span><span class="co">#&gt; Generate Monte Carlo estimates:</span></span>
<span><span class="co">#&gt; Update the test(s):</span></span>
<span><span class="co">#&gt; Update test_indirect: x-&gt;m-&gt;y :</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Estimated power at n: 0.460, 95.0% confidence interval: [0.330,0.596]</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Initial interval: [50, 100] </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - Rejection Rates:</span></span>
<span><span class="co">#&gt; [test]: test_indirect: x-&gt;m-&gt;y </span></span>
<span><span class="co">#&gt; [test_label]: Test </span></span>
<span><span class="co">#&gt;     n   est   p.v reject r.cilo r.cihi</span></span>
<span><span class="co">#&gt; 1  50 0.140 1.000  0.460  0.330  0.596</span></span>
<span><span class="co">#&gt; 2 100 0.149 1.000  0.800  0.670  0.888</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; == Enter extending interval ...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; == Exit extending interval ...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Iteration # 1 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Try x = 75 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Updating the simulation for sample size: 75 </span></span>
<span><span class="co">#&gt; Re-simulate the data:</span></span>
<span><span class="co">#&gt; Fit the model(s):</span></span>
<span><span class="co">#&gt; Generate Monte Carlo estimates:</span></span>
<span><span class="co">#&gt; Update the test(s):</span></span>
<span><span class="co">#&gt; Update test_indirect: x-&gt;m-&gt;y :</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Estimated power at n: 0.660, 95.0% confidence interval: [0.522,0.776]</span></span>
<span><span class="co">#&gt; - Rejection Rates:</span></span>
<span><span class="co">#&gt; [test]: test_indirect: x-&gt;m-&gt;y </span></span>
<span><span class="co">#&gt; [test_label]: Test </span></span>
<span><span class="co">#&gt;     n   est   p.v reject r.cilo r.cihi</span></span>
<span><span class="co">#&gt; 1  50 0.140 1.000  0.460  0.330  0.596</span></span>
<span><span class="co">#&gt; 2  75 0.154 1.000  0.660  0.522  0.776</span></span>
<span><span class="co">#&gt; 3 100 0.149 1.000  0.800  0.670  0.888</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; New interval: [75, 100] </span></span>
<span><span class="co">#&gt; Updated x: 88 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Iteration # 2 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Try x = 88 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Updating the simulation for sample size: 88 </span></span>
<span><span class="co">#&gt; Re-simulate the data:</span></span>
<span><span class="co">#&gt; Fit the model(s):</span></span>
<span><span class="co">#&gt; Generate Monte Carlo estimates:</span></span>
<span><span class="co">#&gt; Update the test(s):</span></span>
<span><span class="co">#&gt; Update test_indirect: x-&gt;m-&gt;y :</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Estimated power at n: 0.700, 95.0% confidence interval: [0.562,0.809]</span></span>
<span><span class="co">#&gt; - Rejection Rates:</span></span>
<span><span class="co">#&gt; [test]: test_indirect: x-&gt;m-&gt;y </span></span>
<span><span class="co">#&gt; [test_label]: Test </span></span>
<span><span class="co">#&gt;     n   est   p.v reject r.cilo r.cihi</span></span>
<span><span class="co">#&gt; 1  50 0.140 1.000  0.460  0.330  0.596</span></span>
<span><span class="co">#&gt; 2  75 0.154 1.000  0.660  0.522  0.776</span></span>
<span><span class="co">#&gt; 3  88 0.151 1.000  0.700  0.562  0.809</span></span>
<span><span class="co">#&gt; 4 100 0.149 1.000  0.800  0.670  0.888</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - 'nls()' estimation failed. Switch to logistic regression.</span></span>
<span><span class="co">#&gt; Solution found.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; --- Final Stage ---</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - Start at 2025-12-13 17:53:23 </span></span>
<span><span class="co">#&gt; - Rejection Rates:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [test]: test_indirect: x-&gt;m-&gt;y </span></span>
<span><span class="co">#&gt; [test_label]: Test </span></span>
<span><span class="co">#&gt;     n   est   p.v reject r.cilo r.cihi</span></span>
<span><span class="co">#&gt; 1  50 0.140 1.000  0.460  0.330  0.596</span></span>
<span><span class="co">#&gt; 2  75 0.154 1.000  0.660  0.522  0.776</span></span>
<span><span class="co">#&gt; 3  88 0.151 1.000  0.700  0.562  0.809</span></span>
<span><span class="co">#&gt; 4 100 0.149 1.000  0.800  0.670  0.888</span></span>
<span><span class="co">#&gt; Notes:</span></span>
<span><span class="co">#&gt; - n: The sample size in a trial.</span></span>
<span><span class="co">#&gt; - p.v: The proportion of valid replications.</span></span>
<span><span class="co">#&gt; - est: The mean of the estimates in a test across replications.</span></span>
<span><span class="co">#&gt; - reject: The proportion of 'significant' replications, that is, the</span></span>
<span><span class="co">#&gt;   rejection rate. If the null hypothesis is true, this is the Type I</span></span>
<span><span class="co">#&gt;   error rate. If the null hypothesis is false, this is the power.</span></span>
<span><span class="co">#&gt; - r.cilo,r.cihi: The confidence interval of the rejection rate, based</span></span>
<span><span class="co">#&gt;   on Wilson's (1927) method.</span></span>
<span><span class="co">#&gt; - Refer to the tests for the meanings of other columns.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - Estimated Power Curve:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; power_curve(object = by_x_1, formula = power_model, start = power_curve_start, </span></span>
<span><span class="co">#&gt;     lower_bound = lower_bound, upper_bound = upper_bound, nls_args = nls_args, </span></span>
<span><span class="co">#&gt;     nls_control = nls_control, verbose = progress)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Predictor: n (Sample Size)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:  stats::glm(formula = reject ~ x, family = "binomial", data = reject1)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt; (Intercept)            x  </span></span>
<span><span class="co">#&gt;    -1.62200      0.02945  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Degrees of Freedom: 199 Total (i.e. Null);  198 Residual</span></span>
<span><span class="co">#&gt; Null Deviance:       257.7 </span></span>
<span><span class="co">#&gt; Residual Deviance: 244.5     AIC: 248.5</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - Final Value: 88 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - Final Estimated Power: 0.7000 </span></span>
<span><span class="co">#&gt; - Confidence Interval: [0.5625; 0.8090]</span></span>
<span><span class="co">#&gt; - CI Level: 95.00%</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; --- Phase 2 ---</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Find the approximate region with power significantly above 0.8 ...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; --- Setting ---</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Algorithm:  bisection </span></span>
<span><span class="co">#&gt; Goal:  close_enough </span></span>
<span><span class="co">#&gt; What:  lb   (Lower bound of the confidence interval) </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; --- Progress  ---</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - Set 'progress = FALSE' to suppress displaying the progress.</span></span>
<span><span class="co">#&gt; - Set 'simulation progress = FALSE' to suppress displaying the progress</span></span>
<span><span class="co">#&gt;   in the simulation.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Initial interval: [100, 120] </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Do the simulation for the upper bound:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Try x = 120 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Updating the simulation for sample size: 120 </span></span>
<span><span class="co">#&gt; Re-simulate the data:</span></span>
<span><span class="co">#&gt; Fit the model(s):</span></span>
<span><span class="co">#&gt; Generate Monte Carlo estimates:</span></span>
<span><span class="co">#&gt; Update the test(s):</span></span>
<span><span class="co">#&gt; Update test_indirect: x-&gt;m-&gt;y :</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Estimated power at n: 0.840, 95.0% confidence interval: [0.715,0.917]</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Initial interval: [100, 120] </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - Rejection Rates:</span></span>
<span><span class="co">#&gt; [test]: test_indirect: x-&gt;m-&gt;y </span></span>
<span><span class="co">#&gt; [test_label]: Test </span></span>
<span><span class="co">#&gt;     n   est   p.v reject r.cilo r.cihi</span></span>
<span><span class="co">#&gt; 1  50 0.140 1.000  0.460  0.330  0.596</span></span>
<span><span class="co">#&gt; 2  75 0.154 1.000  0.660  0.522  0.776</span></span>
<span><span class="co">#&gt; 3  88 0.151 1.000  0.700  0.562  0.809</span></span>
<span><span class="co">#&gt; 4 100 0.149 1.000  0.800  0.670  0.888</span></span>
<span><span class="co">#&gt; 5 120 0.139 1.000  0.840  0.715  0.917</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; == Enter extending interval ...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Interval below the solution. Extend the upper bound ...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Try x = 237 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Updating the simulation for sample size: 237 </span></span>
<span><span class="co">#&gt; Re-simulate the data:</span></span>
<span><span class="co">#&gt; Fit the model(s):</span></span>
<span><span class="co">#&gt; Generate Monte Carlo estimates:</span></span>
<span><span class="co">#&gt; Update the test(s):</span></span>
<span><span class="co">#&gt; Update test_indirect: x-&gt;m-&gt;y :</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Estimated power at n: 0.980, 95.0% confidence interval: [0.895,0.996]</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; (Extending the interval) Iteration: 1 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; New interval: [120, 237] </span></span>
<span><span class="co">#&gt; Interval OK.</span></span>
<span><span class="co">#&gt; Final extended interval: [120, 237] </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; == Exit extending interval ...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Iteration # 1 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Try x = 179 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Updating the simulation for sample size: 179 </span></span>
<span><span class="co">#&gt; Re-simulate the data:</span></span>
<span><span class="co">#&gt; Fit the model(s):</span></span>
<span><span class="co">#&gt; Generate Monte Carlo estimates:</span></span>
<span><span class="co">#&gt; Update the test(s):</span></span>
<span><span class="co">#&gt; Update test_indirect: x-&gt;m-&gt;y :</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Estimated power at n: 0.940, 95.0% confidence interval: [0.838,0.979]</span></span>
<span><span class="co">#&gt; - Rejection Rates:</span></span>
<span><span class="co">#&gt; [test]: test_indirect: x-&gt;m-&gt;y </span></span>
<span><span class="co">#&gt; [test_label]: Test </span></span>
<span><span class="co">#&gt;     n   est   p.v reject r.cilo r.cihi</span></span>
<span><span class="co">#&gt; 1  50 0.140 1.000  0.460  0.330  0.596</span></span>
<span><span class="co">#&gt; 2  75 0.154 1.000  0.660  0.522  0.776</span></span>
<span><span class="co">#&gt; 3  88 0.151 1.000  0.700  0.562  0.809</span></span>
<span><span class="co">#&gt; 4 100 0.149 1.000  0.800  0.670  0.888</span></span>
<span><span class="co">#&gt; 5 120 0.139 1.000  0.840  0.715  0.917</span></span>
<span><span class="co">#&gt; 6 179 0.153 1.000  0.940  0.838  0.979</span></span>
<span><span class="co">#&gt; 7 237 0.148 1.000  0.980  0.895  0.996</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; New interval: [120, 179] </span></span>
<span><span class="co">#&gt; Updated x: 150 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Iteration # 2 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Try x = 150 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Updating the simulation for sample size: 150 </span></span>
<span><span class="co">#&gt; Re-simulate the data:</span></span>
<span><span class="co">#&gt; Fit the model(s):</span></span>
<span><span class="co">#&gt; Generate Monte Carlo estimates:</span></span>
<span><span class="co">#&gt; Update the test(s):</span></span>
<span><span class="co">#&gt; Update test_indirect: x-&gt;m-&gt;y :</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Estimated power at n: 0.900, 95.0% confidence interval: [0.786,0.957]</span></span>
<span><span class="co">#&gt; - Rejection Rates:</span></span>
<span><span class="co">#&gt; [test]: test_indirect: x-&gt;m-&gt;y </span></span>
<span><span class="co">#&gt; [test_label]: Test </span></span>
<span><span class="co">#&gt;     n   est   p.v reject r.cilo r.cihi</span></span>
<span><span class="co">#&gt; 1  50 0.140 1.000  0.460  0.330  0.596</span></span>
<span><span class="co">#&gt; 2  75 0.154 1.000  0.660  0.522  0.776</span></span>
<span><span class="co">#&gt; 3  88 0.151 1.000  0.700  0.562  0.809</span></span>
<span><span class="co">#&gt; 4 100 0.149 1.000  0.800  0.670  0.888</span></span>
<span><span class="co">#&gt; 5 120 0.139 1.000  0.840  0.715  0.917</span></span>
<span><span class="co">#&gt; 6 150 0.135 1.000  0.900  0.786  0.957</span></span>
<span><span class="co">#&gt; 7 179 0.153 1.000  0.940  0.838  0.979</span></span>
<span><span class="co">#&gt; 8 237 0.148 1.000  0.980  0.895  0.996</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - 'nls()' estimation failed. Switch to logistic regression.</span></span>
<span><span class="co">#&gt; Solution found.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; --- Final Stage ---</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - Start at 2025-12-13 17:53:44 </span></span>
<span><span class="co">#&gt; - Rejection Rates:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [test]: test_indirect: x-&gt;m-&gt;y </span></span>
<span><span class="co">#&gt; [test_label]: Test </span></span>
<span><span class="co">#&gt;     n   est   p.v reject r.cilo r.cihi</span></span>
<span><span class="co">#&gt; 1  50 0.140 1.000  0.460  0.330  0.596</span></span>
<span><span class="co">#&gt; 2  75 0.154 1.000  0.660  0.522  0.776</span></span>
<span><span class="co">#&gt; 3  88 0.151 1.000  0.700  0.562  0.809</span></span>
<span><span class="co">#&gt; 4 100 0.149 1.000  0.800  0.670  0.888</span></span>
<span><span class="co">#&gt; 5 120 0.139 1.000  0.840  0.715  0.917</span></span>
<span><span class="co">#&gt; 6 150 0.135 1.000  0.900  0.786  0.957</span></span>
<span><span class="co">#&gt; 7 179 0.153 1.000  0.940  0.838  0.979</span></span>
<span><span class="co">#&gt; 8 237 0.148 1.000  0.980  0.895  0.996</span></span>
<span><span class="co">#&gt; Notes:</span></span>
<span><span class="co">#&gt; - n: The sample size in a trial.</span></span>
<span><span class="co">#&gt; - p.v: The proportion of valid replications.</span></span>
<span><span class="co">#&gt; - est: The mean of the estimates in a test across replications.</span></span>
<span><span class="co">#&gt; - reject: The proportion of 'significant' replications, that is, the</span></span>
<span><span class="co">#&gt;   rejection rate. If the null hypothesis is true, this is the Type I</span></span>
<span><span class="co">#&gt;   error rate. If the null hypothesis is false, this is the power.</span></span>
<span><span class="co">#&gt; - r.cilo,r.cihi: The confidence interval of the rejection rate, based</span></span>
<span><span class="co">#&gt;   on Wilson's (1927) method.</span></span>
<span><span class="co">#&gt; - Refer to the tests for the meanings of other columns.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - Estimated Power Curve:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; power_curve(object = by_x_1, formula = power_model, start = power_curve_start, </span></span>
<span><span class="co">#&gt;     lower_bound = lower_bound, upper_bound = upper_bound, nls_args = nls_args, </span></span>
<span><span class="co">#&gt;     nls_control = nls_control, verbose = progress)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Predictor: n (Sample Size)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:  stats::glm(formula = reject ~ x, family = "binomial", data = reject1)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt; (Intercept)            x  </span></span>
<span><span class="co">#&gt;    -1.12062      0.02264  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Degrees of Freedom: 399 Total (i.e. Null);  398 Residual</span></span>
<span><span class="co">#&gt; Null Deviance:       416.4 </span></span>
<span><span class="co">#&gt; Residual Deviance: 354.4     AIC: 358.4</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - Final Value: 150 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - Final Estimated Power: 0.9000 </span></span>
<span><span class="co">#&gt; - Confidence Interval: [0.7864; 0.9565]</span></span>
<span><span class="co">#&gt; - CI Level: 95.00%</span></span>
<span><span class="va">n_power_region</span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; n_region_from_power(object = out, seed = 2468)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                      Setting                                      </span></span>
<span><span class="co">#&gt; Predictor(x)         Sample Size                                  </span></span>
<span><span class="co">#&gt; Goal:                Power significantly below or above the target</span></span>
<span><span class="co">#&gt; algorithm:           bisection                                    </span></span>
<span><span class="co">#&gt; Level of confidence: 95.00%                                       </span></span>
<span><span class="co">#&gt; Target Power:        0.800                                        </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Solution: </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Approximate region of sample sizes with power:</span></span>
<span><span class="co">#&gt; - not significantly different from 0.800: 88 to 150</span></span>
<span><span class="co">#&gt; - significantly lower than 0.800: 88</span></span>
<span><span class="co">#&gt; - significantly higher than 0.800: 150</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Confidence intervals of the estimated power:</span></span>
<span><span class="co">#&gt; - for the lower bound (88): [0.562, 0.809]</span></span>
<span><span class="co">#&gt; - for the upper bound (150): [0.786, 0.957]</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call `summary()` for detailed results.</span></span></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">n_power_region</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="region_plot-1.png" alt="The Power Curve (Region)"><p class="caption">
The Power Curve (Region)
</p>
</div>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n_power_region2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/x_from_power.html">n_region_from_power</a></span><span class="op">(</span><span class="va">out_n_lb</span>,</span>
<span>                                      seed <span class="op">=</span> <span class="fl">24680</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; --- Phase 1 ---</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Find the approximate region with power significantly below 0.8 ...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; --- Setting ---</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Algorithm:  bisection </span></span>
<span><span class="co">#&gt; Goal:  close_enough </span></span>
<span><span class="co">#&gt; What:  ub   (Upper bound of the confidence interval) </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; --- Progress  ---</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - Set 'progress = FALSE' to suppress displaying the progress.</span></span>
<span><span class="co">#&gt; - Set 'simulation progress = FALSE' to suppress displaying the progress</span></span>
<span><span class="co">#&gt;   in the simulation.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Initial interval: [50, 100] </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Initial interval: [50, 100] </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - Rejection Rates:</span></span>
<span><span class="co">#&gt; [test]: test_indirect: x-&gt;m-&gt;y </span></span>
<span><span class="co">#&gt; [test_label]: Test </span></span>
<span><span class="co">#&gt;     n   est   p.v reject r.cilo r.cihi</span></span>
<span><span class="co">#&gt; 1  50 0.147 1.000  0.440  0.312  0.577</span></span>
<span><span class="co">#&gt; 2 100 0.149 1.000  0.800  0.670  0.888</span></span>
<span><span class="co">#&gt; 3 139 0.148 1.000  0.840  0.715  0.917</span></span>
<span><span class="co">#&gt; 4 149 0.148 1.000  0.920  0.812  0.968</span></span>
<span><span class="co">#&gt; 5 159 0.161 1.000  0.960  0.865  0.989</span></span>
<span><span class="co">#&gt; 6 178 0.139 1.000  0.980  0.895  0.996</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; == Enter extending interval ...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; == Exit extending interval ...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Iteration # 1 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Try x = 75 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Updating the simulation for sample size: 75 </span></span>
<span><span class="co">#&gt; Re-simulate the data:</span></span>
<span><span class="co">#&gt; Fit the model(s):</span></span>
<span><span class="co">#&gt; Generate Monte Carlo estimates:</span></span>
<span><span class="co">#&gt; Update the test(s):</span></span>
<span><span class="co">#&gt; Update test_indirect: x-&gt;m-&gt;y :</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Estimated power at n: 0.680, 95.0% confidence interval: [0.542,0.792]</span></span>
<span><span class="co">#&gt; - Rejection Rates:</span></span>
<span><span class="co">#&gt; [test]: test_indirect: x-&gt;m-&gt;y </span></span>
<span><span class="co">#&gt; [test_label]: Test </span></span>
<span><span class="co">#&gt;     n   est   p.v reject r.cilo r.cihi</span></span>
<span><span class="co">#&gt; 1  50 0.147 1.000  0.440  0.312  0.577</span></span>
<span><span class="co">#&gt; 2  75 0.147 1.000  0.680  0.542  0.792</span></span>
<span><span class="co">#&gt; 3 100 0.149 1.000  0.800  0.670  0.888</span></span>
<span><span class="co">#&gt; 4 139 0.148 1.000  0.840  0.715  0.917</span></span>
<span><span class="co">#&gt; 5 149 0.148 1.000  0.920  0.812  0.968</span></span>
<span><span class="co">#&gt; 6 159 0.161 1.000  0.960  0.865  0.989</span></span>
<span><span class="co">#&gt; 7 178 0.139 1.000  0.980  0.895  0.996</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - 'nls()' estimation failed. Switch to logistic regression.</span></span>
<span><span class="co">#&gt; Solution found.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; --- Final Stage ---</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - Start at 2025-12-13 17:53:50 </span></span>
<span><span class="co">#&gt; - Rejection Rates:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [test]: test_indirect: x-&gt;m-&gt;y </span></span>
<span><span class="co">#&gt; [test_label]: Test </span></span>
<span><span class="co">#&gt;     n   est   p.v reject r.cilo r.cihi</span></span>
<span><span class="co">#&gt; 1  50 0.147 1.000  0.440  0.312  0.577</span></span>
<span><span class="co">#&gt; 2  75 0.147 1.000  0.680  0.542  0.792</span></span>
<span><span class="co">#&gt; 3 100 0.149 1.000  0.800  0.670  0.888</span></span>
<span><span class="co">#&gt; 4 139 0.148 1.000  0.840  0.715  0.917</span></span>
<span><span class="co">#&gt; 5 149 0.148 1.000  0.920  0.812  0.968</span></span>
<span><span class="co">#&gt; 6 159 0.161 1.000  0.960  0.865  0.989</span></span>
<span><span class="co">#&gt; 7 178 0.139 1.000  0.980  0.895  0.996</span></span>
<span><span class="co">#&gt; Notes:</span></span>
<span><span class="co">#&gt; - n: The sample size in a trial.</span></span>
<span><span class="co">#&gt; - p.v: The proportion of valid replications.</span></span>
<span><span class="co">#&gt; - est: The mean of the estimates in a test across replications.</span></span>
<span><span class="co">#&gt; - reject: The proportion of 'significant' replications, that is, the</span></span>
<span><span class="co">#&gt;   rejection rate. If the null hypothesis is true, this is the Type I</span></span>
<span><span class="co">#&gt;   error rate. If the null hypothesis is false, this is the power.</span></span>
<span><span class="co">#&gt; - r.cilo,r.cihi: The confidence interval of the rejection rate, based</span></span>
<span><span class="co">#&gt;   on Wilson's (1927) method.</span></span>
<span><span class="co">#&gt; - Refer to the tests for the meanings of other columns.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - Estimated Power Curve:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; power_curve(object = by_x_1, formula = power_model, start = power_curve_start, </span></span>
<span><span class="co">#&gt;     lower_bound = lower_bound, upper_bound = upper_bound, nls_args = nls_args, </span></span>
<span><span class="co">#&gt;     nls_control = nls_control, verbose = progress)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Predictor: n (Sample Size)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:  stats::glm(formula = reject ~ x, family = "binomial", data = reject1)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt; (Intercept)            x  </span></span>
<span><span class="co">#&gt;    -1.43578      0.02659  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Degrees of Freedom: 349 Total (i.e. Null);  348 Residual</span></span>
<span><span class="co">#&gt; Null Deviance:       347.5 </span></span>
<span><span class="co">#&gt; Residual Deviance: 283.5     AIC: 287.5</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - Final Value: 75 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - Final Estimated Power: 0.6800 </span></span>
<span><span class="co">#&gt; - Confidence Interval: [0.5419; 0.7924]</span></span>
<span><span class="co">#&gt; - CI Level: 95.00%</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; --- Phase 2 ---</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Find the approximate region with power significantly above 0.8 ...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; --- Setting ---</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Algorithm:  bisection </span></span>
<span><span class="co">#&gt; Goal:  close_enough </span></span>
<span><span class="co">#&gt; What:  lb   (Lower bound of the confidence interval) </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; --- Progress  ---</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - Set 'progress = FALSE' to suppress displaying the progress.</span></span>
<span><span class="co">#&gt; - Set 'simulation progress = FALSE' to suppress displaying the progress</span></span>
<span><span class="co">#&gt;   in the simulation.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; --- Solution Already Found ---</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Solution already found in the object. Search will be skipped.</span></span>
<span><span class="co">#&gt; - 'nls()' estimation failed. Switch to logistic regression.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; --- Final Stage ---</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - Start at 2025-12-13 17:53:50 </span></span>
<span><span class="co">#&gt; - Rejection Rates:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [test]: test_indirect: x-&gt;m-&gt;y </span></span>
<span><span class="co">#&gt; [test_label]: Test </span></span>
<span><span class="co">#&gt;     n   est   p.v reject r.cilo r.cihi</span></span>
<span><span class="co">#&gt; 1  50 0.147 1.000  0.440  0.312  0.577</span></span>
<span><span class="co">#&gt; 2  75 0.147 1.000  0.680  0.542  0.792</span></span>
<span><span class="co">#&gt; 3 100 0.149 1.000  0.800  0.670  0.888</span></span>
<span><span class="co">#&gt; 4 139 0.148 1.000  0.840  0.715  0.917</span></span>
<span><span class="co">#&gt; 5 149 0.148 1.000  0.920  0.812  0.968</span></span>
<span><span class="co">#&gt; 6 159 0.161 1.000  0.960  0.865  0.989</span></span>
<span><span class="co">#&gt; 7 178 0.139 1.000  0.980  0.895  0.996</span></span>
<span><span class="co">#&gt; Notes:</span></span>
<span><span class="co">#&gt; - n: The sample size in a trial.</span></span>
<span><span class="co">#&gt; - p.v: The proportion of valid replications.</span></span>
<span><span class="co">#&gt; - est: The mean of the estimates in a test across replications.</span></span>
<span><span class="co">#&gt; - reject: The proportion of 'significant' replications, that is, the</span></span>
<span><span class="co">#&gt;   rejection rate. If the null hypothesis is true, this is the Type I</span></span>
<span><span class="co">#&gt;   error rate. If the null hypothesis is false, this is the power.</span></span>
<span><span class="co">#&gt; - r.cilo,r.cihi: The confidence interval of the rejection rate, based</span></span>
<span><span class="co">#&gt;   on Wilson's (1927) method.</span></span>
<span><span class="co">#&gt; - Refer to the tests for the meanings of other columns.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - Estimated Power Curve:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; power_curve(object = by_x_1, formula = power_curve_args$power_model, </span></span>
<span><span class="co">#&gt;     start = power_curve_args$start, lower_bound = power_curve_args$lower_bound, </span></span>
<span><span class="co">#&gt;     upper_bound = power_curve_args$upper_bound, nls_args = power_curve_args$nls_args, </span></span>
<span><span class="co">#&gt;     nls_control = power_curve_args$nls_control, verbose = progress)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Predictor: n (Sample Size)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:  stats::glm(formula = reject ~ x, family = "binomial", data = reject1)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt; (Intercept)            x  </span></span>
<span><span class="co">#&gt;    -1.43578      0.02659  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Degrees of Freedom: 349 Total (i.e. Null);  348 Residual</span></span>
<span><span class="co">#&gt; Null Deviance:       347.5 </span></span>
<span><span class="co">#&gt; Residual Deviance: 283.5     AIC: 287.5</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - Final Value: 149 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - Final Estimated Power: 0.9200 </span></span>
<span><span class="co">#&gt; - Confidence Interval: [0.8116; 0.9685]</span></span>
<span><span class="co">#&gt; - CI Level: 95.00%</span></span>
<span><span class="va">n_power_region2</span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; n_region_from_power(object = out_n_lb, seed = 24680)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                      Setting                                      </span></span>
<span><span class="co">#&gt; Predictor(x)         Sample Size                                  </span></span>
<span><span class="co">#&gt; Goal:                Power significantly below or above the target</span></span>
<span><span class="co">#&gt; algorithm:           bisection                                    </span></span>
<span><span class="co">#&gt; Level of confidence: 95.00%                                       </span></span>
<span><span class="co">#&gt; Target Power:        0.800                                        </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Solution: </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Approximate region of sample sizes with power:</span></span>
<span><span class="co">#&gt; - not significantly different from 0.800: 75 to 149</span></span>
<span><span class="co">#&gt; - significantly lower than 0.800: 75</span></span>
<span><span class="co">#&gt; - significantly higher than 0.800: 149</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Confidence intervals of the estimated power:</span></span>
<span><span class="co">#&gt; - for the lower bound (75): [0.542, 0.792]</span></span>
<span><span class="co">#&gt; - for the upper bound (149): [0.812, 0.968]</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call `summary()` for detailed results.</span></span></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">n_power_region2</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="region_plot2-1.png" alt="The Power Curve (Region) Version 2"><p class="caption">
The Power Curve (Region) Version 2
</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Shu Fai Cheung, Sing-Hang Cheung, Wendie Yang.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
