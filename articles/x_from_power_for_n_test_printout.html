<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Sample Size Given Desired Power (Internal) • power4mome</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Hind-0.4.10/font.css" rel="stylesheet">
<link href="../deps/Oxygen_Mono-0.4.10/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Sample Size Given Desired Power (Internal)">
<meta name="google-site-verification" content="0VLBmFnW_UJFI-7gXnORPBsWxqZwmzuGpK-TeVRLBjQ">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">power4mome</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.1.55</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/power4mome.html">Get started</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Scenarios</h6></li>
    <li><a class="dropdown-item" href="../articles/power4test_latent_mediation.html">Power Analysis for Latent Variable Mediation</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Given Power, Find x</h6></li>
    <li><a class="dropdown-item" href="../articles/x_from_power_for_n_pb.html">Sample Size Given Desired Power (Probabilistic Bisection)</a></li>
    <li><a class="dropdown-item" href="../articles/x_from_power_for_n.html">Sample Size Given Desired Power (Informal Bisection)</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Common Mediation Models</h6></li>
    <li><a class="dropdown-item" href="../articles/template_q_med_obs_simple.html">Quick Function: Simple Mediation with Observed Variables</a></li>
    <li><a class="dropdown-item" href="../articles/template_q_med_obs_serial.html">Quick Function: Serial Mediation with Observed Variables</a></li>
    <li><a class="dropdown-item" href="../articles/template_q_med_obs_parallel.html">Quick Function: Parallel Mediation with Observed Variables</a></li>
    <li><a class="dropdown-item" href="../articles/template_q_med_lav_simple.html">Quick Function: Simple Mediation with Latent Variables</a></li>
    <li><a class="dropdown-item" href="../articles/template_q_med_lav_serial.html">Quick Function: Serial Mediation with Latent Variables</a></li>
    <li><a class="dropdown-item" href="../articles/template_q_med_lav_parallel.html">Quick Function: Parallel Mediation with Latent Variables</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Templates (Code Examples)</h6></li>
    <li><a class="dropdown-item" href="../articles/template_n_from_power_mediation_obs_simple.html">Quick Template: Simple Mediation with Observed Variables</a></li>
    <li><a class="dropdown-item" href="../articles/template_n_from_power_mediation_obs_serial.html">Quick Template: Serial Mediation with Observed Variables</a></li>
    <li><a class="dropdown-item" href="../articles/template_n_from_power_mediation_obs_parallel.html">Quick Template: Parallel Mediation with Observed Variables</a></li>
    <li><a class="dropdown-item" href="../articles/template_n_from_power_mediation_lav_simple.html">Quick Template: Simple Mediation with Latent Variables</a></li>
    <li><a class="dropdown-item" href="../articles/template_n_from_power_mediation_lav_serial.html">Quick Template: Serial Mediation with Latent Variables</a></li>
    <li><a class="dropdown-item" href="../articles/template_n_from_power_mediation_lav_parallel.html">Quick Template: Parallel Mediation with Latent Variables</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Moderation Templates (Code Examples)</h6></li>
    <li><a class="dropdown-item" href="../articles/template_n_from_power_moderation_obs_simple.html">Quick Template: Simple Moderation with Observed Variables</a></li>
    <li><a class="dropdown-item" href="../articles/template_n_from_power_moderation_obs_two_ws.html">Quick Template: Moderation with Observed Variables: Two Moderators</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Moderated Mediation Templates (Code Examples)</h6></li>
    <li><a class="dropdown-item" href="../articles/template_n_from_power_mome_obs_a.html">Quick Template: Simple Moderated Mediation with Observed Variables: a-Path Moderated</a></li>
    <li><a class="dropdown-item" href="../articles/template_n_from_power_mome_obs_b.html">Quick Template: Simple Moderated Mediation with Observed Variables: b-Path Moderated</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/index.html">More articles...</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/sfcheung/power4mome/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Sample Size Given Desired Power (Internal)</h1>
            
            <h4 data-toc-skip class="date">2026-02-28</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/sfcheung/power4mome/blob/main/vignettes/articles/x_from_power_for_n_test_printout.Rmd" class="external-link"><code>vignettes/articles/x_from_power_for_n_test_printout.Rmd</code></a></small>
      <div class="d-none name"><code>x_from_power_for_n_test_printout.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="note">NOTE<a class="anchor" aria-label="anchor" href="#note"></a>
</h2>
<p>This article is for internal testing of the printout.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://sfcheung.github.io/power4mome/">power4mome</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>power4mome.bz <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod</span> <span class="op">&lt;-</span></span>
<span><span class="st">"</span></span>
<span><span class="st">m ~ x</span></span>
<span><span class="st">y ~ m + x</span></span>
<span><span class="st">"</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod_es</span> <span class="op">&lt;-</span></span>
<span><span class="st">"</span></span>
<span><span class="st">m ~ x: m</span></span>
<span><span class="st">y ~ m: l</span></span>
<span><span class="st">y ~ x: s</span></span>
<span><span class="st">"</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/power4test.html">power4test</a></span><span class="op">(</span>nrep <span class="op">=</span> <span class="fl">2</span>,</span>
<span>                  model <span class="op">=</span> <span class="va">mod</span>,</span>
<span>                  pop_es <span class="op">=</span> <span class="va">mod_es</span>,</span>
<span>                  n <span class="op">=</span> <span class="fl">50000</span>,</span>
<span>                  iseed <span class="op">=</span> <span class="fl">1234</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">out</span>,</span>
<span>      data_long <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ====================== Model Information ======================</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; == Model on Factors/Variables ==</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; m ~ x</span></span>
<span><span class="co">#&gt; y ~ m + x</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; == Model on Variables/Indicators ==</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; m ~ x</span></span>
<span><span class="co">#&gt; y ~ m + x</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ====== Population Values ======</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Regressions:</span></span>
<span><span class="co">#&gt;                    Population</span></span>
<span><span class="co">#&gt;   m ~                        </span></span>
<span><span class="co">#&gt;     x                 0.300  </span></span>
<span><span class="co">#&gt;   y ~                        </span></span>
<span><span class="co">#&gt;     m                 0.500  </span></span>
<span><span class="co">#&gt;     x                 0.100  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Variances:</span></span>
<span><span class="co">#&gt;                    Population</span></span>
<span><span class="co">#&gt;    .m                 0.910  </span></span>
<span><span class="co">#&gt;    .y                 0.710  </span></span>
<span><span class="co">#&gt;     x                 1.000  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; (Computing indirect effects for 2 paths ...)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; == Population Conditional/Indirect Effect(s) ==</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; == Indirect Effect(s) ==</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;               ind</span></span>
<span><span class="co">#&gt; x -&gt; m -&gt; y 0.150</span></span>
<span><span class="co">#&gt; x -&gt; y      0.100</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  - The 'ind' column shows the indirect effect(s).</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; ======================= Data Information =======================</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of Replications:  2 </span></span>
<span><span class="co">#&gt; Sample Sizes:  50000 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ==== Descriptive Statistics ====</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   vars     n mean sd skew kurtosis se</span></span>
<span><span class="co">#&gt; m    1 1e+05 0.00  1 0.01     0.03  0</span></span>
<span><span class="co">#&gt; y    2 1e+05 0.01  1 0.02     0.00  0</span></span>
<span><span class="co">#&gt; x    3 1e+05 0.00  1 0.01     0.01  0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ===== Parameter Estimates Based on All 2 Samples Combined =====</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Total Sample Size: 100000 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ==== Standardized Estimates ====</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Variances and error variances omitted.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Regressions:</span></span>
<span><span class="co">#&gt;                     est.std</span></span>
<span><span class="co">#&gt;   m ~                      </span></span>
<span><span class="co">#&gt;     x                 0.301</span></span>
<span><span class="co">#&gt;   y ~                      </span></span>
<span><span class="co">#&gt;     m                 0.496</span></span>
<span><span class="co">#&gt;     x                 0.101</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ==================== Extra Element(s) Found ====================</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - fit</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; === Element(s) of the First Dataset ===</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ============ &lt;fit&gt; ============</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; lavaan 0.6-21 ended normally after 1 iteration</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Estimator                                         ML</span></span>
<span><span class="co">#&gt;   Optimization method                           NLMINB</span></span>
<span><span class="co">#&gt;   Number of model parameters                         5</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Number of observations                         50000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model Test User Model:</span></span>
<span><span class="co">#&gt;                                                       </span></span>
<span><span class="co">#&gt;   Test statistic                                 0.000</span></span>
<span><span class="co">#&gt;   Degrees of freedom                                 0</span></span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/power4test.html">power4test</a></span><span class="op">(</span>nrep <span class="op">=</span> <span class="fl">200</span>,</span>
<span>                  model <span class="op">=</span> <span class="va">mod</span>,</span>
<span>                  pop_es <span class="op">=</span> <span class="va">mod_es</span>,</span>
<span>                  n <span class="op">=</span> <span class="fl">100</span>,</span>
<span>                  R <span class="op">=</span> <span class="fl">199</span>,</span>
<span>                  ci_type <span class="op">=</span> <span class="st">"mc"</span>,</span>
<span>                  test_fun <span class="op">=</span> <span class="va">test_indirect_effect</span>,</span>
<span>                  test_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"x"</span>,</span>
<span>                                   m <span class="op">=</span> <span class="st">"m"</span>,</span>
<span>                                   y <span class="op">=</span> <span class="st">"y"</span>,</span>
<span>                                   mc_ci <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>                  iseed <span class="op">=</span> <span class="fl">2345</span>,</span>
<span>                  parallel <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">out</span>,</span>
<span>      test_long <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ====================== Model Information ======================</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; == Model on Factors/Variables ==</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; m ~ x</span></span>
<span><span class="co">#&gt; y ~ m + x</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; == Model on Variables/Indicators ==</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; m ~ x</span></span>
<span><span class="co">#&gt; y ~ m + x</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ====== Population Values ======</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Regressions:</span></span>
<span><span class="co">#&gt;                    Population</span></span>
<span><span class="co">#&gt;   m ~                        </span></span>
<span><span class="co">#&gt;     x                 0.300  </span></span>
<span><span class="co">#&gt;   y ~                        </span></span>
<span><span class="co">#&gt;     m                 0.500  </span></span>
<span><span class="co">#&gt;     x                 0.100  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Variances:</span></span>
<span><span class="co">#&gt;                    Population</span></span>
<span><span class="co">#&gt;    .m                 0.910  </span></span>
<span><span class="co">#&gt;    .y                 0.710  </span></span>
<span><span class="co">#&gt;     x                 1.000  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; (Computing indirect effects for 2 paths ...)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; == Population Conditional/Indirect Effect(s) ==</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; == Indirect Effect(s) ==</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;               ind</span></span>
<span><span class="co">#&gt; x -&gt; m -&gt; y 0.150</span></span>
<span><span class="co">#&gt; x -&gt; y      0.100</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  - The 'ind' column shows the indirect effect(s).</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; ======================= Data Information =======================</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of Replications:  200 </span></span>
<span><span class="co">#&gt; Sample Sizes:  100 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call print with 'data_long = TRUE' for further information.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ==================== Extra Element(s) Found ====================</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - fit</span></span>
<span><span class="co">#&gt; - mc_out</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; === Element(s) of the First Dataset ===</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ============ &lt;fit&gt; ============</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; lavaan 0.6-21 ended normally after 1 iteration</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Estimator                                         ML</span></span>
<span><span class="co">#&gt;   Optimization method                           NLMINB</span></span>
<span><span class="co">#&gt;   Number of model parameters                         5</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Number of observations                           100</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model Test User Model:</span></span>
<span><span class="co">#&gt;                                                       </span></span>
<span><span class="co">#&gt;   Test statistic                                 0.000</span></span>
<span><span class="co">#&gt;   Degrees of freedom                                 0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; =========== &lt;mc_out&gt; ===========</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; == A 'mc_out' class object ==</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of Monte Carlo replications: 199 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; =============== &lt;test_indirect: x-&gt;m-&gt;y&gt; ===============</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Mean(s) across replication:</span></span>
<span><span class="co">#&gt;    est cilo cihi   sig pvalue       R  nlt0 alpha bz_39 bz_79 bz_119 bz_159</span></span>
<span><span class="co">#&gt;  0.151  NaN  NaN 0.881  0.029 199.000 2.975 0.050 0.818 0.848  0.857  0.862</span></span>
<span><span class="co">#&gt;  bz_199</span></span>
<span><span class="co">#&gt;   0.875</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - The value 'sig' is the rejection rate.</span></span>
<span><span class="co">#&gt; - If the null hypothesis is false, this is the power.</span></span>
<span><span class="co">#&gt; - Number of valid replications for rejection rate: 200 </span></span>
<span><span class="co">#&gt; - Proportion of valid replications for rejection rate: 1.000</span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out_n</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/x_from_power.html">n_from_power</a></span><span class="op">(</span><span class="va">out</span>,</span>
<span>                      what <span class="op">=</span> <span class="st">"ub"</span>,</span>
<span>                      seed <span class="op">=</span> <span class="fl">4567</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out_n</span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; power4mome::x_from_power(object = out, x = "n", what = "ub", </span></span>
<span><span class="co">#&gt;     goal = "close_enough", final_nrep = 200, final_R = 199, seed = 4567)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                           Setting</span></span>
<span><span class="co">#&gt; Predictor(x):         Sample Size</span></span>
<span><span class="co">#&gt; Parameter:                    N/A</span></span>
<span><span class="co">#&gt; goal:                close_enough</span></span>
<span><span class="co">#&gt; what:                          ub</span></span>
<span><span class="co">#&gt; algorithm:              bisection</span></span>
<span><span class="co">#&gt; Level of confidence:       95.00%</span></span>
<span><span class="co">#&gt; Target Power:               0.800</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - Final Value of Sample Size (n): 75</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - Final Estimated Power (CI): 0.744 [0.680, 0.800]</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call `summary()` for detailed results.</span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">out_n</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ====== x_from_power Results ======</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; x_from_power(object = out, x = "n", what = "ub", goal = "close_enough", </span></span>
<span><span class="co">#&gt;     final_nrep = 200, final_R = 199, seed = 4567)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Predictor (x): Sample Size </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - Target Power: 0.800 </span></span>
<span><span class="co">#&gt; - Goal: Find 'x' with estimated upper confidence bound close enough to</span></span>
<span><span class="co">#&gt;   the target power.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; === Major Results ===</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - Final Value (Sample Size): 75</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - Final Estimated Power: 0.744 </span></span>
<span><span class="co">#&gt; - Confidence Interval: [0.680; 0.800]</span></span>
<span><span class="co">#&gt; - Level of confidence: 95.0%</span></span>
<span><span class="co">#&gt; - Based on 200 replications.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; === Technical Information ===</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - Algorithm: bisection </span></span>
<span><span class="co">#&gt; - Tolerance for 'close enough': Within 0.02000 of 0.800 </span></span>
<span><span class="co">#&gt; - The range of values explored: 100 to 75 </span></span>
<span><span class="co">#&gt; - Time spent in the search: 6.856 secs </span></span>
<span><span class="co">#&gt; - The final crude model for the power-predictor relation:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model Type: Logistic Regression </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; power_curve(object = by_x_1, formula = power_model, start = power_curve_start, </span></span>
<span><span class="co">#&gt;     lower_bound = lower_bound, upper_bound = upper_bound, nls_args = nls_args, </span></span>
<span><span class="co">#&gt;     nls_control = nls_control, verbose = progress)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Predictor: n (Sample Size)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:  stats::glm(formula = reject ~ x, family = "binomial", data = reject1)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt; (Intercept)            x  </span></span>
<span><span class="co">#&gt;    -0.92158      0.02815  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Degrees of Freedom: 599 Total (i.e. Null);  598 Residual</span></span>
<span><span class="co">#&gt; Null Deviance:       672.6 </span></span>
<span><span class="co">#&gt; Residual Deviance: 638.3     AIC: 642.3</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - Detailed Results:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [test]: test_indirect: x-&gt;m-&gt;y </span></span>
<span><span class="co">#&gt; [test_label]: Test </span></span>
<span><span class="co">#&gt;     n   est   p.v reject r.cilo r.cihi</span></span>
<span><span class="co">#&gt; 1  50 0.158 1.000  0.630  0.561  0.694</span></span>
<span><span class="co">#&gt; 2  75 0.149 1.000  0.744  0.680  0.800</span></span>
<span><span class="co">#&gt; 3 100 0.151 1.000  0.881  0.828  0.918</span></span>
<span><span class="co">#&gt; Notes:</span></span>
<span><span class="co">#&gt; - n: The sample size in a trial.</span></span>
<span><span class="co">#&gt; - p.v: The proportion of valid replications.</span></span>
<span><span class="co">#&gt; - est: The mean of the estimates in a test across replications.</span></span>
<span><span class="co">#&gt; - reject: The proportion of 'significant' replications, that is, the</span></span>
<span><span class="co">#&gt;   rejection rate. If the null hypothesis is true, this is the Type I</span></span>
<span><span class="co">#&gt;   error rate. If the null hypothesis is false, this is the power.</span></span>
<span><span class="co">#&gt; - r.cilo,r.cihi: The confidence interval of the rejection rate, based</span></span>
<span><span class="co">#&gt;   on Wilson's (1927) method.</span></span>
<span><span class="co">#&gt; - Refer to the tests for the meanings of other columns.</span></span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">out_n</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="x_from_power_for_n_plot_test-1.png" alt="The Power Curve"><p class="caption">
The Power Curve
</p>
</div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out_n_lb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/x_from_power.html">n_from_power</a></span><span class="op">(</span><span class="va">out</span>,</span>
<span>                         what <span class="op">=</span> <span class="st">"lb"</span>,</span>
<span>                         seed <span class="op">=</span> <span class="fl">2345</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out_n_lb</span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; power4mome::x_from_power(object = out, x = "n", what = "lb", </span></span>
<span><span class="co">#&gt;     goal = "close_enough", final_nrep = 200, final_R = 199, seed = 2345)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                           Setting</span></span>
<span><span class="co">#&gt; Predictor(x):         Sample Size</span></span>
<span><span class="co">#&gt; Parameter:                    N/A</span></span>
<span><span class="co">#&gt; goal:                close_enough</span></span>
<span><span class="co">#&gt; what:                          lb</span></span>
<span><span class="co">#&gt; algorithm:              bisection</span></span>
<span><span class="co">#&gt; Level of confidence:       95.00%</span></span>
<span><span class="co">#&gt; Target Power:               0.800</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - Final Value of Sample Size (n): 96</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - Final Estimated Power (CI): 0.853 [0.800, 0.897]</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call `summary()` for detailed results.</span></span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">out_n_lb</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ====== x_from_power Results ======</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; x_from_power(object = out, x = "n", what = "lb", goal = "close_enough", </span></span>
<span><span class="co">#&gt;     final_nrep = 200, final_R = 199, seed = 2345)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Predictor (x): Sample Size </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - Target Power: 0.800 </span></span>
<span><span class="co">#&gt; - Goal: Find 'x' with estimated lower confidence bound close enough to</span></span>
<span><span class="co">#&gt;   the target power.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; === Major Results ===</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - Final Value (Sample Size): 96</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - Final Estimated Power: 0.853 </span></span>
<span><span class="co">#&gt; - Confidence Interval: [0.800; 0.897]</span></span>
<span><span class="co">#&gt; - Level of confidence: 95.0%</span></span>
<span><span class="co">#&gt; - Based on 200 replications.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; === Technical Information ===</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - Algorithm: bisection </span></span>
<span><span class="co">#&gt; - Tolerance for 'close enough': Within 0.02000 of 0.800 </span></span>
<span><span class="co">#&gt; - The range of values explored: 100 to 96 </span></span>
<span><span class="co">#&gt; - Time spent in the search: 13.62 secs </span></span>
<span><span class="co">#&gt; - The final crude model for the power-predictor relation:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model Type: Logistic Regression </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; power_curve(object = by_x_1, formula = power_model, start = power_curve_start, </span></span>
<span><span class="co">#&gt;     lower_bound = lower_bound, upper_bound = upper_bound, nls_args = nls_args, </span></span>
<span><span class="co">#&gt;     nls_control = nls_control, verbose = progress)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Predictor: n (Sample Size)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:  stats::glm(formula = reject ~ x, family = "binomial", data = reject1)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt; (Intercept)            x  </span></span>
<span><span class="co">#&gt;    -1.01426      0.02904  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Degrees of Freedom: 999 Total (i.e. Null);  998 Residual</span></span>
<span><span class="co">#&gt; Null Deviance:       1041 </span></span>
<span><span class="co">#&gt; Residual Deviance: 989.9     AIC: 993.9</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - Detailed Results:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [test]: test_indirect: x-&gt;m-&gt;y </span></span>
<span><span class="co">#&gt; [test_label]: Test </span></span>
<span><span class="co">#&gt;     n   est   p.v reject r.cilo r.cihi</span></span>
<span><span class="co">#&gt; 1  50 0.154 1.000  0.601  0.531  0.665</span></span>
<span><span class="co">#&gt; 2  75 0.147 1.000  0.790  0.728  0.841</span></span>
<span><span class="co">#&gt; 3  90 0.145 1.000  0.800  0.739  0.850</span></span>
<span><span class="co">#&gt; 4  96 0.148 1.000  0.853  0.800  0.897</span></span>
<span><span class="co">#&gt; 5 100 0.151 1.000  0.881  0.828  0.918</span></span>
<span><span class="co">#&gt; Notes:</span></span>
<span><span class="co">#&gt; - n: The sample size in a trial.</span></span>
<span><span class="co">#&gt; - p.v: The proportion of valid replications.</span></span>
<span><span class="co">#&gt; - est: The mean of the estimates in a test across replications.</span></span>
<span><span class="co">#&gt; - reject: The proportion of 'significant' replications, that is, the</span></span>
<span><span class="co">#&gt;   rejection rate. If the null hypothesis is true, this is the Type I</span></span>
<span><span class="co">#&gt;   error rate. If the null hypothesis is false, this is the power.</span></span>
<span><span class="co">#&gt; - r.cilo,r.cihi: The confidence interval of the rejection rate, based</span></span>
<span><span class="co">#&gt;   on Wilson's (1927) method.</span></span>
<span><span class="co">#&gt; - Refer to the tests for the meanings of other columns.</span></span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">out_n_lb</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="x_from_power_for_n_lb_plot_test-1.png" alt="The Power Curve"><p class="caption">
The Power Curve
</p>
</div>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n_power_region</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/x_from_power.html">n_region_from_power</a></span><span class="op">(</span><span class="va">out</span>,</span>
<span>                                      seed <span class="op">=</span> <span class="fl">2468</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; =========== Phase 1: Upper Bound ===========</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Find the approximate region with power significantly below 0.8 ...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; --- Setting ---</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Algorithm:  bisection </span></span>
<span><span class="co">#&gt; Goal:  close_enough </span></span>
<span><span class="co">#&gt; What:  ub   (Upper bound of the confidence interval) </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; --- Progress  ---</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - Set 'progress = FALSE' to suppress displaying the progress.</span></span>
<span><span class="co">#&gt; - Set 'simulation progress = FALSE' to suppress displaying the progress</span></span>
<span><span class="co">#&gt;   in the simulation.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Initial interval: [50, 100] </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Do the simulation for the lower bound:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Try x = 50 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Updating the simulation for sample size: 50 </span></span>
<span><span class="co">#&gt; Re-simulate the data:</span></span>
<span><span class="co">#&gt; Fit the model(s):</span></span>
<span><span class="co">#&gt; Generate Monte Carlo estimates:</span></span>
<span><span class="co">#&gt; Update the test(s):</span></span>
<span><span class="co">#&gt; Update test_indirect: x-&gt;m-&gt;y :</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Estimated power at 50: 0.589, 95.0% confidence interval: [0.521,0.656]</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Initial interval: [50, 100] </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - Rejection Rates:</span></span>
<span><span class="co">#&gt; [test]: test_indirect: x-&gt;m-&gt;y </span></span>
<span><span class="co">#&gt; [test_label]: Test </span></span>
<span><span class="co">#&gt;     n   est   p.v reject r.cilo r.cihi</span></span>
<span><span class="co">#&gt; 1  50 0.150 1.000  0.589  0.521  0.656</span></span>
<span><span class="co">#&gt; 2 100 0.151 1.000  0.881  0.828  0.918</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; == Enter extending interval ...</span></span>
<span><span class="co">#&gt; The interval is already valid: [50, 100] </span></span>
<span><span class="co">#&gt; == Exit extending interval ...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Iteration # 1 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Try x = 75 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Updating the simulation for sample size: 75 </span></span>
<span><span class="co">#&gt; Re-simulate the data:</span></span>
<span><span class="co">#&gt; Fit the model(s):</span></span>
<span><span class="co">#&gt; Generate Monte Carlo estimates:</span></span>
<span><span class="co">#&gt; Update the test(s):</span></span>
<span><span class="co">#&gt; Update test_indirect: x-&gt;m-&gt;y :</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Estimated power at 75: 0.796, 95.0% confidence interval: [0.734,0.845]</span></span>
<span><span class="co">#&gt; - Rejection Rates:</span></span>
<span><span class="co">#&gt; [test]: test_indirect: x-&gt;m-&gt;y </span></span>
<span><span class="co">#&gt; [test_label]: Test </span></span>
<span><span class="co">#&gt;     n   est   p.v reject r.cilo r.cihi</span></span>
<span><span class="co">#&gt; 1  50 0.150 1.000  0.589  0.521  0.656</span></span>
<span><span class="co">#&gt; 2  75 0.153 1.000  0.796  0.734  0.845</span></span>
<span><span class="co">#&gt; 3 100 0.151 1.000  0.881  0.828  0.918</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; New interval: [50, 75] </span></span>
<span><span class="co">#&gt; Power curve used to find the next x ...</span></span>
<span><span class="co">#&gt; Updated x: 67 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Iteration # 2 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Try x = 67 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Updating the simulation for sample size: 67 </span></span>
<span><span class="co">#&gt; Re-simulate the data:</span></span>
<span><span class="co">#&gt; Fit the model(s):</span></span>
<span><span class="co">#&gt; Generate Monte Carlo estimates:</span></span>
<span><span class="co">#&gt; Update the test(s):</span></span>
<span><span class="co">#&gt; Update test_indirect: x-&gt;m-&gt;y :</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Estimated power at 67: 0.705, 95.0% confidence interval: [0.638,0.764]</span></span>
<span><span class="co">#&gt; - Rejection Rates:</span></span>
<span><span class="co">#&gt; [test]: test_indirect: x-&gt;m-&gt;y </span></span>
<span><span class="co">#&gt; [test_label]: Test </span></span>
<span><span class="co">#&gt;     n   est   p.v reject r.cilo r.cihi</span></span>
<span><span class="co">#&gt; 1  50 0.150 1.000  0.589  0.521  0.656</span></span>
<span><span class="co">#&gt; 2  67 0.149 1.000  0.705  0.638  0.764</span></span>
<span><span class="co">#&gt; 3  75 0.153 1.000  0.796  0.734  0.845</span></span>
<span><span class="co">#&gt; 4 100 0.151 1.000  0.881  0.828  0.918</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; New interval: [67, 75] </span></span>
<span><span class="co">#&gt; Power curve used to find the next x ...</span></span>
<span><span class="co">#&gt; Updated x: 71 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Iteration # 3 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Try x = 71 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Updating the simulation for sample size: 71 </span></span>
<span><span class="co">#&gt; Re-simulate the data:</span></span>
<span><span class="co">#&gt; Fit the model(s):</span></span>
<span><span class="co">#&gt; Generate Monte Carlo estimates:</span></span>
<span><span class="co">#&gt; Update the test(s):</span></span>
<span><span class="co">#&gt; Update test_indirect: x-&gt;m-&gt;y :</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Estimated power at 71: 0.790, 95.0% confidence interval: [0.728,0.841]</span></span>
<span><span class="co">#&gt; - Rejection Rates:</span></span>
<span><span class="co">#&gt; [test]: test_indirect: x-&gt;m-&gt;y </span></span>
<span><span class="co">#&gt; [test_label]: Test </span></span>
<span><span class="co">#&gt;     n   est   p.v reject r.cilo r.cihi</span></span>
<span><span class="co">#&gt; 1  50 0.150 1.000  0.589  0.521  0.656</span></span>
<span><span class="co">#&gt; 2  67 0.149 1.000  0.705  0.638  0.764</span></span>
<span><span class="co">#&gt; 3  71 0.156 1.000  0.790  0.728  0.841</span></span>
<span><span class="co">#&gt; 4  75 0.153 1.000  0.796  0.734  0.845</span></span>
<span><span class="co">#&gt; 5 100 0.151 1.000  0.881  0.828  0.918</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; New interval: [67, 71] </span></span>
<span><span class="co">#&gt; Power curve used to find the next x ...</span></span>
<span><span class="co">#&gt; Updated x: 69 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Iteration # 4 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Try x = 69 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Updating the simulation for sample size: 69 </span></span>
<span><span class="co">#&gt; Re-simulate the data:</span></span>
<span><span class="co">#&gt; Fit the model(s):</span></span>
<span><span class="co">#&gt; Generate Monte Carlo estimates:</span></span>
<span><span class="co">#&gt; Update the test(s):</span></span>
<span><span class="co">#&gt; Update test_indirect: x-&gt;m-&gt;y :</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Estimated power at 69: 0.693, 95.0% confidence interval: [0.628,0.755]</span></span>
<span><span class="co">#&gt; - Rejection Rates:</span></span>
<span><span class="co">#&gt; [test]: test_indirect: x-&gt;m-&gt;y </span></span>
<span><span class="co">#&gt; [test_label]: Test </span></span>
<span><span class="co">#&gt;     n   est   p.v reject r.cilo r.cihi</span></span>
<span><span class="co">#&gt; 1  50 0.150 1.000  0.589  0.521  0.656</span></span>
<span><span class="co">#&gt; 2  67 0.149 1.000  0.705  0.638  0.764</span></span>
<span><span class="co">#&gt; 3  69 0.146 1.000  0.693  0.628  0.755</span></span>
<span><span class="co">#&gt; 4  71 0.156 1.000  0.790  0.728  0.841</span></span>
<span><span class="co">#&gt; 5  75 0.153 1.000  0.796  0.734  0.845</span></span>
<span><span class="co">#&gt; 6 100 0.151 1.000  0.881  0.828  0.918</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Current interval:  [69, 71] </span></span>
<span><span class="co">#&gt; - Interval too narrow. Extend it ... </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; == Enter extending interval ...</span></span>
<span><span class="co">#&gt; Current interval: [69, 71] </span></span>
<span><span class="co">#&gt; Interval above the solution. Extend the lower bound ...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Try x = 63 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Updating the simulation for sample size: 63 </span></span>
<span><span class="co">#&gt; Re-simulate the data:</span></span>
<span><span class="co">#&gt; Fit the model(s):</span></span>
<span><span class="co">#&gt; Generate Monte Carlo estimates:</span></span>
<span><span class="co">#&gt; Update the test(s):</span></span>
<span><span class="co">#&gt; Update test_indirect: x-&gt;m-&gt;y :</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Estimated power at 63: 0.610, 95.0% confidence interval: [0.541,0.675]</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; (Extending the interval) Iteration: 1 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; New interval: [63, 69] </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Try x = 93 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Updating the simulation for sample size: 93 </span></span>
<span><span class="co">#&gt; Re-simulate the data:</span></span>
<span><span class="co">#&gt; Fit the model(s):</span></span>
<span><span class="co">#&gt; Generate Monte Carlo estimates:</span></span>
<span><span class="co">#&gt; Update the test(s):</span></span>
<span><span class="co">#&gt; Update test_indirect: x-&gt;m-&gt;y :</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Estimated power at 93: 0.814, 95.0% confidence interval: [0.755,0.863]</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; (Extending the interval) Iteration: 2 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; New interval: [69, 93] </span></span>
<span><span class="co">#&gt; Interval OK.</span></span>
<span><span class="co">#&gt; Final extended interval: [69, 93] </span></span>
<span><span class="co">#&gt; == Exit extending interval ...</span></span>
<span><span class="co">#&gt; New interval: [69, 93] </span></span>
<span><span class="co">#&gt; Power curve used to find the next x ...</span></span>
<span><span class="co">#&gt; Updated x: 77 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Iteration # 5 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Try x = 77 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Updating the simulation for sample size: 77 </span></span>
<span><span class="co">#&gt; Re-simulate the data:</span></span>
<span><span class="co">#&gt; Fit the model(s):</span></span>
<span><span class="co">#&gt; Generate Monte Carlo estimates:</span></span>
<span><span class="co">#&gt; Update the test(s):</span></span>
<span><span class="co">#&gt; Update test_indirect: x-&gt;m-&gt;y :</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Estimated power at 77: 0.762, 95.0% confidence interval: [0.696,0.814]</span></span>
<span><span class="co">#&gt; - Rejection Rates:</span></span>
<span><span class="co">#&gt; [test]: test_indirect: x-&gt;m-&gt;y </span></span>
<span><span class="co">#&gt; [test_label]: Test </span></span>
<span><span class="co">#&gt;     n   est   p.v reject r.cilo r.cihi</span></span>
<span><span class="co">#&gt; 1  50 0.150 1.000  0.589  0.521  0.656</span></span>
<span><span class="co">#&gt; 2  63 0.146 1.000  0.610  0.541  0.675</span></span>
<span><span class="co">#&gt; 3  67 0.149 1.000  0.705  0.638  0.764</span></span>
<span><span class="co">#&gt; 4  69 0.146 1.000  0.693  0.628  0.755</span></span>
<span><span class="co">#&gt; 5  71 0.156 1.000  0.790  0.728  0.841</span></span>
<span><span class="co">#&gt; 6  75 0.153 1.000  0.796  0.734  0.845</span></span>
<span><span class="co">#&gt; 7  77 0.142 1.000  0.762  0.696  0.814</span></span>
<span><span class="co">#&gt; 8  93 0.151 1.000  0.814  0.755  0.863</span></span>
<span><span class="co">#&gt; 9 100 0.151 1.000  0.881  0.828  0.918</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - 'nls()' estimation skipped when less than 4 values of predictor examined.</span></span>
<span><span class="co">#&gt; Solution found.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ========== Final Stage ==========</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - Start at 2026-02-28 12:08:29 </span></span>
<span><span class="co">#&gt; - Rejection Rates:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [test]: test_indirect: x-&gt;m-&gt;y </span></span>
<span><span class="co">#&gt; [test_label]: Test </span></span>
<span><span class="co">#&gt;     n   est   p.v reject r.cilo r.cihi</span></span>
<span><span class="co">#&gt; 1  50 0.150 1.000  0.589  0.521  0.656</span></span>
<span><span class="co">#&gt; 2  63 0.146 1.000  0.610  0.541  0.675</span></span>
<span><span class="co">#&gt; 3  67 0.149 1.000  0.705  0.638  0.764</span></span>
<span><span class="co">#&gt; 4  69 0.146 1.000  0.693  0.628  0.755</span></span>
<span><span class="co">#&gt; 5  71 0.156 1.000  0.790  0.728  0.841</span></span>
<span><span class="co">#&gt; 6  75 0.153 1.000  0.796  0.734  0.845</span></span>
<span><span class="co">#&gt; 7  77 0.142 1.000  0.762  0.696  0.814</span></span>
<span><span class="co">#&gt; 8  93 0.151 1.000  0.814  0.755  0.863</span></span>
<span><span class="co">#&gt; 9 100 0.151 1.000  0.881  0.828  0.918</span></span>
<span><span class="co">#&gt; Notes:</span></span>
<span><span class="co">#&gt; - n: The sample size in a trial.</span></span>
<span><span class="co">#&gt; - p.v: The proportion of valid replications.</span></span>
<span><span class="co">#&gt; - est: The mean of the estimates in a test across replications.</span></span>
<span><span class="co">#&gt; - reject: The proportion of 'significant' replications, that is, the</span></span>
<span><span class="co">#&gt;   rejection rate. If the null hypothesis is true, this is the Type I</span></span>
<span><span class="co">#&gt;   error rate. If the null hypothesis is false, this is the power.</span></span>
<span><span class="co">#&gt; - r.cilo,r.cihi: The confidence interval of the rejection rate, based</span></span>
<span><span class="co">#&gt;   on Wilson's (1927) method.</span></span>
<span><span class="co">#&gt; - Refer to the tests for the meanings of other columns.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - Estimated Power Curve:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; power_curve(object = by_x_1, formula = power_model, start = power_curve_start, </span></span>
<span><span class="co">#&gt;     lower_bound = lower_bound, upper_bound = upper_bound, nls_args = nls_args, </span></span>
<span><span class="co">#&gt;     nls_control = nls_control, verbose = progress)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Predictor: n (Sample Size)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:  stats::glm(formula = reject ~ x, family = "binomial", data = reject1)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt; (Intercept)            x  </span></span>
<span><span class="co">#&gt;    -1.29076      0.03214  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Degrees of Freedom: 1799 Total (i.e. Null);  1798 Residual</span></span>
<span><span class="co">#&gt; Null Deviance:       2071 </span></span>
<span><span class="co">#&gt; Residual Deviance: 2006  AIC: 2010</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - Final Value: 77 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - Final Estimated Power: 0.7621 </span></span>
<span><span class="co">#&gt; - Confidence Interval: [0.6963; 0.8139]</span></span>
<span><span class="co">#&gt; - CI Level: 95.00%</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; =========== Phase 2: Lower Bound ===========</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Find the approximate region with power significantly above 0.8 ...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; --- Setting ---</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Algorithm:  bisection </span></span>
<span><span class="co">#&gt; Goal:  close_enough </span></span>
<span><span class="co">#&gt; What:  lb   (Lower bound of the confidence interval) </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; --- Progress  ---</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - Set 'progress = FALSE' to suppress displaying the progress.</span></span>
<span><span class="co">#&gt; - Set 'simulation progress = FALSE' to suppress displaying the progress</span></span>
<span><span class="co">#&gt;   in the simulation.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Initial interval: [50, 100] </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Initial interval: [50, 100] </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - Rejection Rates:</span></span>
<span><span class="co">#&gt; [test]: test_indirect: x-&gt;m-&gt;y </span></span>
<span><span class="co">#&gt; [test_label]: Test </span></span>
<span><span class="co">#&gt;     n   est   p.v reject r.cilo r.cihi</span></span>
<span><span class="co">#&gt; 1  50 0.150 1.000  0.589  0.521  0.656</span></span>
<span><span class="co">#&gt; 2  63 0.146 1.000  0.610  0.541  0.675</span></span>
<span><span class="co">#&gt; 3  67 0.149 1.000  0.705  0.638  0.764</span></span>
<span><span class="co">#&gt; 4  69 0.146 1.000  0.693  0.628  0.755</span></span>
<span><span class="co">#&gt; 5  71 0.156 1.000  0.790  0.728  0.841</span></span>
<span><span class="co">#&gt; 6  75 0.153 1.000  0.796  0.734  0.845</span></span>
<span><span class="co">#&gt; 7  77 0.142 1.000  0.762  0.696  0.814</span></span>
<span><span class="co">#&gt; 8  93 0.151 1.000  0.814  0.755  0.863</span></span>
<span><span class="co">#&gt; 9 100 0.151 1.000  0.881  0.828  0.918</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; == Enter extending interval ...</span></span>
<span><span class="co">#&gt; The interval is already valid: [50, 100] </span></span>
<span><span class="co">#&gt; == Exit extending interval ...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Iteration # 1 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Try x = 75 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Updating the simulation for sample size: 75 </span></span>
<span><span class="co">#&gt; Re-simulate the data:</span></span>
<span><span class="co">#&gt; Fit the model(s):</span></span>
<span><span class="co">#&gt; Generate Monte Carlo estimates:</span></span>
<span><span class="co">#&gt; Update the test(s):</span></span>
<span><span class="co">#&gt; Update test_indirect: x-&gt;m-&gt;y :</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Estimated power at 75: 0.721, 95.0% confidence interval: [0.654,0.778]</span></span>
<span><span class="co">#&gt; - Rejection Rates:</span></span>
<span><span class="co">#&gt; [test]: test_indirect: x-&gt;m-&gt;y </span></span>
<span><span class="co">#&gt; [test_label]: Test </span></span>
<span><span class="co">#&gt;      n   est   p.v reject r.cilo r.cihi</span></span>
<span><span class="co">#&gt; 1   50 0.150 1.000  0.589  0.521  0.656</span></span>
<span><span class="co">#&gt; 2   63 0.146 1.000  0.610  0.541  0.675</span></span>
<span><span class="co">#&gt; 3   67 0.149 1.000  0.705  0.638  0.764</span></span>
<span><span class="co">#&gt; 4   69 0.146 1.000  0.693  0.628  0.755</span></span>
<span><span class="co">#&gt; 5   71 0.156 1.000  0.790  0.728  0.841</span></span>
<span><span class="co">#&gt; 6   75 0.153 1.000  0.796  0.734  0.845</span></span>
<span><span class="co">#&gt; 7   75 0.147 1.000  0.721  0.654  0.778</span></span>
<span><span class="co">#&gt; 8   77 0.142 1.000  0.762  0.696  0.814</span></span>
<span><span class="co">#&gt; 9   93 0.151 1.000  0.814  0.755  0.863</span></span>
<span><span class="co">#&gt; 10 100 0.151 1.000  0.881  0.828  0.918</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; New interval: [75, 100] </span></span>
<span><span class="co">#&gt; Power curve used to find the next x ...</span></span>
<span><span class="co">#&gt; Updated x: 92 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Iteration # 2 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Try x = 92 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Updating the simulation for sample size: 92 </span></span>
<span><span class="co">#&gt; Re-simulate the data:</span></span>
<span><span class="co">#&gt; Fit the model(s):</span></span>
<span><span class="co">#&gt; Generate Monte Carlo estimates:</span></span>
<span><span class="co">#&gt; Update the test(s):</span></span>
<span><span class="co">#&gt; Update test_indirect: x-&gt;m-&gt;y :</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Estimated power at 92: 0.865, 95.0% confidence interval: [0.811,0.906]</span></span>
<span><span class="co">#&gt; - Rejection Rates:</span></span>
<span><span class="co">#&gt; [test]: test_indirect: x-&gt;m-&gt;y </span></span>
<span><span class="co">#&gt; [test_label]: Test </span></span>
<span><span class="co">#&gt;      n   est   p.v reject r.cilo r.cihi</span></span>
<span><span class="co">#&gt; 1   50 0.150 1.000  0.589  0.521  0.656</span></span>
<span><span class="co">#&gt; 2   63 0.146 1.000  0.610  0.541  0.675</span></span>
<span><span class="co">#&gt; 3   67 0.149 1.000  0.705  0.638  0.764</span></span>
<span><span class="co">#&gt; 4   69 0.146 1.000  0.693  0.628  0.755</span></span>
<span><span class="co">#&gt; 5   71 0.156 1.000  0.790  0.728  0.841</span></span>
<span><span class="co">#&gt; 6   75 0.153 1.000  0.796  0.734  0.845</span></span>
<span><span class="co">#&gt; 7   75 0.147 1.000  0.721  0.654  0.778</span></span>
<span><span class="co">#&gt; 8   77 0.142 1.000  0.762  0.696  0.814</span></span>
<span><span class="co">#&gt; 9   92 0.154 1.000  0.865  0.811  0.906</span></span>
<span><span class="co">#&gt; 10  93 0.151 1.000  0.814  0.755  0.863</span></span>
<span><span class="co">#&gt; 11 100 0.151 1.000  0.881  0.828  0.918</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - 'nls()' estimation skipped when less than 4 values of predictor examined.</span></span>
<span><span class="co">#&gt; Solution found.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ========== Final Stage ==========</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - Start at 2026-02-28 12:08:37 </span></span>
<span><span class="co">#&gt; - Rejection Rates:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [test]: test_indirect: x-&gt;m-&gt;y </span></span>
<span><span class="co">#&gt; [test_label]: Test </span></span>
<span><span class="co">#&gt;      n   est   p.v reject r.cilo r.cihi</span></span>
<span><span class="co">#&gt; 1   50 0.150 1.000  0.589  0.521  0.656</span></span>
<span><span class="co">#&gt; 2   63 0.146 1.000  0.610  0.541  0.675</span></span>
<span><span class="co">#&gt; 3   67 0.149 1.000  0.705  0.638  0.764</span></span>
<span><span class="co">#&gt; 4   69 0.146 1.000  0.693  0.628  0.755</span></span>
<span><span class="co">#&gt; 5   71 0.156 1.000  0.790  0.728  0.841</span></span>
<span><span class="co">#&gt; 6   75 0.153 1.000  0.796  0.734  0.845</span></span>
<span><span class="co">#&gt; 7   75 0.147 1.000  0.721  0.654  0.778</span></span>
<span><span class="co">#&gt; 8   77 0.142 1.000  0.762  0.696  0.814</span></span>
<span><span class="co">#&gt; 9   92 0.154 1.000  0.865  0.811  0.906</span></span>
<span><span class="co">#&gt; 10  93 0.151 1.000  0.814  0.755  0.863</span></span>
<span><span class="co">#&gt; 11 100 0.151 1.000  0.881  0.828  0.918</span></span>
<span><span class="co">#&gt; Notes:</span></span>
<span><span class="co">#&gt; - n: The sample size in a trial.</span></span>
<span><span class="co">#&gt; - p.v: The proportion of valid replications.</span></span>
<span><span class="co">#&gt; - est: The mean of the estimates in a test across replications.</span></span>
<span><span class="co">#&gt; - reject: The proportion of 'significant' replications, that is, the</span></span>
<span><span class="co">#&gt;   rejection rate. If the null hypothesis is true, this is the Type I</span></span>
<span><span class="co">#&gt;   error rate. If the null hypothesis is false, this is the power.</span></span>
<span><span class="co">#&gt; - r.cilo,r.cihi: The confidence interval of the rejection rate, based</span></span>
<span><span class="co">#&gt;   on Wilson's (1927) method.</span></span>
<span><span class="co">#&gt; - Refer to the tests for the meanings of other columns.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - Estimated Power Curve:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; power_curve(object = by_x_1, formula = power_model, start = power_curve_start, </span></span>
<span><span class="co">#&gt;     lower_bound = lower_bound, upper_bound = upper_bound, nls_args = nls_args, </span></span>
<span><span class="co">#&gt;     nls_control = nls_control, verbose = progress)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Predictor: n (Sample Size)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:  stats::glm(formula = reject ~ x, family = "binomial", data = reject1)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt; (Intercept)            x  </span></span>
<span><span class="co">#&gt;    -1.37613      0.03324  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Degrees of Freedom: 2199 Total (i.e. Null);  2198 Residual</span></span>
<span><span class="co">#&gt; Null Deviance:       2485 </span></span>
<span><span class="co">#&gt; Residual Deviance: 2403  AIC: 2407</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - Final Value: 92 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - Final Estimated Power: 0.8648 </span></span>
<span><span class="co">#&gt; - Confidence Interval: [0.8107; 0.9055]</span></span>
<span><span class="co">#&gt; - CI Level: 95.00%</span></span>
<span><span class="va">n_power_region</span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; n_region_from_power(object = out, seed = 2468)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                      Setting                                      </span></span>
<span><span class="co">#&gt; Predictor(x)         Sample Size                                  </span></span>
<span><span class="co">#&gt; Goal:                Power significantly below or above the target</span></span>
<span><span class="co">#&gt; algorithm:           bisection                                    </span></span>
<span><span class="co">#&gt; Level of confidence: 95.00%                                       </span></span>
<span><span class="co">#&gt; Target Power:        0.800                                        </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Solution: </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Approximate region of sample sizes with power:</span></span>
<span><span class="co">#&gt; - not significantly different from 0.800: 77 to 92</span></span>
<span><span class="co">#&gt; - significantly lower than 0.800: 77</span></span>
<span><span class="co">#&gt; - significantly higher than 0.800: 92</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Confidence intervals of the estimated power:</span></span>
<span><span class="co">#&gt; - for the lower bound (77): [0.696, 0.814]</span></span>
<span><span class="co">#&gt; - for the upper bound (92): [0.811, 0.906]</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call `summary()` for detailed results.</span></span></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">n_power_region</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="region_plot-1.png" alt="The Power Curve (Region)"><p class="caption">
The Power Curve (Region)
</p>
</div>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n_power_region2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/x_from_power.html">n_region_from_power</a></span><span class="op">(</span><span class="va">out_n_lb</span>,</span>
<span>                                      seed <span class="op">=</span> <span class="fl">24680</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; =========== Phase 1: Upper Bound ===========</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Find the approximate region with power significantly below 0.8 ...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; --- Setting ---</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Algorithm:  bisection </span></span>
<span><span class="co">#&gt; Goal:  close_enough </span></span>
<span><span class="co">#&gt; What:  ub   (Upper bound of the confidence interval) </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; --- Progress  ---</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - Set 'progress = FALSE' to suppress displaying the progress.</span></span>
<span><span class="co">#&gt; - Set 'simulation progress = FALSE' to suppress displaying the progress</span></span>
<span><span class="co">#&gt;   in the simulation.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Initial interval: [50, 75] </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Initial interval: [50, 75] </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - Rejection Rates:</span></span>
<span><span class="co">#&gt; [test]: test_indirect: x-&gt;m-&gt;y </span></span>
<span><span class="co">#&gt; [test_label]: Test </span></span>
<span><span class="co">#&gt;     n   est   p.v reject r.cilo r.cihi</span></span>
<span><span class="co">#&gt; 1  50 0.154 1.000  0.601  0.531  0.665</span></span>
<span><span class="co">#&gt; 2  75 0.147 1.000  0.790  0.728  0.841</span></span>
<span><span class="co">#&gt; 3  90 0.145 1.000  0.800  0.739  0.850</span></span>
<span><span class="co">#&gt; 4  96 0.148 1.000  0.853  0.800  0.897</span></span>
<span><span class="co">#&gt; 5 100 0.151 1.000  0.881  0.828  0.918</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; == Enter extending interval ...</span></span>
<span><span class="co">#&gt; The interval is already valid: [50, 75] </span></span>
<span><span class="co">#&gt; == Exit extending interval ...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Iteration # 1 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Try x = 63 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Updating the simulation for sample size: 63 </span></span>
<span><span class="co">#&gt; Re-simulate the data:</span></span>
<span><span class="co">#&gt; Fit the model(s):</span></span>
<span><span class="co">#&gt; Generate Monte Carlo estimates:</span></span>
<span><span class="co">#&gt; Update the test(s):</span></span>
<span><span class="co">#&gt; Update test_indirect: x-&gt;m-&gt;y :</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Estimated power at 63: 0.707, 95.0% confidence interval: [0.638,0.764]</span></span>
<span><span class="co">#&gt; - Rejection Rates:</span></span>
<span><span class="co">#&gt; [test]: test_indirect: x-&gt;m-&gt;y </span></span>
<span><span class="co">#&gt; [test_label]: Test </span></span>
<span><span class="co">#&gt;     n   est   p.v reject r.cilo r.cihi</span></span>
<span><span class="co">#&gt; 1  50 0.154 1.000  0.601  0.531  0.665</span></span>
<span><span class="co">#&gt; 2  63 0.156 1.000  0.707  0.638  0.764</span></span>
<span><span class="co">#&gt; 3  75 0.147 1.000  0.790  0.728  0.841</span></span>
<span><span class="co">#&gt; 4  90 0.145 1.000  0.800  0.739  0.850</span></span>
<span><span class="co">#&gt; 5  96 0.148 1.000  0.853  0.800  0.897</span></span>
<span><span class="co">#&gt; 6 100 0.151 1.000  0.881  0.828  0.918</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; New interval: [63, 75] </span></span>
<span><span class="co">#&gt; Power curve used to find the next x ...</span></span>
<span><span class="co">#&gt; Updated x: 70 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Iteration # 2 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Try x = 70 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Updating the simulation for sample size: 70 </span></span>
<span><span class="co">#&gt; Re-simulate the data:</span></span>
<span><span class="co">#&gt; Fit the model(s):</span></span>
<span><span class="co">#&gt; Generate Monte Carlo estimates:</span></span>
<span><span class="co">#&gt; Update the test(s):</span></span>
<span><span class="co">#&gt; Update test_indirect: x-&gt;m-&gt;y :</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Estimated power at 70: 0.744, 95.0% confidence interval: [0.680,0.800]</span></span>
<span><span class="co">#&gt; - Rejection Rates:</span></span>
<span><span class="co">#&gt; [test]: test_indirect: x-&gt;m-&gt;y </span></span>
<span><span class="co">#&gt; [test_label]: Test </span></span>
<span><span class="co">#&gt;     n   est   p.v reject r.cilo r.cihi</span></span>
<span><span class="co">#&gt; 1  50 0.154 1.000  0.601  0.531  0.665</span></span>
<span><span class="co">#&gt; 2  63 0.156 1.000  0.707  0.638  0.764</span></span>
<span><span class="co">#&gt; 3  70 0.153 1.000  0.744  0.680  0.800</span></span>
<span><span class="co">#&gt; 4  75 0.147 1.000  0.790  0.728  0.841</span></span>
<span><span class="co">#&gt; 5  90 0.145 1.000  0.800  0.739  0.850</span></span>
<span><span class="co">#&gt; 6  96 0.148 1.000  0.853  0.800  0.897</span></span>
<span><span class="co">#&gt; 7 100 0.151 1.000  0.881  0.828  0.918</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - 'nls()' estimation skipped when less than 4 values of predictor examined.</span></span>
<span><span class="co">#&gt; Solution found.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ========== Final Stage ==========</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - Start at 2026-02-28 12:08:45 </span></span>
<span><span class="co">#&gt; - Rejection Rates:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [test]: test_indirect: x-&gt;m-&gt;y </span></span>
<span><span class="co">#&gt; [test_label]: Test </span></span>
<span><span class="co">#&gt;     n   est   p.v reject r.cilo r.cihi</span></span>
<span><span class="co">#&gt; 1  50 0.154 1.000  0.601  0.531  0.665</span></span>
<span><span class="co">#&gt; 2  63 0.156 1.000  0.707  0.638  0.764</span></span>
<span><span class="co">#&gt; 3  70 0.153 1.000  0.744  0.680  0.800</span></span>
<span><span class="co">#&gt; 4  75 0.147 1.000  0.790  0.728  0.841</span></span>
<span><span class="co">#&gt; 5  90 0.145 1.000  0.800  0.739  0.850</span></span>
<span><span class="co">#&gt; 6  96 0.148 1.000  0.853  0.800  0.897</span></span>
<span><span class="co">#&gt; 7 100 0.151 1.000  0.881  0.828  0.918</span></span>
<span><span class="co">#&gt; Notes:</span></span>
<span><span class="co">#&gt; - n: The sample size in a trial.</span></span>
<span><span class="co">#&gt; - p.v: The proportion of valid replications.</span></span>
<span><span class="co">#&gt; - est: The mean of the estimates in a test across replications.</span></span>
<span><span class="co">#&gt; - reject: The proportion of 'significant' replications, that is, the</span></span>
<span><span class="co">#&gt;   rejection rate. If the null hypothesis is true, this is the Type I</span></span>
<span><span class="co">#&gt;   error rate. If the null hypothesis is false, this is the power.</span></span>
<span><span class="co">#&gt; - r.cilo,r.cihi: The confidence interval of the rejection rate, based</span></span>
<span><span class="co">#&gt;   on Wilson's (1927) method.</span></span>
<span><span class="co">#&gt; - Refer to the tests for the meanings of other columns.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - Estimated Power Curve:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; power_curve(object = by_x_1, formula = power_model, start = power_curve_start, </span></span>
<span><span class="co">#&gt;     lower_bound = lower_bound, upper_bound = upper_bound, nls_args = nls_args, </span></span>
<span><span class="co">#&gt;     nls_control = nls_control, verbose = progress)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Predictor: n (Sample Size)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:  stats::glm(formula = reject ~ x, family = "binomial", data = reject1)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt; (Intercept)            x  </span></span>
<span><span class="co">#&gt;    -0.96135      0.02857  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Degrees of Freedom: 1399 Total (i.e. Null);  1398 Residual</span></span>
<span><span class="co">#&gt; Null Deviance:       1517 </span></span>
<span><span class="co">#&gt; Residual Deviance: 1460  AIC: 1464</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - Final Value: 70 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - Final Estimated Power: 0.7441 </span></span>
<span><span class="co">#&gt; - Confidence Interval: [0.6804; 0.8004]</span></span>
<span><span class="co">#&gt; - CI Level: 95.00%</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; =========== Phase 2: Lower Bound ===========</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Find the approximate region with power significantly above 0.8 ...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; --- Setting ---</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Algorithm:  bisection </span></span>
<span><span class="co">#&gt; Goal:  close_enough </span></span>
<span><span class="co">#&gt; What:  lb   (Lower bound of the confidence interval) </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; --- Progress  ---</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - Set 'progress = FALSE' to suppress displaying the progress.</span></span>
<span><span class="co">#&gt; - Set 'simulation progress = FALSE' to suppress displaying the progress</span></span>
<span><span class="co">#&gt;   in the simulation.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; --- Solution Already Found ---</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Solution already found in the object. Search will be skipped.</span></span>
<span><span class="co">#&gt; - 'nls()' estimation skipped when less than 4 values of predictor examined.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ========== Final Stage ==========</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - Start at 2026-02-28 12:08:45 </span></span>
<span><span class="co">#&gt; - Rejection Rates:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [test]: test_indirect: x-&gt;m-&gt;y </span></span>
<span><span class="co">#&gt; [test_label]: Test </span></span>
<span><span class="co">#&gt;     n   est   p.v reject r.cilo r.cihi</span></span>
<span><span class="co">#&gt; 1  50 0.154 1.000  0.601  0.531  0.665</span></span>
<span><span class="co">#&gt; 2  63 0.156 1.000  0.707  0.638  0.764</span></span>
<span><span class="co">#&gt; 3  70 0.153 1.000  0.744  0.680  0.800</span></span>
<span><span class="co">#&gt; 4  75 0.147 1.000  0.790  0.728  0.841</span></span>
<span><span class="co">#&gt; 5  90 0.145 1.000  0.800  0.739  0.850</span></span>
<span><span class="co">#&gt; 6  96 0.148 1.000  0.853  0.800  0.897</span></span>
<span><span class="co">#&gt; 7 100 0.151 1.000  0.881  0.828  0.918</span></span>
<span><span class="co">#&gt; Notes:</span></span>
<span><span class="co">#&gt; - n: The sample size in a trial.</span></span>
<span><span class="co">#&gt; - p.v: The proportion of valid replications.</span></span>
<span><span class="co">#&gt; - est: The mean of the estimates in a test across replications.</span></span>
<span><span class="co">#&gt; - reject: The proportion of 'significant' replications, that is, the</span></span>
<span><span class="co">#&gt;   rejection rate. If the null hypothesis is true, this is the Type I</span></span>
<span><span class="co">#&gt;   error rate. If the null hypothesis is false, this is the power.</span></span>
<span><span class="co">#&gt; - r.cilo,r.cihi: The confidence interval of the rejection rate, based</span></span>
<span><span class="co">#&gt;   on Wilson's (1927) method.</span></span>
<span><span class="co">#&gt; - Refer to the tests for the meanings of other columns.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - Estimated Power Curve:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; power_curve(object = by_x_1, formula = power_curve_args$power_model, </span></span>
<span><span class="co">#&gt;     start = power_curve_args$start, lower_bound = power_curve_args$lower_bound, </span></span>
<span><span class="co">#&gt;     upper_bound = power_curve_args$upper_bound, nls_args = power_curve_args$nls_args, </span></span>
<span><span class="co">#&gt;     nls_control = power_curve_args$nls_control, verbose = progress)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Predictor: n (Sample Size)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:  stats::glm(formula = reject ~ x, family = "binomial", data = reject1)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt; (Intercept)            x  </span></span>
<span><span class="co">#&gt;    -0.96135      0.02857  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Degrees of Freedom: 1399 Total (i.e. Null);  1398 Residual</span></span>
<span><span class="co">#&gt; Null Deviance:       1517 </span></span>
<span><span class="co">#&gt; Residual Deviance: 1460  AIC: 1464</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - Final Value: 96 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - Final Estimated Power: 0.8529 </span></span>
<span><span class="co">#&gt; - Confidence Interval: [0.7995; 0.8971]</span></span>
<span><span class="co">#&gt; - CI Level: 95.00%</span></span>
<span><span class="va">n_power_region2</span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; n_region_from_power(object = out_n_lb, seed = 24680)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                      Setting                                      </span></span>
<span><span class="co">#&gt; Predictor(x)         Sample Size                                  </span></span>
<span><span class="co">#&gt; Goal:                Power significantly below or above the target</span></span>
<span><span class="co">#&gt; algorithm:           bisection                                    </span></span>
<span><span class="co">#&gt; Level of confidence: 95.00%                                       </span></span>
<span><span class="co">#&gt; Target Power:        0.800                                        </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Solution: </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Approximate region of sample sizes with power:</span></span>
<span><span class="co">#&gt; - not significantly different from 0.800: 70 to 96</span></span>
<span><span class="co">#&gt; - significantly lower than 0.800: 70</span></span>
<span><span class="co">#&gt; - significantly higher than 0.800: 96</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Confidence intervals of the estimated power:</span></span>
<span><span class="co">#&gt; - for the lower bound (70): [0.680, 0.800]</span></span>
<span><span class="co">#&gt; - for the upper bound (96): [0.800, 0.897]</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call `summary()` for detailed results.</span></span></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">n_power_region2</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="region_plot2-1.png" alt="The Power Curve (Region) Version 2"><p class="caption">
The Power Curve (Region) Version 2
</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Shu Fai Cheung, Sing-Hang Cheung, Wendie Yang.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
