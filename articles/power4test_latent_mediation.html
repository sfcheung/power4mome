<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Power Analysis for Latent Variable Mediation • power4mome</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Hind-0.4.10/font.css" rel="stylesheet">
<link href="../deps/Oxygen_Mono-0.4.10/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Power Analysis for Latent Variable Mediation">
<meta name="google-site-verification" content="0VLBmFnW_UJFI-7gXnORPBsWxqZwmzuGpK-TeVRLBjQ">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">power4mome</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.1.81</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/power4mome.html">Get started</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><h6 class="dropdown-header" data-toc-skip>&lt;Scenarios&gt;</h6></li>
    <li><a class="dropdown-item" href="../articles/power4test_latent_mediation.html">Latent factor mediation</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>&lt;Given Power, Find x&gt;</h6></li>
    <li><a class="dropdown-item" href="../articles/x_from_power_for_n.html">Determine the sample size with the target power</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>&lt;Technical Appendices&gt;</h6></li>
    <li><a class="dropdown-item" href="../articles/power4test_workflow.html">Workflow of `power4test()`</a></li>
    <li><a class="dropdown-item" href="../articles/x_from_power_workflow.html">Workflow of `x_from_power()` with `power_curve` Algorithm</a></li>
    <li><a class="dropdown-item" href="../articles/sim_data_i_workflow.html">Workflow of `sim_data_i()`</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-quick-templates" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Quick Templates</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-quick-templates">
<li><a class="dropdown-item" href="../articles/template_n_from_power_mediation_obs.html">Simple mediation</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/sfcheung/power4mome/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Power Analysis for Latent Variable Mediation</h1>
            
            <h4 data-toc-skip class="date">2025-06-22</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/sfcheung/power4mome/blob/main/vignettes/power4test_latent_mediation.Rmd" class="external-link"><code>vignettes/power4test_latent_mediation.Rmd</code></a></small>
      <div class="d-none name"><code>power4test_latent_mediation.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This article is a brief illustration of how to use
<code><a href="../reference/power4test.html">power4test()</a></code> from the package <a href="https://sfcheung.github.io/power4mome/">power4mome</a> to do power
analysis for the mediation effect among latent factors in a model to be
fitted by structural equation model modeling using
<code>lavaan</code>.</p>
</div>
<div class="section level2">
<h2 id="prerequisite">Prerequisite<a class="anchor" aria-label="anchor" href="#prerequisite"></a>
</h2>
<p>Basic knowledge about fitting models by <code>lavaan</code> is
required. Readers are also expected to have basic knowledge of mediation
and structural equation modeling.</p>
</div>
<div class="section level2">
<h2 id="scope">Scope<a class="anchor" aria-label="anchor" href="#scope"></a>
</h2>
<p>To make this vignette self-contained, some sections from
<code><a href="../articles/power4mome.html">vignette("power4mome")</a></code> is repeated here.</p>
<p>To do power analysis for a mediation effect in a path model with no
latent factors, please refer to <code><a href="../articles/power4mome.html">vignette("power4mome")</a></code>.</p>
</div>
<div class="section level2">
<h2 id="package">Package<a class="anchor" aria-label="anchor" href="#package"></a>
</h2>
<p>This introduction only needs the following package:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://sfcheung.github.io/power4mome/">power4mome</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="workflow">Workflow<a class="anchor" aria-label="anchor" href="#workflow"></a>
</h2>
<p>Two functions are sufficient for estimating power given a model,
population values, sample size, and the test to be used. This is the
basic workflow:</p>
<ol style="list-style-type: decimal">
<li><p>Specify the model syntax for the population model, in
<code>lavaan</code> style, and set the population values of the model
parameters.</p></li>
<li><p>Call <code><a href="../reference/power4test.html">power4test()</a></code> to examine the setup and the
datasets generated. Repeat previous steps until the model is specified
correctly.</p></li>
<li><p>Call <code><a href="../reference/power4test.html">power4test()</a></code> again, with the test to do
specified.</p></li>
<li><p>Call <code><a href="../reference/rejection_rates.html">rejection_rates()</a></code> to compute the
power.</p></li>
</ol>
</div>
<div class="section level2">
<h2 id="mediation">Mediation<a class="anchor" aria-label="anchor" href="#mediation"></a>
</h2>
<p>Let’s consider a simple mediation model with three factors. We would
like to estimate the power of testing the mediation effect by Monte
Carlo confidence interval.</p>
<div class="section level3">
<h3 id="specify-the-population-model">Specify the Population Model<a class="anchor" aria-label="anchor" href="#specify-the-population-model"></a>
</h3>
<p>For a model with latent factor, we only need to specify the model
syntax for the <em>factors</em>. No need to include the measurement part
and the indicators.</p>
<p>This is the model syntax:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod</span> <span class="op">&lt;-</span></span>
<span><span class="st">"</span></span>
<span><span class="st">fm ~ fx</span></span>
<span><span class="st">fy ~ fm + fx</span></span>
<span><span class="st">"</span></span></code></pre></div>
<p>The latent variables are <code>fx</code>, <code>fm</code>, and
<code>fy</code>. There is an indirect path from <code>fx</code> to
<code>fy</code>, through <code>fm</code>.</p>
<p>Note that, even if we are going to test a mediation effect, we do not
need to add any labels to this model. This will be taken care of by the
test functions, through the use of the package <a href="https://sfcheung.github.io/manymome/" class="external-link"><code>manymome</code></a>
<span class="citation">(Cheung &amp; Cheung, 2024)</span>.</p>
</div>
<div class="section level3">
<h3 id="es_convention">Specify The Population Values<a class="anchor" aria-label="anchor" href="#es_convention"></a>
</h3>
<p>There are two approaches to do this: using named vectors or lists, or
using a long string similar to <code>lavaan</code> model syntax. The
second approach is demonstrated below.</p>
<p>Suppose we want to estimate the power when:</p>
<ul>
<li><p>The path from <code>fx</code> to <code>fm</code> are “large” in
strength.</p></li>
<li><p>The path from <code>fm</code> to <code>fy</code> are “large” in
strength.</p></li>
<li><p>The path from <code>fx</code> to <code>fm</code> are “small” in
strength.</p></li>
</ul>
<p>By default, <code>power4mome</code> use this convention for
regression path and correlation:<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt; Users can explicitly specify the values if this
convention is not suitable.&lt;/p&gt;"><sup>1</sup></a></p>
<ul>
<li><p>Small: .10 (or -.10)</p></li>
<li><p>Medium: .30 (or -.30)</p></li>
<li><p>Large: .50 (or -.50)</p></li>
</ul>
<p>All these values are for the standardized solution (the correlations
and so-called “betas”).</p>
<p>The following string denotes the desired values:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod_es</span> <span class="op">&lt;-</span></span>
<span><span class="st">"</span></span>
<span><span class="st">fm ~ fx: l</span></span>
<span><span class="st">fy ~ fm: l</span></span>
<span><span class="st">fy ~ fx: s</span></span>
<span><span class="st">"</span></span></code></pre></div>
<p>Each line starts with a <em>tag</em>, which is the parameter
presented in <code>lavaan</code> syntax. The tag ends with a colon,
<code>:</code>.</p>
<p>After the colon is <em>population value</em>, which can be:</p>
<ul>
<li>
<p>A string denoting the value. By default:</p>
<ul>
<li><p><code>s</code>: Small. (<code>-s</code> for small and
negative.)</p></li>
<li><p><code>m</code>: Medium. (<code>-m</code> for medium and
negative.)</p></li>
<li><p><code>l</code>: Large. (<code>-l</code> for large and
negative.)</p></li>
<li><p><code>nil</code>: Zero.</p></li>
</ul>
</li>
</ul>
<p>All other regression coefficients and covariances, if not specified
in this string, are set to zero.</p>
</div>
<div class="section level3">
<h3 id="measurement">Specify the Measurement Part<a class="anchor" aria-label="anchor" href="#measurement"></a>
</h3>
<p>Power analysis is usually conducted before data collection. We rarely
know in advance the factor loadings of all items. For the purpose of
power analysis, which is not intended to be conducted with the knowledge
of all factor loadings, we believe that, instead of specify explicitly
all the loadings, it is sufficient to specify two values for each
factor:</p>
<ul>
<li><p>The number of indicators.</p></li>
<li><p>The population reliability.</p></li>
</ul>
<p>This is the approach used in <code>power4mome</code>. For each
factor, the population standardized factor loadings for each indicator
will be derived automatically from the hypothesized (or expected)
population reliability and the number of indicators, assuming that all
indicators have equal loadings.</p>
<p>Although the equal-loading is unrealistic, in <em>a priori</em> power
analysis, it is difficult, if not impossible, to specify the pattern of
factor loadings. This level of details is also not necessary because the
power estimated is merely used to guide the planning of data collection,
instead of estimating the “true” power after data is collected.</p>
<p>Two argument will be used to set the number of indicators and the
reliability.</p>
<ul>
<li><p><code>number_of_indicators</code>: This should be a
<em>named</em> vector of the number of indicators for each factor. The
names are the names of the factors as appeared in the model syntax, and
the values are the number of indicators.</p></li>
<li><p><code>reliability</code>: This should be a <em>named</em> vector
of the reliability for each factor. The names are the names of the
factors as appeared in the model syntax, and the values are population
reliability.</p></li>
</ul>
<p>For example, suppose we will use the following vectors:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">k</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>fm <span class="op">=</span> <span class="fl">3</span>, fx <span class="op">=</span> <span class="fl">4</span>, fy <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod_rel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>fy <span class="op">=</span> <span class="fl">.70</span>, fm <span class="op">=</span> <span class="fl">.60</span>, fx <span class="op">=</span> <span class="fl">.50</span><span class="op">)</span></span></code></pre></div>
<p>The numbers of indicators for <code>fx</code>, <code>fm</code>, and
<code>fy</code> are 4, 3, and 5, respectively.</p>
<p>The population reliability coefficients for <code>fx</code>,
<code>fm</code>, and <code>fy</code> are .50, .60, and .70,
respectively. In real research, reliability as low as .50 can be
problematic. We chose these values merely for illustration</p>
<p>The orders are intentionally arbitrary, to demonstrate the order does
not matter. The names will be used to interpret the numbers
correctly.</p>
</div>
<div class="section level3">
<h3 id="call-power4test-to-check-the-model">Call <code>power4test()</code> to Check the Model<a class="anchor" aria-label="anchor" href="#call-power4test-to-check-the-model"></a>
</h3>
<p>We are all set and can call <code><a href="../reference/power4test.html">power4test()</a></code> to check the
model:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/power4test.html">power4test</a></span><span class="op">(</span>nrep <span class="op">=</span> <span class="fl">2</span>,</span>
<span>                  model <span class="op">=</span> <span class="va">mod</span>,</span>
<span>                  pop_es <span class="op">=</span> <span class="va">mod_es</span>,</span>
<span>                  number_of_indicators <span class="op">=</span> <span class="va">k</span>,</span>
<span>                  reliability <span class="op">=</span> <span class="va">mod_rel</span>,</span>
<span>                  n <span class="op">=</span> <span class="fl">50000</span>,</span>
<span>                  iseed <span class="op">=</span> <span class="fl">1234</span><span class="op">)</span></span></code></pre></div>
<p>These are the arguments used:</p>
<ul>
<li><p><code>nrep</code>: The number of replications. In this stage, a
small number can be used. It is more important to have a large sample
size than to have many replications.</p></li>
<li><p><code>model</code>: The model syntax.</p></li>
<li><p><code>pop_es</code>: The string setting the population
values.</p></li>
<li><p><code>number_of_indicators</code>: A named vector of the number
of indicators for each factor, described in the previous
section.</p></li>
<li><p><code>reliability</code>: A named vector of the population
reliability for each factor, described in the previous section.</p></li>
<li><p><code>n</code>: The sample size in each replications. In this
stage, just for checking the model and the data generation, this number
can be set to a large one unless the model is slow to fit when the
sample size is large.</p></li>
<li><p><code>iseed</code>: If supplied, it is used to set the seed for
the random number generator. It is advised to always set this to an
arbitrary integer, to make the results reproducible.<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;The functions used are
&lt;code&gt;&lt;a href="https://rdrr.io/r/parallel/RngStream.html" class="external-link"&gt;parallel::clusterSetRNGStream()&lt;/a&gt;&lt;/code&gt; for parallel processing,
and &lt;code&gt;&lt;a href="https://rdrr.io/r/base/Random.html" class="external-link"&gt;set.seed()&lt;/a&gt;&lt;/code&gt; for serial processing.&lt;/p&gt;'><sup>2</sup></a></p></li>
</ul>
<p>The population values can be shown by printing this object:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ====================== Model Information ======================</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; == Model on Factors/Variables ==</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; fm ~ fx</span></span>
<span><span class="co">#&gt; fy ~ fm + fx</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; == Model on Variables/Indicators ==</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; fm ~ fx</span></span>
<span><span class="co">#&gt; fy ~ fm + fx</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; fm =~ fm1 + fm2 + fm3</span></span>
<span><span class="co">#&gt; fx =~ fx1 + fx2 + fx3 + fx4</span></span>
<span><span class="co">#&gt; fy =~ fy1 + fy2 + fy3 + fy4 + fy5</span></span>
<span><span class="co">#&gt; ====== Population Values ======</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Regressions:</span></span>
<span><span class="co">#&gt;                    Population</span></span>
<span><span class="co">#&gt;   fm ~                       </span></span>
<span><span class="co">#&gt;     fx                0.500  </span></span>
<span><span class="co">#&gt;   fy ~                       </span></span>
<span><span class="co">#&gt;     fm                0.500  </span></span>
<span><span class="co">#&gt;     fx                0.100  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Variances:</span></span>
<span><span class="co">#&gt;                    Population</span></span>
<span><span class="co">#&gt;    .fm                0.750  </span></span>
<span><span class="co">#&gt;    .fy                0.690  </span></span>
<span><span class="co">#&gt;     fx                1.000  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; (Computing indirect effects for 1 paths ...)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; == Population Indirect Effect(s) ==</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ==  Indirect Effect(s)   ==</span></span>
<span><span class="co">#&gt;                  ind</span></span>
<span><span class="co">#&gt; fx -&gt; fm -&gt; fy 0.250</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  - The 'ind' column shows the indirect effects.</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; ==== Population Reliability ====</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   fy  fm  fx</span></span>
<span><span class="co">#&gt;  0.7 0.6 0.5</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; == Population Standardized Loadings ==</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     fm    fx    fy</span></span>
<span><span class="co">#&gt;  0.661 0.522 0.408</span></span>
<span><span class="co">#&gt; ======================= Data Information =======================</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of Replications:  2 </span></span>
<span><span class="co">#&gt; Sample Sizes:  50000 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call print with 'data_long = TRUE' for further information.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ==================== Extra Element(s) Found ====================</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - fit</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; === Element(s) of the First Dataset ===</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ============ &lt;fit&gt; ============</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; lavaan 0.6-19 ended normally after 44 iterations</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Estimator                                         ML</span></span>
<span><span class="co">#&gt;   Optimization method                           NLMINB</span></span>
<span><span class="co">#&gt;   Number of model parameters                        27</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Number of observations                         50000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model Test User Model:</span></span>
<span><span class="co">#&gt;                                                       </span></span>
<span><span class="co">#&gt;   Test statistic                                38.042</span></span>
<span><span class="co">#&gt;   Degrees of freedom                                51</span></span>
<span><span class="co">#&gt;   P-value (Chi-square)                           0.910</span></span></code></pre></div>
<p>By the default, the population model will be fitted to each dataset,
hence the section <code>&lt;fit&gt;</code>. The fit is not “perfect”
because the model is not a saturated model. However, the
<em>p</em>-value is high and not significant (because, with the
population model fitted, the chance of significant is close to .05).</p>
<p>Although we specify only the structure for the latent factors, we can
see the automatically generated measurement part syntax in the section
<code>Model on Variables/Indicators</code>:</p>
<pre><code><span><span class="co">#&gt; fm =~ fm1 + fm2 + fm3</span></span>
<span><span class="co">#&gt; fx =~ fx1 + fx2 + fx3 + fx4</span></span>
<span><span class="co">#&gt; fy =~ fy1 + fy2 + fy3 + fy4 + fy5</span></span></code></pre>
<p>It confirmed that we specified the measurement part correctly.</p>
<p>We then check the section <code>Population Values</code> to see
whether the values are what we expected.</p>
<ul>
<li>In this example, the population values for the regression paths are
what we specified.</li>
</ul>
<p>If they are different from what we expect, check the string for
<code>pop_es</code> to see whether we set the population values
correctly.</p>
<ul>
<li>The section <code>Variances:</code> shows the variances or
<em>error</em> variances of the latent factors. Because <code>fm</code>
and <code>fy</code> are endogenous factors, the values presented, next
to <code>.fm</code> and <code>.fy</code>, are error variances, and
that’s why they are not 1, unlike <code>fx</code>.</li>
</ul>
<p>The section <code>Population Reliability</code> shows the population
reliability coefficients:</p>
<pre><code><span><span class="co">#&gt; ==== Population Reliability ====</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   fy  fm  fx</span></span>
<span><span class="co">#&gt;  0.7 0.6 0.5</span></span></code></pre>
<p>They are the values we set to <code>reliability</code>.</p>
<p>The section <code>Population Standardized Loadings</code> shows the
standardized factor loadings for each factor. Only one value for each
factor because the loadings are assumed to be the same for all
items:</p>
<pre><code><span><span class="co">#&gt; == Population Standardized Loadings ==</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     fm    fx    fy</span></span>
<span><span class="co">#&gt;  0.661 0.522 0.408</span></span></code></pre>
<p>If necessary, we can check the data generation by adding
<code>data_long = TRUE</code> when printing the output:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">out</span>,</span>
<span>      data_long <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>Two new sections will be printed. This is the first one:</p>
<pre><code><span><span class="co">#&gt; ==== Descriptive Statistics ====</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     vars     n mean   sd  skew kurtosis se</span></span>
<span><span class="co">#&gt; fm1    1 1e+05 0.00 1.00  0.01     0.00  0</span></span>
<span><span class="co">#&gt; fm2    2 1e+05 0.01 1.00  0.01    -0.01  0</span></span>
<span><span class="co">#&gt; fm3    3 1e+05 0.00 1.01  0.00    -0.02  0</span></span>
<span><span class="co">#&gt; fx1    4 1e+05 0.00 1.00  0.00     0.00  0</span></span>
<span><span class="co">#&gt; fx2    5 1e+05 0.00 1.00 -0.01     0.00  0</span></span>
<span><span class="co">#&gt; fx3    6 1e+05 0.00 1.00 -0.01    -0.02  0</span></span>
<span><span class="co">#&gt; fx4    7 1e+05 0.00 1.00  0.00     0.00  0</span></span>
<span><span class="co">#&gt; fy1    8 1e+05 0.00 1.00  0.01     0.01  0</span></span>
<span><span class="co">#&gt; fy2    9 1e+05 0.00 1.00  0.01     0.00  0</span></span>
<span><span class="co">#&gt; fy3   10 1e+05 0.00 1.00  0.00     0.01  0</span></span>
<span><span class="co">#&gt; fy4   11 1e+05 0.01 1.00  0.01     0.00  0</span></span>
<span><span class="co">#&gt; fy5   12 1e+05 0.00 1.00  0.02    -0.01  0</span></span></code></pre>
<p>The section <code>Descriptive Statistics</code>, generated by
<code><a href="https://rdrr.io/pkg/psych/man/describe.html" class="external-link">psych::describe()</a></code>, shows basic descriptive statistics for
indicators. As expected, they have means close to zero and standard
deviations close to one, because the datasets were generated using the
standardized model.</p>
<p>This is the second one:</p>
<pre><code><span><span class="co">#&gt; fy5   12 1e+05 0.00 1.00  0.02    -0.01  0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ===== Parameter Estimates Based on All 2 Samples Combined =====</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Total Sample Size: 100000 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ==== Standardized Estimates ====</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Variances and error variances omitted.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Latent Variables:</span></span>
<span><span class="co">#&gt;                     est.std</span></span>
<span><span class="co">#&gt;   fm =~                    </span></span>
<span><span class="co">#&gt;     fm1               0.578</span></span>
<span><span class="co">#&gt;     fm2               0.579</span></span>
<span><span class="co">#&gt;     fm3               0.578</span></span>
<span><span class="co">#&gt;   fx =~                    </span></span>
<span><span class="co">#&gt;     fx1               0.445</span></span>
<span><span class="co">#&gt;     fx2               0.443</span></span>
<span><span class="co">#&gt;     fx3               0.445</span></span>
<span><span class="co">#&gt;     fx4               0.445</span></span>
<span><span class="co">#&gt;   fy =~                    </span></span>
<span><span class="co">#&gt;     fy1               0.559</span></span>
<span><span class="co">#&gt;     fy2               0.560</span></span>
<span><span class="co">#&gt;     fy3               0.563</span></span>
<span><span class="co">#&gt;     fy4               0.565</span></span>
<span><span class="co">#&gt;     fy5               0.569</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Regressions:</span></span>
<span><span class="co">#&gt;                     est.std</span></span>
<span><span class="co">#&gt;   fm ~                     </span></span>
<span><span class="co">#&gt;     fx                0.504</span></span>
<span><span class="co">#&gt;   fy ~                     </span></span>
<span><span class="co">#&gt;     fm                0.505</span></span>
<span><span class="co">#&gt;     fx                0.097</span></span></code></pre>
<p>The section <code>Parameter Estimates Based on</code> shows the
parameter estimates when the <em>population model</em> is fitted to
<em>all the datasets combined</em>. When the total sample size is large,
these estimates should be close to the population values.</p>
<p>The results show that we have specified the population model
correctly. We can proceed to specify the test and estimate the
power.</p>
</div>
<div class="section level3">
<h3 id="med_power">Call <code>power4test()</code> to Do the Target Test<a class="anchor" aria-label="anchor" href="#med_power"></a>
</h3>
<p>We can now do the simulation to estimate power. A large number of
datasets (e.g., 400) of the target sample size are to be generated, and
then the target test will be conducted in each of these datasets.</p>
<p>Suppose we would like to estimate the power of using Monte Carlo
confidence interval to test the indirect effect from <code>fx</code> to
<code>fy</code> through <code>fm</code>, when sample size is 150. This
is the call:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/power4test.html">power4test</a></span><span class="op">(</span>nrep <span class="op">=</span> <span class="fl">400</span>,</span>
<span>                  model <span class="op">=</span> <span class="va">mod</span>,</span>
<span>                  pop_es <span class="op">=</span> <span class="va">mod_es</span>,</span>
<span>                  number_of_indicators <span class="op">=</span> <span class="va">k</span>,</span>
<span>                  reliability <span class="op">=</span> <span class="va">mod_rel</span>,</span>
<span>                  n <span class="op">=</span> <span class="fl">150</span>,</span>
<span>                  R <span class="op">=</span> <span class="fl">2000</span>,</span>
<span>                  ci_type <span class="op">=</span> <span class="st">"mc"</span>,</span>
<span>                  test_fun <span class="op">=</span> <span class="va">test_indirect_effect</span>,</span>
<span>                  test_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"fx"</span>,</span>
<span>                                   m <span class="op">=</span> <span class="st">"fm"</span>,</span>
<span>                                   y <span class="op">=</span> <span class="st">"fy"</span>,</span>
<span>                                   mc_ci <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>                  iseed <span class="op">=</span> <span class="fl">1234</span>,</span>
<span>                  parallel <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>These are the new arguments used:</p>
<ul>
<li><p><code>R</code>: The number of replications used to generate the
Monte Carlo simulated estimates, 2000 in this example. In real studies,
this number should be 10000 or even 20000 for Monte Carlo confidence
intervals. However, 2000 is sufficient because the goal is to estimate
power by generating many intervals, rather than to have one single
stable interval.</p></li>
<li><p><code>ci_type</code>: The method used to generate estimates.
Support both Monte Carlo (<code>"mc"</code>) and nonparametric
bootstrapping (<code>"boot"</code>).<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;They are implemented by &lt;code&gt;&lt;a href="https://sfcheung.github.io/manymome/reference/do_mc.html" class="external-link"&gt;manymome::do_mc()&lt;/a&gt;&lt;/code&gt;
and &lt;code&gt;&lt;a href="https://sfcheung.github.io/manymome/reference/do_boot.html" class="external-link"&gt;manymome::do_boot()&lt;/a&gt;&lt;/code&gt;, respectively.&lt;/p&gt;'><sup>3</sup></a> Although bootstrapping is usually used to
test an indirect effect, it is very slow to do <code>R</code>
bootstrapping in <code>nrep</code> datasets (the model will be fitted
<code>R * nrep</code> times). Therefore, it is preferable to use Monte
Carlo to do the initial estimation.</p></li>
<li><p><code>test_fun</code>: The function to be used to do the test for
each replication. Any function following a specific requirement can be
used, and <code>power4mome</code> comes with several built-in functions
for some common tests. The function <code><a href="../reference/test_indirect_effect.html">test_indirect_effect()</a></code>
is used to test an indirect effect in the model.</p></li>
<li><p><code>test_args</code>: A named list of arguments to be supplied
to <code>test_fun</code>. For <code><a href="../reference/test_indirect_effect.html">test_indirect_effect()</a></code>, it is
a named list specifying the predictor (<code>x</code>), the mediator(s)
(<code>m</code>), and the outcome (<code>y</code>). A path with any
number of mediators can be supported. Please refer to the help page of
<code><a href="../reference/test_indirect_effect.html">test_indirect_effect()</a></code>.<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;The test is implemented by
&lt;code&gt;manymome::indirect()&lt;/code&gt;.&lt;/p&gt;"><sup>4</sup></a></p></li>
<li><p><code>parallel</code>: If the test to be conducted is slow, which
is the case for tests done by Monte Carlo or nonparametric bootstrapping
confidence interval, it is advised to enable parallel processing by
setting <code>parallel</code> to <code>TRUE</code>.<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;The number of cores is determined automatically but can
be set directly by the &lt;code&gt;ncores&lt;/code&gt; argument.&lt;/p&gt;"><sup>5</sup></a></p></li>
</ul>
<p>For <code>nrep = 400</code>, the 95% confidence limits for a power of
.80 are about .04 below and above .80. This should be precise enough for
determining whether a sample size has sufficient power.</p>
<p>This is the default printout:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ====================== Model Information ======================</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; == Model on Factors/Variables ==</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; fm ~ fx</span></span>
<span><span class="co">#&gt; fy ~ fm + fx</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; == Model on Variables/Indicators ==</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; fm ~ fx</span></span>
<span><span class="co">#&gt; fy ~ fm + fx</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; fm =~ fm1 + fm2 + fm3</span></span>
<span><span class="co">#&gt; fx =~ fx1 + fx2 + fx3 + fx4</span></span>
<span><span class="co">#&gt; fy =~ fy1 + fy2 + fy3 + fy4 + fy5</span></span>
<span><span class="co">#&gt; ====== Population Values ======</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Regressions:</span></span>
<span><span class="co">#&gt;                    Population</span></span>
<span><span class="co">#&gt;   fm ~                       </span></span>
<span><span class="co">#&gt;     fx                0.500  </span></span>
<span><span class="co">#&gt;   fy ~                       </span></span>
<span><span class="co">#&gt;     fm                0.500  </span></span>
<span><span class="co">#&gt;     fx                0.100  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Variances:</span></span>
<span><span class="co">#&gt;                    Population</span></span>
<span><span class="co">#&gt;    .fm                0.750  </span></span>
<span><span class="co">#&gt;    .fy                0.690  </span></span>
<span><span class="co">#&gt;     fx                1.000  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; (Computing indirect effects for 1 paths ...)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; == Population Indirect Effect(s) ==</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ==  Indirect Effect(s)   ==</span></span>
<span><span class="co">#&gt;                  ind</span></span>
<span><span class="co">#&gt; fx -&gt; fm -&gt; fy 0.250</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  - The 'ind' column shows the indirect effects.</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; ==== Population Reliability ====</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   fy  fm  fx</span></span>
<span><span class="co">#&gt;  0.7 0.6 0.5</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; == Population Standardized Loadings ==</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     fm    fx    fy</span></span>
<span><span class="co">#&gt;  0.661 0.522 0.408</span></span>
<span><span class="co">#&gt; ======================= Data Information =======================</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of Replications:  400 </span></span>
<span><span class="co">#&gt; Sample Sizes:  150 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call print with 'data_long = TRUE' for further information.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ==================== Extra Element(s) Found ====================</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - fit</span></span>
<span><span class="co">#&gt; - mc_out</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; === Element(s) of the First Dataset ===</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ============ &lt;fit&gt; ============</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; lavaan 0.6-19 ended normally after 38 iterations</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Estimator                                         ML</span></span>
<span><span class="co">#&gt;   Optimization method                           NLMINB</span></span>
<span><span class="co">#&gt;   Number of model parameters                        27</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Number of observations                           150</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model Test User Model:</span></span>
<span><span class="co">#&gt;                                                       </span></span>
<span><span class="co">#&gt;   Test statistic                                69.181</span></span>
<span><span class="co">#&gt;   Degrees of freedom                                51</span></span>
<span><span class="co">#&gt;   P-value (Chi-square)                           0.046</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; =========== &lt;mc_out&gt; ===========</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; == A 'mc_out' class object ==</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of Monte Carlo replications: 2000 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ====================== Test(s) Conducted ======================</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; - test_indirect: fx-&gt;fm-&gt;fy</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call print() and set 'test_long = TRUE' for a detailed report.</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="compute-the-power">Compute the Power<a class="anchor" aria-label="anchor" href="#compute-the-power"></a>
</h3>
<p>The power estimate is simply the proportion of significant results,
the <em>rejection</em> <em>rate</em>, because the null hypothesis is
false. The rejection rate can be retrieved by
<code><a href="../reference/rejection_rates.html">rejection_rates()</a></code>.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out_power</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rejection_rates.html">rejection_rates</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span></span>
<span><span class="va">out_power</span></span>
<span><span class="co">#&gt; [test]: test_indirect: fx-&gt;fm-&gt;fy </span></span>
<span><span class="co">#&gt; [test_label]: Test </span></span>
<span><span class="co">#&gt;     est   p.v reject r.cilo r.cihi</span></span>
<span><span class="co">#&gt; 1 0.336 1.000  0.492  0.444  0.541</span></span>
<span><span class="co">#&gt; Notes:</span></span>
<span><span class="co">#&gt; - p.v: The proportion of valid replications.</span></span>
<span><span class="co">#&gt; - est: The mean of the estimates in a test across replications.</span></span>
<span><span class="co">#&gt; - reject: The proportion of 'significant' replications, that is, the</span></span>
<span><span class="co">#&gt;   rejection rate. If the null hypothesis is true, this is the Type I</span></span>
<span><span class="co">#&gt;   error rate. If the null hypothesis is false, this is the power.</span></span>
<span><span class="co">#&gt; - r.cilo,r.cihi: The confidence interval of the rejection rate, based</span></span>
<span><span class="co">#&gt;   on normal approximation.</span></span>
<span><span class="co">#&gt; - Refer to the tests for the meanings of other columns.</span></span></code></pre></div>
<p>In the example above, the estimated power of the test of the indirect
effect, conducted by Monte Carlo confidence interval, is 0.492, under
the column <code>reject</code>.</p>
<p><code>p.v</code> is the proportion of valid results across
replications. <code>1.000</code> means that the test conducted normally
in all replications.</p>
<p>By default, the 95% confidence interval of the rejection rate (power)
based on normal approximation is also printed, under the column
<code>r.cilo</code> and <code>r.cihi</code>. In this example, the 95%
confidence interval is [0.444; 0.541].</p>
</div>
</div>
<div class="section level2">
<h2 id="new_n">Repeat a Simulation With A Different Sample Size<a class="anchor" aria-label="anchor" href="#new_n"></a>
</h2>
<p>The function <code><a href="../reference/power4test.html">power4test()</a></code> also supports <em>redoing</em>
an analysis using a new value for the sample size (or population effect
sizes set to <code>pop_es</code>). Simply</p>
<ul>
<li><p>set the output of <code>power4test</code> as the first argument,
and</p></li>
<li><p>set the <em>new value</em> for <code>n</code>.</p></li>
</ul>
<p>For example, we can repeat the simulation for the test of indirect
effect, but for a smaller sample size of 100. We simply call
<code><a href="../reference/power4test.html">power4test()</a></code> again, set the previous output
(<code>out</code> in the example for moderation) as the first argument,
and set <code>n</code> to a new value (100 in this example):</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out_new_n</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/power4test.html">power4test</a></span><span class="op">(</span><span class="va">out</span>,</span>
<span>                        n <span class="op">=</span> <span class="fl">200</span><span class="op">)</span></span>
<span><span class="va">out_new_n</span></span></code></pre></div>
<p>This is the estimated power when the sample size is 200.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out_new_n_reject</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rejection_rates.html">rejection_rates</a></span><span class="op">(</span><span class="va">out_new_n</span><span class="op">)</span></span>
<span><span class="va">out_new_n_reject</span></span>
<span><span class="co">#&gt; [test]: test_indirect: fx-&gt;fm-&gt;fy </span></span>
<span><span class="co">#&gt; [test_label]: Test </span></span>
<span><span class="co">#&gt;     est   p.v reject r.cilo r.cihi</span></span>
<span><span class="co">#&gt; 1 0.352 1.000  0.815  0.777  0.853</span></span>
<span><span class="co">#&gt; Notes:</span></span>
<span><span class="co">#&gt; - p.v: The proportion of valid replications.</span></span>
<span><span class="co">#&gt; - est: The mean of the estimates in a test across replications.</span></span>
<span><span class="co">#&gt; - reject: The proportion of 'significant' replications, that is, the</span></span>
<span><span class="co">#&gt;   rejection rate. If the null hypothesis is true, this is the Type I</span></span>
<span><span class="co">#&gt;   error rate. If the null hypothesis is false, this is the power.</span></span>
<span><span class="co">#&gt; - r.cilo,r.cihi: The confidence interval of the rejection rate, based</span></span>
<span><span class="co">#&gt;   on normal approximation.</span></span>
<span><span class="co">#&gt; - Refer to the tests for the meanings of other columns.</span></span></code></pre></div>
<p>The estimated power is 0.815, 95% confidence interval [0.777; 0.853],
when the sample size is 200.</p>
<p>This technique can be repeated to find the required sample size for a
target power.</p>
</div>
<div class="section level2">
<h2 id="repeat-a-simulation-with-different-numbers-of-indicators-or-reliability">Repeat a Simulation With Different Numbers of Indicators or
Reliability<a class="anchor" aria-label="anchor" href="#repeat-a-simulation-with-different-numbers-of-indicators-or-reliability"></a>
</h2>
<p>We can also redo an analysis using a new values for reliability. We
know that the power is low with 150 cases. We may want to see whether we
can have a higher power if we use more reliable scales.</p>
<p>As in the previous example, we just call <code><a href="../reference/power4test.html">power4test()</a></code>
one the original output, but set <code>reliability</code> to a new
vector.</p>
<p>Assume that we want to know the power for the same scenario, but with
all scales having a population reliability of .80:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out_new_rel</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/power4test.html">power4test</a></span><span class="op">(</span><span class="va">out</span>,</span>
<span>                          reliability <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>fx <span class="op">=</span> <span class="fl">.80</span>,</span>
<span>                                          fm <span class="op">=</span> <span class="fl">.80</span>,</span>
<span>                                          fy <span class="op">=</span> <span class="fl">.80</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">out_new_rel</span></span></code></pre></div>
<p>This is the estimated power with higher population reliability:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out_new_rel_reject</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rejection_rates.html">rejection_rates</a></span><span class="op">(</span><span class="va">out_new_rel</span><span class="op">)</span></span>
<span><span class="va">out_new_rel_reject</span></span>
<span><span class="co">#&gt; [test]: test_indirect: fx-&gt;fm-&gt;fy </span></span>
<span><span class="co">#&gt; [test_label]: Test </span></span>
<span><span class="co">#&gt;     est   p.v reject r.cilo r.cihi</span></span>
<span><span class="co">#&gt; 1 0.235 1.000  0.985  0.973  0.997</span></span>
<span><span class="co">#&gt; Notes:</span></span>
<span><span class="co">#&gt; - p.v: The proportion of valid replications.</span></span>
<span><span class="co">#&gt; - est: The mean of the estimates in a test across replications.</span></span>
<span><span class="co">#&gt; - reject: The proportion of 'significant' replications, that is, the</span></span>
<span><span class="co">#&gt;   rejection rate. If the null hypothesis is true, this is the Type I</span></span>
<span><span class="co">#&gt;   error rate. If the null hypothesis is false, this is the power.</span></span>
<span><span class="co">#&gt; - r.cilo,r.cihi: The confidence interval of the rejection rate, based</span></span>
<span><span class="co">#&gt;   on normal approximation.</span></span>
<span><span class="co">#&gt; - Refer to the tests for the meanings of other columns.</span></span></code></pre></div>
<p>The estimated power is 0.985, 95% confidence interval [0.973; 0.997],
much higher than the original scenario.</p>
</div>
<div class="section level2">
<h2 id="find-the-sample-size-with-desired-power">Find the Sample Size With Desired Power<a class="anchor" aria-label="anchor" href="#find-the-sample-size-with-desired-power"></a>
</h2>
<p>There are two more efficient ways to find the sample size with
desired power.</p>
<div class="section level3">
<h3 id="using-power4test_by_n">Using <code>power4test_by_n()</code><a class="anchor" aria-label="anchor" href="#using-power4test_by_n"></a>
</h3>
<p>First, the function <code><a href="../reference/power4test_by_n.html">power4test_by_n()</a></code> can be used To
estimate the power for a sequence of sample sizes. For example, suppose
we do not know that the power is about .80 with a sample size of 200. We
can estimate the power in the mediation model above for these sample
sizes: 175, 200, 225, 250.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out_several_ns</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/power4test_by_n.html">power4test_by_n</a></span><span class="op">(</span><span class="va">out</span>,</span>
<span>                                  n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">175</span>, <span class="fl">200</span>, <span class="fl">225</span>, <span class="fl">250</span><span class="op">)</span>,</span>
<span>                                  by_seed <span class="op">=</span> <span class="fl">4567</span><span class="op">)</span></span></code></pre></div>
<p>The first argument is the output of <code><a href="../reference/power4test.html">power4test()</a></code> for an
arbitrary sample size.</p>
<p>The argument <code>n</code> is a numeric vector of sample sizes to
examine. For each <code>n</code>, <code>nrep</code> datasets will be
generated. Although there is no limit on the number of sample sizes to
try, it is recommended to restrict the number of sample sizes to 5 or
less.</p>
<p>The argument <code>by_seed</code>, if set to an integer, try to make
the results reproducible.</p>
<p>The call will take some times to run because it is equivalent to
calling <code><a href="../reference/power4test.html">power4test()</a></code> once for each sample size.</p>
<p>The rejection rates for each sample size can be retrieved by
<code><a href="../reference/rejection_rates.html">rejection_rates()</a></code> too:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/rejection_rates.html">rejection_rates</a></span><span class="op">(</span><span class="va">out_several_ns</span><span class="op">)</span></span>
<span><span class="co">#&gt; [test]: test_indirect: fx-&gt;fm-&gt;fy </span></span>
<span><span class="co">#&gt; [test_label]: Test </span></span>
<span><span class="co">#&gt;     n   est   p.v reject r.cilo r.cihi</span></span>
<span><span class="co">#&gt; 1 175 0.327 1.000  0.703  0.658  0.747</span></span>
<span><span class="co">#&gt; 2 200 0.329 1.000  0.830  0.793  0.867</span></span>
<span><span class="co">#&gt; 3 225 0.340 1.000  0.892  0.862  0.923</span></span>
<span><span class="co">#&gt; 4 250 0.330 1.000  0.902  0.873  0.932</span></span>
<span><span class="co">#&gt; Notes:</span></span>
<span><span class="co">#&gt; - n: The sample size in a trial.</span></span>
<span><span class="co">#&gt; - p.v: The proportion of valid replications.</span></span>
<span><span class="co">#&gt; - est: The mean of the estimates in a test across replications.</span></span>
<span><span class="co">#&gt; - reject: The proportion of 'significant' replications, that is, the</span></span>
<span><span class="co">#&gt;   rejection rate. If the null hypothesis is true, this is the Type I</span></span>
<span><span class="co">#&gt;   error rate. If the null hypothesis is false, this is the power.</span></span>
<span><span class="co">#&gt; - r.cilo,r.cihi: The confidence interval of the rejection rate, based</span></span>
<span><span class="co">#&gt;   on normal approximation.</span></span>
<span><span class="co">#&gt; - Refer to the tests for the meanings of other columns.</span></span></code></pre></div>
<p>The results show that, to have a power of about .800 to detect the
mediation effect, a sample size of about 200 is needed.</p>
<p>Please refer to the help page of <code><a href="../reference/power4test_by_n.html">power4test_by_n()</a></code> for
other examples.</p>
</div>
<div class="section level3">
<h3 id="using-x_from_power">Using <code>x_from_power()</code><a class="anchor" aria-label="anchor" href="#using-x_from_power"></a>
</h3>
<p>Second, the function <code><a href="../reference/x_from_power.html">x_from_power()</a></code> can be used to
systematically search within an interval the sample size with the target
power. This takes longer to run but, instead of manually trying
different sample size, this function do the search automatically.</p>
<p>See <a href="https://sfcheung.github.io/power4mome/articles/x_from_power_for_n.html">this
article</a> for an illustration of how to use
<code><a href="../reference/x_from_power.html">x_from_power()</a></code>.</p>
</div>
</div>
<div class="section level2">
<h2 id="other-scenarios">Other Scenarios<a class="anchor" aria-label="anchor" href="#other-scenarios"></a>
</h2>
<p>For other scenarios, such as moderation and moderated-mediation,
please refer to <code><a href="../articles/power4mome.html">vignette("power4mome")</a></code>.</p>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0" line-spacing="2">
<div id="ref-cheung_manymome_2024" class="csl-entry">
Cheung, S. F., &amp; Cheung, S.-H. (2024). <em>Manymome</em>:
<span>An</span> <span>R</span> package for computing the indirect
effects, conditional effects, and conditional indirect effects,
standardized or unstandardized, and their bootstrap confidence
intervals, in many (though not all) models. <em>Behavior Research
Methods</em>, <em>56</em>(5), 4862–4882. <a href="https://doi.org/10.3758/s13428-023-02224-z" class="external-link">https://doi.org/10.3758/s13428-023-02224-z</a>
</div>
</div>
</div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Shu Fai Cheung, Sing-Hang Cheung, Wendie Yang.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
